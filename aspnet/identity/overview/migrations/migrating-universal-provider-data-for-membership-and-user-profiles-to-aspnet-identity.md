---
uid: identity/overview/migrations/migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity
title: 멤버 자격 및 ASP.NET Id (C#)로 사용자 프로필에 대 한 범용 공급자 데이터 마이그레이션 | Microsoft Docs
author: rustd
description: 이 자습서에서는 사용자 역할 데이터 및 기존 앱의 범용 공급자를 사용 하 여 만든 사용자 프로필 데이터를 마이그레이션하는 데 필요한 단계를 설명 하는 중...
ms.author: aspnetcontent
ms.date: 12/13/2013
ms.assetid: 2e260430-d13c-4658-bd05-e256fc0d63b8
msc.legacyurl: /identity/overview/migrations/migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 1f685e676d3ca4eeb64f48f0df7212402a9f6f5f
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37810036"
---
<a name="migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity-c"></a><span data-ttu-id="2827b-103">멤버 자격 및 ASP.NET Id (C#)로 사용자 프로필에 대 한 범용 공급자 데이터 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="2827b-103">Migrating Universal Provider Data for Membership and User Profiles to ASP.NET Identity (C#)</span></span>
====================
<span data-ttu-id="2827b-104">하 여 [Pranav Rastogi](https://github.com/rustd)를 [Rick Anderson](https://github.com/Rick-Anderson)하십시오 [Robert McMurray](https://github.com/rmcmurray), [Suhas Joshi](https://github.com/suhasj)</span><span class="sxs-lookup"><span data-stu-id="2827b-104">by [Pranav Rastogi](https://github.com/rustd), [Rick Anderson](https://github.com/Rick-Anderson), [Robert McMurray](https://github.com/rmcmurray), [Suhas Joshi](https://github.com/suhasj)</span></span>

> <span data-ttu-id="2827b-105">이 자습서에서는 사용자 역할 데이터 및 ASP.NET Id 모델을 기존 응용 프로그램의 범용 공급자를 사용 하 여 만든 사용자 프로필 데이터를 마이그레이션하는 데 필요한 단계를 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-105">This tutorial describes the steps that are necessary to migrate user and role data and user profile data created using Universal Providers of an existing application to the ASP.NET Identity model.</span></span> <span data-ttu-id="2827b-106">방법은 여기에 언급 된 사용자 프로필 데이터를 마이그레이션하 SQL 멤버 자격도를 사용 하 여 응용 프로그램에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-106">The approach mentioned here to migrate user profile data can be used in an application with SQL membership as well.</span></span>


<span data-ttu-id="2827b-107">ASP.NET 팀 Visual Studio 2013의 릴리스를 사용 하 여 새 ASP.NET Id 시스템을 도입 하 고 알아볼 수 있습니다 해당 릴리스에 대 한 [여기](../../index.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-107">With the release of Visual Studio 2013, the ASP.NET team introduced a new ASP.NET Identity system, and you can read more about that release [here](../../index.md).</span></span> <span data-ttu-id="2827b-108">문서에서 웹 응용 프로그램 마이그레이션 이후의 [새 Id 시스템에 SQL 멤버 자격](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md),이 문서에서는 사용자 및 역할 관리를 위한 공급자 모델을 따르는 기존 응용 프로그램을 마이그레이션하는 단계를 보여 줍니다. 새 Id 모델입니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-108">Following up on the article to migrate web applications from [SQL Membership to the new Identity system](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md), this article illustrates the steps to migrate existing applications that follow the Providers model for user and role management to the new Identity model.</span></span> <span data-ttu-id="2827b-109">이 자습서의 포커스를 원활 하 게 새 시스템에 후크 할 사용자 프로필 데이터를 마이그레이션하기에 주로 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-109">The focus of this tutorial will be primarily on migrating the user profile data to seamlessly hook it into the new system.</span></span> <span data-ttu-id="2827b-110">마이그레이션 사용자 및 역할 정보를 SQL 멤버 자격에 대 한 것과 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-110">Migrating user and role information is similar for SQL membership.</span></span> <span data-ttu-id="2827b-111">SQL 멤버 자격도 응용 프로그램의 프로필 데이터를 마이그레이션하려면 다음 접근 방식을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-111">The approach followed to migrate profile data can be used in an application with SQL membership as well.</span></span>

<span data-ttu-id="2827b-112">예를 들어 공급자 모델을 사용 하는 Visual Studio 2012를 사용 하 여 만든 웹 앱을 사용 하 여 시작 하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-112">As an example, we will start with a web app created using Visual Studio 2012 which uses the Providers model.</span></span> <span data-ttu-id="2827b-113">에서는 다음 프로필 관리에 대 한 코드를 추가, 사용자 등록, 사용자에 대 한 프로필 데이터를 추가, 데이터베이스 스키마로 마이그레이션하 고 변경한 다음 사용자 및 역할 관리에 대 한 Id 시스템을 사용 하도록 응용.</span><span class="sxs-lookup"><span data-stu-id="2827b-113">We'll then add code for profile management, register a user, add profile data for the users, migrate the database schema, and then change the application to use the Identity system for user and role management.</span></span> <span data-ttu-id="2827b-114">마이그레이션 테스트를 범용 공급자를 사용 하 여 만든 사용자가 로그인 할 수 있어야 합니다.와 새 사용자를 등록할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-114">As a test of migration, users created using Universal Providers should be able to log in and new users should be able to register.</span></span>

> [!NOTE]
> <span data-ttu-id="2827b-115">전체 샘플을 찾을 수 있습니다 [ https://github.com/suhasj/UniversalProviders-Identity-Migrations ](https://github.com/suhasj/UniversalProviders-Identity-Migrations)합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-115">You can find the complete sample at [https://github.com/suhasj/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations).</span></span>


## <a name="profile-data-migration-summary"></a><span data-ttu-id="2827b-116">프로필 데이터 마이그레이션 요약</span><span class="sxs-lookup"><span data-stu-id="2827b-116">Profile data migration summary</span></span>

<span data-ttu-id="2827b-117">마이그레이션과 함께 시작 하기 전에 알려주세요 공급자 모델에 프로필 데이터를 저장 하는 환경을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-117">Before starting with the migrations, let us look at the experience of storing profile data in the Providers model.</span></span> <span data-ttu-id="2827b-118">사용자는 여러 가지 방법으로 저장할 수 있습니다 하는 응용 프로그램에 대 한 프로필 데이터, 그중에서 가장 일반적인 되를 사용 하 여 범용 공급자와 함께 제공 되는 기본 제공된 프로필 공급자입니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-118">Profile data for application users can be stored in multiple ways, the most common among them being using the inbuilt profile providers shipped along with the Universal Providers.</span></span> <span data-ttu-id="2827b-119">단계 포함</span><span class="sxs-lookup"><span data-stu-id="2827b-119">The steps would include</span></span>

1. <span data-ttu-id="2827b-120">속성이 프로필 데이터를 저장 하는 데 사용 되는 클래스를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-120">Add a class that has properties used to store Profile data.</span></span>
2. <span data-ttu-id="2827b-121">'ProfileBase'를 확장 하 고 사용자에 대 한 위의 프로필 데이터를 가져오는 메서드를 구현 하는 클래스를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-121">Add a class that extends 'ProfileBase' and implements methods to get the above profile data for the user.</span></span>
3. <span data-ttu-id="2827b-122">기본 프로필 공급자를 사용 하 여 사용 하도록 설정 합니다 *web.config* 파일과 프로필 정보에 액세스 하는 데 사용할 2 단계에서 선언 된 클래스를 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-122">Enable using default profile providers in the *web.config* file and define the class declared in step #2 to be used in accessing profile information.</span></span>

<span data-ttu-id="2827b-123">프로필 정보를 serialize 된 xml 및 이진 데이터는 데이터베이스의 '프로필' 테이블에 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-123">The profile information is stored as serialized xml and binary data in the 'Profiles' table in the database.</span></span>

<span data-ttu-id="2827b-124">새 ASP.NET Id 시스템을 사용 하도록 응용 프로그램으로 마이그레이션한 후 프로필 정보를 deserialize 하 고 사용자 클래스의 속성으로 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-124">After migrating the application to use the new ASP.NET Identity system, the profile information is deserialized and stored as properties on the user class.</span></span> <span data-ttu-id="2827b-125">그런 다음 사용자 테이블의 열에 각 속성을 매핑할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-125">Each property can then be mapped onto columns in the user table.</span></span> <span data-ttu-id="2827b-126">장점은 데이터 정보를 직렬화/역직렬화 필요가 없을 뿐만 아니라 사용자 클래스를 사용 하 여 직접 속성을 작동할 수 있으므로 시점에 액세스 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-126">The advantage here is that the properties can be worked on directly using the user class in addition to not having to serialize/deserialize data information each time when accessing it.</span></span>

## <a name="getting-started"></a><span data-ttu-id="2827b-127">시작</span><span class="sxs-lookup"><span data-stu-id="2827b-127">Getting Started</span></span>

1. <span data-ttu-id="2827b-128">Visual Studio 2012의 새로운 ASP.NET 4.5 Web Forms 응용 프로그램을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-128">Create a new ASP.NET 4.5 Web Forms application in Visual Studio 2012.</span></span> <span data-ttu-id="2827b-129">현재이 샘플에서는 Web Forms 템플릿을 사용 하지만 MVC 응용 프로그램에도 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-129">The current sample uses the Web Forms template, but you could use MVC Application as well.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image1.jpg)
2. <span data-ttu-id="2827b-130">'모델' 프로필 정보를 저장할 새 폴더 만들기</span><span class="sxs-lookup"><span data-stu-id="2827b-130">Create a new folder 'Models' to store profile information</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image1.png)
3. <span data-ttu-id="2827b-131">예를 들어 프로필에 생년월일, city, 높이 및 사용자의 가중치의 날짜를 저장할 알려 주세요.</span><span class="sxs-lookup"><span data-stu-id="2827b-131">As an example, let us store the date of birth, city, height and weight of the user in profile.</span></span> <span data-ttu-id="2827b-132">높이 두께로 'PersonalStats' 라는 사용자 지정 클래스로 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-132">The height and weight are stored as a custom class called 'PersonalStats'.</span></span> <span data-ttu-id="2827b-133">저장 하 고 프로필을 검색에 'ProfileBase'를 확장 하는 클래스를 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-133">To store and retrieve the profile, we need a class that extends 'ProfileBase'.</span></span> <span data-ttu-id="2827b-134">'AppProfile' 프로필 정보를 저장 하는 새 클래스를 만들어 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-134">Let's create a new class 'AppProfile' to get and store profile information.</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample1.cs)]
4. <span data-ttu-id="2827b-135">프로필을 사용 하도록 설정 합니다 *web.config* 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-135">Enable profile in the *web.config* file.</span></span> <span data-ttu-id="2827b-136">3 단계에서 만든 사용자 정보를 저장/검색 하는 데 사용할 클래스 이름을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-136">Enter the class name to be used to store/retrieve user information created in step #3.</span></span>

    [!code-xml[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample2.xml)]
5. <span data-ttu-id="2827b-137">사용자의 프로필 데이터를 가져와서 저장 'Account' 폴더에서 web forms 페이지를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-137">Add a web forms page in 'Account' folder to get the profile data from the user and store it.</span></span> <span data-ttu-id="2827b-138">프로젝트를 마우스 오른쪽 단추로 클릭 하 고 새 항목 추가를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-138">Right click on project and select 'Add new Item'.</span></span> <span data-ttu-id="2827b-139">Webforms 마스터 페이지 'AddProfileData.aspx'를 사용 하 여 새 페이지를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-139">Add a new webforms page with master page 'AddProfileData.aspx'.</span></span> <span data-ttu-id="2827b-140">'MainContent' 섹션에 다음을 복사 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-140">Copy the following in the 'MainContent' section:</span></span>

    [!code-html[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample3.html)]

   <span data-ttu-id="2827b-141">코드 숨김에 다음 코드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-141">Add the following code in the code behind:</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample4.cs)]

   <span data-ttu-id="2827b-142">네임 스페이스는 AppProfile 컴파일 오류를 제거 하려면 클래스 정의 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-142">Add the namespace under which AppProfile class is defined to remove the compilation errors.</span></span>
6. <span data-ttu-id="2827b-143">사용자 이름을 가진 새 사용자를 만들고 앱을 실행 '**olduser'.**</span><span class="sxs-lookup"><span data-stu-id="2827b-143">Run the app and create a new user with username '**olduser'.**</span></span> <span data-ttu-id="2827b-144">'AddProfileData' 페이지로 이동한 후 사용자에 대 한 프로필 정보를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-144">Navigate to the 'AddProfileData' page and add profile information for the user.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image2.png)

<span data-ttu-id="2827b-145">데이터 서버 탐색기 창을 사용 하 여 '프로필' 테이블의 serialize 된 xml로 저장 되도록 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-145">You can verify that the data is stored as serialized xml in the 'Profiles' table using the Server Explorer window.</span></span> <span data-ttu-id="2827b-146">Visual Studio에서 [보기] 메뉴에서 ' 서버 탐색기 '를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-146">In Visual Studio, from 'View' menu, choose 'Server Explorer'.</span></span> <span data-ttu-id="2827b-147">에 정의 된 데이터베이스에 대 한 데이터 연결 해야 합니다 *web.config* 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-147">There should be a data connection for the database defined in the *web.config* file.</span></span> <span data-ttu-id="2827b-148">데이터 연결을 클릭 하면 다른 하위 범주를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-148">Clicking on the data connection shows different sub categories.</span></span> <span data-ttu-id="2827b-149">'테이블' 데이터베이스에 다른 테이블을 표시 합니다. '프로필'에서 마우스 오른쪽 단추로 클릭 하 고 프로필 테이블에 저장 된 프로필 데이터를 보려면 ' 테이블 데이터 표시 '를 선택 하려면 확장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-149">Expand 'Tables' to show the different tables in your database, then right click on 'Profiles' and choose 'Show Table Data' to view the profile data stored in the Profiles table.</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image3.png)

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image4.png)

## <a name="migrating-database-schema"></a><span data-ttu-id="2827b-150">데이터베이스 스키마 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="2827b-150">Migrating database schema</span></span>

<span data-ttu-id="2827b-151">기존 데이터베이스 Id 시스템을 사용 하 여 작업을 하려면 원래 데이터베이스에 추가한 필드를 지원 하도록 Id 데이터베이스에서 스키마를 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-151">To make the existing database work with the Identity system, we need to update the schema in the Identity database to support the fields we added to the original database.</span></span> <span data-ttu-id="2827b-152">이렇게 하려면 SQL 스크립트를 사용 하 여 새 테이블을 만들고 기존 정보를 복사 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-152">This can be done using SQL scripts to create new tables and copy the existing information.</span></span> <span data-ttu-id="2827b-153">' 서버 탐색기 ' 창의 'DefaultConnection' 테이블을 표시 하려면 확장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-153">In the 'Server Explorer' window, expand the 'DefaultConnection' to display the tables.</span></span> <span data-ttu-id="2827b-154">테이블을 마우스 오른쪽 단추로 클릭 하 고 새 쿼리를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-154">Right click Tables and select 'New Query'</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image5.png)

<span data-ttu-id="2827b-155">SQL 스크립트를 붙여 넣습니다 [ https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt ](https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt) 하 고 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-155">Paste the SQL script from [https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt](https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt) and run it.</span></span> <span data-ttu-id="2827b-156">'DefaultConnection'을 새로 고치면 새 테이블로 추가 되어 있는지 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-156">If the 'DefaultConnection' is refreshed, we can see that the new tables are added.</span></span> <span data-ttu-id="2827b-157">정보를 마이그레이션 되었는지 확인 하려면 테이블 내부의 데이터를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-157">You can check the data inside the tables to see that the information has been migrated.</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image6.png)

## <a name="migrating-the-application-to-use-aspnet-identity"></a><span data-ttu-id="2827b-158">ASP.NET Id를 사용 하 여 응용 프로그램 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="2827b-158">Migrating the application to use ASP.NET Identity</span></span>

1. <span data-ttu-id="2827b-159">ASP.NET Id에 필요한 Nuget 패키지를 설치 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-159">Install the Nuget packages needed for ASP.NET Identity:</span></span>

    - <span data-ttu-id="2827b-160">Microsoft.AspNet.Identity.EntityFramework</span><span class="sxs-lookup"><span data-stu-id="2827b-160">Microsoft.AspNet.Identity.EntityFramework</span></span>
    - <span data-ttu-id="2827b-161">Microsoft.AspNet.Identity.Owin</span><span class="sxs-lookup"><span data-stu-id="2827b-161">Microsoft.AspNet.Identity.Owin</span></span>
    - <span data-ttu-id="2827b-162">Microsoft.Owin.Host.SystemWeb</span><span class="sxs-lookup"><span data-stu-id="2827b-162">Microsoft.Owin.Host.SystemWeb</span></span>
    - <span data-ttu-id="2827b-163">Microsoft.Owin.Security.Facebook</span><span class="sxs-lookup"><span data-stu-id="2827b-163">Microsoft.Owin.Security.Facebook</span></span>
    - <span data-ttu-id="2827b-164">Microsoft.Owin.Security.Google</span><span class="sxs-lookup"><span data-stu-id="2827b-164">Microsoft.Owin.Security.Google</span></span>
    - <span data-ttu-id="2827b-165">Microsoft.Owin.Security.MicrosoftAccount</span><span class="sxs-lookup"><span data-stu-id="2827b-165">Microsoft.Owin.Security.MicrosoftAccount</span></span>
    - <span data-ttu-id="2827b-166">Microsoft.Owin.Security.Twitter</span><span class="sxs-lookup"><span data-stu-id="2827b-166">Microsoft.Owin.Security.Twitter</span></span>

   <span data-ttu-id="2827b-167">Nuget 패키지를 관리 하는 방법은 있습니다 [여기](http://docs.nuget.org/docs/start-here/Managing-NuGet-Packages-Using-The-Dialog)</span><span class="sxs-lookup"><span data-stu-id="2827b-167">More information on managing Nuget packages can be found [here](http://docs.nuget.org/docs/start-here/Managing-NuGet-Packages-Using-The-Dialog)</span></span>
2. <span data-ttu-id="2827b-168">테이블의 기존 데이터를 사용 하려면 테이블에 다시 매핑합니다 및 Id 시스템에 연결 하는 모델 클래스 만들기 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-168">To work with existing data in the table, we need to create model classes which map back to the tables and hook them up in the Identity system.</span></span> <span data-ttu-id="2827b-169">Identity 계약의 일부로 모델 클래스 Identity.Core dll에 정의 된 인터페이스를 구현 해야 하거나 또는 기존 구현의 Microsoft.AspNet.Identity.EntityFramework에서 사용할 수 있는 이러한 인터페이스를 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-169">As part of the Identity contract, the model classes should either implement the interfaces defined in the Identity.Core dll or can extend the existing implementation of these interfaces available in Microsoft.AspNet.Identity.EntityFramework.</span></span> <span data-ttu-id="2827b-170">역할, 사용자 로그인 및 사용자 클레임에 대 한 기존 클래스를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-170">We will be using the existing classes for role, user logins and user claims.</span></span> <span data-ttu-id="2827b-171">이 샘플에 대 한 사용자 지정 사용자를 사용 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-171">We need to use a custom user for our sample.</span></span> <span data-ttu-id="2827b-172">프로젝트를 마우스 오른쪽 단추로 클릭 하 고 'IdentityModels' 폴더를 새로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-172">Right click on the project and create new folder 'IdentityModels'.</span></span> <span data-ttu-id="2827b-173">아래 표시 된 것과 같이 새 'User' 클래스를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-173">Add a new 'User' class as shown below:</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample5.cs)]

   <span data-ttu-id="2827b-174">이제 'ProfileInfo' 사용자 클래스의 속성 인지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-174">Notice that the 'ProfileInfo' is now a property on the user class.</span></span> <span data-ttu-id="2827b-175">따라서 프로필 데이터와 함께 직접 작동 하도록 사용자 클래스를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-175">Hence we can use the user class to directly work with profile data.</span></span>

<span data-ttu-id="2827b-176">파일을 복사 합니다 **IdentityModels** 및 **IdentityAccount** 다운로드 원본의 폴더 ( [ https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations ](https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations) ).</span><span class="sxs-lookup"><span data-stu-id="2827b-176">Copy the files in the **IdentityModels** and **IdentityAccount** folders from the download source ( [https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations) ).</span></span> <span data-ttu-id="2827b-177">나머지 모델 클래스와 사용자 및 ASP.NET Identity Api를 사용 하 여 역할 관리에 필요한 새 페이지가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-177">These have the remaining model classes and the new pages needed for user and role management using the ASP.NET Identity APIs.</span></span> <span data-ttu-id="2827b-178">SQL 멤버 자격에 사용 되는 접근 방법이 비슷합니다 및 자세한 설명을 찾을 수 있습니다 [여기](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-178">The approach used is similar to the SQL Membership and the detailed explanation can be found [here](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md).</span></span>

[!INCLUDE[](../../../includes/identity/alter-command-exception.md)]

## <a name="copying-profile-data-to-the-new-tables"></a><span data-ttu-id="2827b-179">새 테이블에 프로필 데이터를 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-179">Copying Profile data to the new tables</span></span>

<span data-ttu-id="2827b-180">앞에서 설명한 대로 프로필 테이블에 xml 데이터를 deserialize 하 여 AspNetUsers 테이블의 열에 저장 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-180">As mentioned earlier, we need to deserialize the xml data in the Profiles tables and store it in the columns of the AspNetUsers table.</span></span> <span data-ttu-id="2827b-181">새 열은 필요한 데이터를 사용 하 여 해당 열을 채우기 위해 모든 남아 있던 이므로 이전 단계에서 사용자 테이블에서 생성 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-181">The new columns were created in the users table in the previous step so all that is left is to populate those columns with the necessary data.</span></span> <span data-ttu-id="2827b-182">이렇게 하려면 사용자가 테이블에서 새로 만든된 열을 채우기 위해 한 번 실행 되는 콘솔 응용 프로그램을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-182">To do this, we will use a console application which is run once to populate the newly created columns in the users table.</span></span>

1. <span data-ttu-id="2827b-183">기존 솔루션에서 새 콘솔 응용 프로그램을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-183">Create a new console application in the exiting solution.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image2.jpg)
2. <span data-ttu-id="2827b-184">Entity Framework 패키지의 최신 버전을 설치 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-184">Install the latest version of the Entity Framework package.</span></span>
3. <span data-ttu-id="2827b-185">콘솔 응용 프로그램에 대 한 참조로 위에서 만든 웹 응용 프로그램을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-185">Add the web application created above as a reference to the console application.</span></span> <span data-ttu-id="2827b-186">작업을 수행 하이 마우스 오른쪽 단추로 프로젝트 클릭 ' 참조 추가 '를 다음 솔루션에서 다음 프로젝트 클릭 하 고 확인을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-186">To do this right click on Project, then 'Add References', then Solution, then click on the project and click OK.</span></span>
4. <span data-ttu-id="2827b-187">복사는 Program.cs 클래스에 아래 코드입니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-187">Copy the below code in the Program.cs class.</span></span> <span data-ttu-id="2827b-188">이 논리 각 사용자에 대 한 프로필 데이터를 읽고 'ProfileInfo' 개체로 serialize 하며 데이터베이스에 다시 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-188">This logic reads profile data for each user, serializes it as 'ProfileInfo' object and stores it back to the database.</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample6.cs)]

   <span data-ttu-id="2827b-189">사용 하는 모델의 일부 값은 해당 네임 스페이스를 포함 해야 하므로 웹 응용 프로그램 프로젝트의 'IdentityModels' 폴더에 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-189">Some of the models used are defined in the 'IdentityModels' folder of the web application project, so you must include the corresponding namespaces.</span></span>
5. <span data-ttu-id="2827b-190">위의 코드는 앱에서 데이터베이스 파일에서 작동\_이전 단계에서 만든 웹 응용 프로그램 프로젝트의 데이터 폴더.</span><span class="sxs-lookup"><span data-stu-id="2827b-190">The above code works on the database file in the App\_Data folder of the web application project created in the previous steps.</span></span> <span data-ttu-id="2827b-191">참조 하는 웹 응용 프로그램의 web.config에서 연결 문자열을 사용 하 여 콘솔 응용 프로그램의 app.config 파일에서 연결 문자열을 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-191">To reference that, update the connection string in the app.config file of the console application with the connection string in the web.config of the web application.</span></span> <span data-ttu-id="2827b-192">또한 'AttachDbFilename' 속성의 전체 물리적 경로 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-192">Also provide the complete physical path in the 'AttachDbFilename' property.</span></span>
6. <span data-ttu-id="2827b-193">명령 프롬프트를 열고 위의 콘솔 응용 프로그램의 bin 폴더로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-193">Open a command prompt and navigate to the bin folder of the above console application.</span></span> <span data-ttu-id="2827b-194">실행 파일을 실행 하 고 다음 이미지에 표시 된 대로 로그 출력을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-194">Run the executable and review the log output as shown in the following image.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image3.jpg)
7. <span data-ttu-id="2827b-195">서버 탐색기에서 'AspNetUsers' 테이블을 열고 속성을 포함 하는 새 열에 데이터를 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-195">Open the 'AspNetUsers' table in the Server Explorer and verify the data in the new columns that hold the properties.</span></span> <span data-ttu-id="2827b-196">해당 속성 값으로 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-196">They should be updated with the corresponding property values.</span></span>

## <a name="verify-functionality"></a><span data-ttu-id="2827b-197">기능 확인</span><span class="sxs-lookup"><span data-stu-id="2827b-197">Verify functionality</span></span>

<span data-ttu-id="2827b-198">ASP.NET Id를 사용 하 여 기존 데이터베이스에서 사용자 로그인 구현 되는 새로 추가 된 멤버 자격 페이지를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-198">Use the newly added membership pages that are implemented using ASP.NET Identity to login a user from the old database.</span></span> <span data-ttu-id="2827b-199">사용자는 동일한 자격 증명을 사용 하 여 로그인 할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-199">The user should be able to log in using the same credentials.</span></span> <span data-ttu-id="2827b-200">역할에 사용자를 추가 OAuth, 암호를 변경, 새 사용자를 만드는 추가 역할을 추가 하는 등 다른 기능을 시도 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-200">Try the other functionalities like adding OAuth, creating a new user, changing a password, adding roles, add users to roles, etc.</span></span>

<span data-ttu-id="2827b-201">이전 사용자와 새 사용자에 대 한 프로필 데이터를 검색 하 고 사용자가 테이블에 저장 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-201">The Profile data for the old user and the new users should be retrieved and stored in the users table.</span></span> <span data-ttu-id="2827b-202">이전 테이블 더 이상 참조 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-202">The old table should no longer be referenced.</span></span>

## <a name="conclusion"></a><span data-ttu-id="2827b-203">결론</span><span class="sxs-lookup"><span data-stu-id="2827b-203">Conclusion</span></span>

<span data-ttu-id="2827b-204">이 문서는 ASP.NET Id에 대 한 멤버 자격 공급자 모델을 사용 하는 웹 응용 프로그램으로 마이그레이션하는 프로세스를 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-204">The article described the process of migrating web applications that used the provider model for membership to ASP.NET Identity.</span></span> <span data-ttu-id="2827b-205">또한 문서 Id 시스템에 후크 될 사용자에 대 한 마이그레이션 프로필 데이터를 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="2827b-205">The article additionally outlined migrating profile data for users to be hooked into the Identity system.</span></span> <span data-ttu-id="2827b-206">질문 및 앱을 마이그레이션하는 경우 발생 하는 문제에 대 한 아래 의견을 남겨 주세요.</span><span class="sxs-lookup"><span data-stu-id="2827b-206">Please leave comments below for questions and issues encountered when you migrate your app.</span></span>

<span data-ttu-id="2827b-207">*Rick Anderson 및 Robert McMurray의 문서를 검토에 참여해 주셔서 감사 합니다.*</span><span class="sxs-lookup"><span data-stu-id="2827b-207">*Thanks to Rick Anderson and Robert McMurray for reviewing the article.*</span></span>
