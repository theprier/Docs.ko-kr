---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: '반복 #5-단위 테스트 만들기 (C#) | Microsoft Docs'
author: microsoft
description: 다섯 번째 반복에서에서는 쉽게 응용 프로그램 유지 관리 하 고 단위 테스트를 추가 하 여 수정 합니다. 데이터 모델 클래스를 모의 하 고 o에 대 한 단위 테스트를 빌드하는 중...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
ms.technology: dotnet-mvc
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: 6466e7332e0e11420a0e99c77a87a7cddc0e34e2
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/03/2018
ms.locfileid: "37372406"
---
<a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="d3ff2-104">반복 #5-단위 테스트 만들기 (C#)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-104">Iteration #5 – Create unit tests (C#)</span></span>
====================
<span data-ttu-id="d3ff2-105">[Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="d3ff2-106">코드 다운로드</span><span class="sxs-lookup"><span data-stu-id="d3ff2-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="d3ff2-107">다섯 번째 반복에서에서는 쉽게 응용 프로그램 유지 관리 하 고 단위 테스트를 추가 하 여 수정 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d3ff2-108">데이터 모델 클래스를 모의 하 고는 컨트롤러 및 유효성 검사 논리에 대 한 단위 테스트를 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="d3ff2-109">연락처 관리 ASP.NET MVC 응용 프로그램을 작성 (C#)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="d3ff2-110">이 시리즈의 자습서에서 전체 연락처 관리 응용을 프로그램 시작부터 완료를 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="d3ff2-111">연락처 관리자 응용 프로그램에 사용자의 목록을 포함 된 상점 연락처 정보-이름, 전화 번호 및 전자 메일 주소-할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="d3ff2-112">여러 반복에 응용 프로그램을 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="d3ff2-113">각 반복에서 점진적으로 응용 프로그램을 개선 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="d3ff2-114">이렇게 여러 반복의 목표는 각 변경의 이유를 이해할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="d3ff2-115">반복 #1-응용 프로그램을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="d3ff2-116">첫 번째 반복에서 연락처 관리자에서에서 만드는 가장 간단한 방법은 가능 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="d3ff2-117">기본 데이터베이스 작업에 대 한 지원 추가: 만들기, 읽기, 업데이트 및 삭제 (CRUD).</span><span class="sxs-lookup"><span data-stu-id="d3ff2-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="d3ff2-118">반복 #2-보기 좋게 응용 프로그램을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="d3ff2-119">이 반복에서 기본 ASP.NET MVC 보기 마스터 페이지를 수정 및 스타일 시트를 연계 하 여 응용 프로그램의 모양을 개선 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="d3ff2-120">반복 #3-양식 유효성 검사를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="d3ff2-121">세 번째 반복에서는 기본 양식 유효성 검사를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="d3ff2-122">사용자를 방지할 수를 필요한 형식의 필드를 완료 하지 않고 폼을 제출 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="d3ff2-123">또한 전자 메일 주소 및 전화 번호 유효성을 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="d3ff2-124">반복 #4-느슨하게 결합 된 응용 프로그램을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="d3ff2-125">이 세 번째 반복에서는 활용 쉽게 유지 관리 하 고 연락처 관리자 응용 프로그램을 수정 하려면 몇 가지 소프트웨어 디자인 패턴입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-125">In this third iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="d3ff2-126">예를 들어, 리포지토리 패턴 및 종속성 주입 패턴을 사용 하 여 응용 프로그램을 리팩터링 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="d3ff2-127">반복 #5-단위 테스트를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="d3ff2-128">다섯 번째 반복에서에서는 쉽게 응용 프로그램 유지 관리 하 고 단위 테스트를 추가 하 여 수정 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d3ff2-129">데이터 모델 클래스를 모의 하 고는 컨트롤러 및 유효성 검사 논리에 대 한 단위 테스트를 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="d3ff2-130">반복 #6-테스트 중심 개발을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="d3ff2-131">이 여섯 번째 반복에서는 추가 새로운 기능을 응용 프로그램 먼저 단위 테스트를 작성 하 고 단위 테스트에 대 한 코드를 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="d3ff2-132">이 반복에서는 메일 그룹을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="d3ff2-133">반복 #7 – Ajax 기능을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="d3ff2-134">일곱 번째 반복에서 개선할 응용 프로그램의 성능과 응답성 Ajax에 대 한 지원을 추가 하 여 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="d3ff2-135">이 반복</span><span class="sxs-lookup"><span data-stu-id="d3ff2-135">This Iteration</span></span>

<span data-ttu-id="d3ff2-136">연락처 관리자 응용 프로그램의 이전 반복에서는 더 느슨하게 결합 되어야 하는 응용 프로그램을 리팩터링 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="d3ff2-137">응용 프로그램 고유한 컨트롤러, 서비스 및 저장소 계층을 구분 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="d3ff2-138">인터페이스를 통해 그 아래의 계층을 사용 하 여 각 계층 상호 작용합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="d3ff2-139">응용 프로그램을 더 쉽게 유지 관리 및 모니터링 하려면 응용 프로그램을 리팩터링 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="d3ff2-140">예를 들어, 새 데이터 액세스 기술을 사용 하 여, 필요한 경우 변경할 수 있습니다 단순히 리포지토리 계층 컨트롤러 또는 서비스 계층을 변경 하지 않고도 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="d3ff2-141">느슨하게 연결 된 연락처 관리자를 만들어에서는 ve 변경한 응용 프로그램을 변경 하려면 복원 력이 더욱 높아집니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="d3ff2-142">하지만 연락처 관리자 응용 프로그램에 새 기능을 추가 해야 하는 경우 어떻게 되나요?</span><span class="sxs-lookup"><span data-stu-id="d3ff2-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="d3ff2-143">또는 우리가 버그를 수정 하는 경우 어떻게 되나요?</span><span class="sxs-lookup"><span data-stu-id="d3ff2-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="d3ff2-144">싫은 제대로 입증 된 코드를 작성 하는 사실는 새 버그를 도입 될 위험이 생성 되는 코드를 터치 할 때마다 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="d3ff2-145">예를 들어, 하루 세밀 하 게, 관리자에 게 하도록 요청할 수도 있습니다 연락처 관리자에 새 기능을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="d3ff2-146">메일 그룹에 대 한 지원을 추가 하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="d3ff2-147">사용자가 해당 연락처를 친구, 비즈니스 등 그룹으로 구성 하도록 하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="d3ff2-148">이 새로운 기능을 구현 하려면 연락처 관리자 응용 프로그램의 세 계층을 모두 수정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="d3ff2-149">컨트롤러, 서비스 계층 및 저장소에 새 기능을 추가 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="d3ff2-150">코드를 수정, 시작 하는 즉시 중단 하기 전에 했던 기능 위험이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="d3ff2-151">이전 반복에서 수행한 것 처럼 별도 레이어로 응용 프로그램을 리팩터링 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="d3ff2-152">응용 프로그램의 나머지 부분을 건드리지 않고 전체 계층에 변경 내용을 수행할 수 있기 때문에 한 것 이었습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="d3ff2-153">그러나 계층 내에서 코드를 더 쉽게 유지 하 고 수정 하려는 경우 코드에 대 한 단위 테스트 만들기 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="d3ff2-154">사용할 단위 테스트에는 개별 코드 단위입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="d3ff2-155">코드의 이러한 단위는 전체 응용 프로그램 계층 보다 작습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="d3ff2-156">일반적으로 사용 하 여 단위 테스트 코드의 특정 메서드에서 예상 되는 방식으로 동작 하는지 여부를 확인 하십시오.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="d3ff2-157">예를 들어 ContactManagerService 클래스에 의해 노출 CreateContact() 메서드에 대 한 단위 테스트를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="d3ff2-158">만 하는 응용 프로그램 작업에 대 한 단위 테스트 안전망을 선호합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="d3ff2-159">응용 프로그램에서 코드를 수정할 때마다 수정에 기존 기능이 중단 되는지 여부를 확인 하는 단위 테스트 집합을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="d3ff2-160">단위 테스트 코드를 수정 하려면 안전 하 게 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="d3ff2-161">단위 테스트 복원 력을 코드의 모든 응용 프로그램에서 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="d3ff2-162">이 반복에서 연락처 관리자 응용 프로그램에 단위 테스트를 추가 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="d3ff2-163">이런 방식으로 다음 반복에 추가할 수 있습니다 연락처 그룹 응용 프로그램에 기존 기능이 망가질 걱정할 필요 없이 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d3ff2-164">단위 테스트 프레임 워크 NUnit, xUnit.net, MbUnit 등 여러 가지가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="d3ff2-165">이 자습서에서는 단위 테스트 프레임 워크 Visual Studio를 함께 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="d3ff2-166">그러나 이러한 대체 프레임 워크 중 하나 사용 간단 하 게 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="d3ff2-167">어떤 테스트를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-167">What Gets Tested</span></span>

<span data-ttu-id="d3ff2-168">완벽 한 환경에서 모든 코드 단위 테스트에서 검사 수 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="d3ff2-169">완벽 한 세상에 완벽 한 안전망 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="d3ff2-170">응용 프로그램에서 코드 줄을 수정 하 고 알고 있는 즉시 단위 테스트를 실행 하 여 변경 내용을 기존 기능을 중단 하는지 여부를 수 있게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="d3ff2-171">그러나에서는 인할 라이브 세상이 완벽 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="d3ff2-172">연습에서는 단위 테스트를 작성 하는 경우, 비즈니스 논리 (예: 유효성 검사 논리)에 대 한 테스트 작성에 집중할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="d3ff2-173">특히 있습니다 *하지* 데이터에 대 한 단위 테스트 작성 논리 또는 뷰 논리에 액세스 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="d3ff2-174">유용 하려면 단위 테스트는 매우 신속 하 게 실행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="d3ff2-175">쉽게 수백 또는 수천 응용 프로그램에 대 한 단위 테스트 축적 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="d3ff2-176">단위 테스트를 실행 하는 데 오래 걸릴 실행 방지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="d3ff2-177">즉, 장기 실행 단위 테스트는 매일 코딩 목적에 대 한 의미가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="d3ff2-178">따라서 일반적으로 쓰지 않아도 데이터베이스 상호 작용 하는 코드에 대 한 단위 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="d3ff2-179">라이브 데이터베이스에 대해 수백 개의 단위 테스트를 실행 합니다. 너무 느려질 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="d3ff2-180">대신, 데이터베이스를 모의 하 고 (설명 아래 데이터베이스를 모의) 모의 데이터베이스와 상호 작용 하는 코드를 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="d3ff2-181">비슷한 이유로, 일반적으로 쓰지 않아도 보기에 대 한 단위 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="d3ff2-182">뷰를 테스트 하려면 웹 서버를 스핀업 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="d3ff2-183">웹 서버를 회전 비교적 속도가 느린 프로세스 이기 때문에 뷰에 대 한 단위 테스트를 만드는 권장 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="d3ff2-184">보기에는 복잡 한 논리가 포함 된 경우 도우미 메서드로 이동 하는 논리를 고려해 야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="d3ff2-185">웹 서버를 포함 하지 않고도 실행 되는 도우미 메서드에 대 한 단위 테스트를 작성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d3ff2-186">데이터 액세스 논리에 대 한 테스트를 작성 하거나 뷰 논리는 좋지 않습니다 단위 테스트를 작성 하는 경우, 기능 구성 또는 통합 테스트 하는 경우에 이러한 테스트 매우 유용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="d3ff2-187">ASP.NET MVC Web Forms 뷰 엔진입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="d3ff2-188">Web Forms 뷰 엔진을 웹 서버에 종속 된 동안 다른 뷰 엔진 되지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="d3ff2-189">모의 개체 프레임 워크를 사용 하 여</span><span class="sxs-lookup"><span data-stu-id="d3ff2-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="d3ff2-190">단위 테스트를 작성할 때 거의 항상 모의 개체 프레임 워크를 활용 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="d3ff2-191">모의 개체 프레임 워크를 사용 하면 응용 프로그램에서 모의 개체 및 클래스에 대 한 스텁을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="d3ff2-192">예를 들어을 모의 버전의 리포지토리 클래스를 생성 하는 모의 개체 프레임 워크를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="d3ff2-193">이런 방식으로 단위 테스트에서 모의 리포지토리 클래스 실제 리포지토리 클래스 대신 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="d3ff2-194">모의 리포지토리를 사용 하 여 단위 테스트를 실행할 때 데이터베이스 코드를 실행 하지 않도록 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="d3ff2-195">Visual Studio 모의 개체 프레임 워크를 포함 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="d3ff2-196">그러나 가지 여러 상용 및 오픈 소스에 대 한 모의 개체 프레임 워크.NET framework에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="d3ff2-197">Moq-이 프레임 워크는 오픈 소스 BSD 라이선스에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d3ff2-198">Moq에서 다운로드할 수 있습니다 [ https://code.google.com/p/moq/ ](https://code.google.com/p/moq/)합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="d3ff2-199">Rhino Mocks-이 프레임 워크는 오픈 소스 BSD 라이선스에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d3ff2-200">Rhino Mocks에서 다운로드할 수 있습니다 [ http://ayende.com/projects/rhino-mocks.aspx ](http://ayende.com/projects/rhino-mocks.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="d3ff2-201">Typemock Isolator-이 파일은 상용 프레임 워크입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="d3ff2-202">평가판 버전을 다운로드할 수 있습니다 [ http://www.typemock.com/ ](http://www.typemock.com/)합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="d3ff2-203">이 자습서에서는 Moq를 사용 하기로 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="d3ff2-204">그러나 Rhino Mocks를 간단 하 게 사용할 수 있습니다 또는 Mock를 만들려면 Typemock Isolator 연락처 관리자 응용 프로그램에 대 한 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="d3ff2-205">Moq를 사용 하려면 먼저 다음 단계를 완료 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="d3ff2-206">.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-206">.</span></span>
2. <span data-ttu-id="d3ff2-207">압축을 풀면 다운로드, 전에 확인 파일을 마우스 오른쪽 단추로 클릭 하 고 단추를 클릭 **차단 해제** (그림 1 참조).</span><span class="sxs-lookup"><span data-stu-id="d3ff2-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="d3ff2-208">다운로드를 압축을 풉니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-208">Unzip the download.</span></span>
4. <span data-ttu-id="d3ff2-209">ContactManager.Tests 프로젝트의 참조 폴더를 마우스 오른쪽 단추로 클릭 하 고 선택 하 여 Moq 어셈블리에 대 한 참조를 추가 **참조 추가**합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="d3ff2-210">찾아보기 탭에서 Moq 압축을 푼 폴더로 이동 하 고 Moq.dll 어셈블리를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="d3ff2-211">클릭 합니다 **확인** 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="d3ff2-212">다음이 단계를 완료 한 후 참조 폴더는 그림 2와 같습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-212">After you complete these steps, your References folder should look like Figure 2.</span></span>


<span data-ttu-id="d3ff2-213">[![차단 해제 Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="d3ff2-214">**그림 01**: 차단 해제 Moq ([큰 이미지를 보려면 클릭](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d3ff2-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>


<span data-ttu-id="d3ff2-215">[![Moq를 추가한 후 참조](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="d3ff2-216">**그림 02**: Moq를 추가한 후 참조 ([큰 이미지를 보려면 클릭](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d3ff2-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="d3ff2-217">서비스 계층에 대 한 단위 테스트 만들기</span><span class="sxs-lookup"><span data-stu-id="d3ff2-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="d3ff2-218">이 연락처 관리자 응용 프로그램의 서비스 계층에 대 한 단위 테스트 집합을 만들어 시작 s 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="d3ff2-219">이 유효성 검사 논리를 확인 하려면 이러한 테스트를 사용 하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="d3ff2-220">ContactManager.Tests 프로젝트의 Models 라는 새 폴더를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="d3ff2-221">다음으로 Models 폴더를 마우스 오른쪽 단추로 클릭 하 고 선택 **추가, 새 테스트**합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="d3ff2-222">합니다 **새 테스트 추가** 그림 3 에서처럼 대화 상자가 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="d3ff2-223">선택 합니다 **단위 테스트** 템플릿 ContactManagerServiceTest.cs 새 테스트 이름을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="d3ff2-224">클릭 합니다 **확인** 테스트 프로젝트에 새 테스트를 추가 하려면 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d3ff2-225">일반적으로 ASP.NET MVC 프로젝트의 폴더 구조와 일치 하도록 테스트 프로젝트의 폴더 구조를 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="d3ff2-226">예를 들어 컨트롤러 폴더는 Models 폴더에서 모델 테스트에 테스트 컨트롤러를 배치 및 등입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


<span data-ttu-id="d3ff2-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="d3ff2-228">**그림 03**: Models\ContactManagerServiceTest.cs ([큰 이미지를 보려면 클릭](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d3ff2-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>


<span data-ttu-id="d3ff2-229">처음에 ContactManagerService 클래스에 의해 노출 CreateContact() 메서드를 테스트 하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="d3ff2-230">다음 5 개의 테스트를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="d3ff2-231">CreateContact()-테스트는 CreateContact() 유효한 연락처를 메서드에 전달 되 면 true를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="d3ff2-232">CreateContactRequiredFirstName()-오류 메시지가 모델 상태 때 누락 된 이름을 가진 연락처 추가 되어 있는지 테스트 CreateContact() 메서드에 전달 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d3ff2-233">CreateContactRequredLastName()-오류 메시지가 모델 상태 때 누락 된 성 가진 연락처를 추가 되어 있는지 테스트 CreateContact() 메서드에 전달 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-233">CreateContactRequredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d3ff2-234">CreateContactInvalidPhone()-오류 메시지가 모델 상태 때 잘못 된 전화 번호를 사용 하 여 연락처를 추가 되어 있는지 테스트 CreateContact() 메서드에 전달 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d3ff2-235">CreateContactInvalidEmail()-오류 메시지가 모델 상태 때 잘못 된 전자 메일 주소를 사용 하 여 연락처를 추가 되어 있는지 테스트 CreateContact() 메서드에 전달 됩니다...</span><span class="sxs-lookup"><span data-stu-id="d3ff2-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="d3ff2-236">첫 번째 테스트는 유효한 연락처를 유효성 검사 오류를 생성 하지 않는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="d3ff2-237">남은 테스트 각 유효성 검사 규칙을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="d3ff2-238">이러한 테스트에 대 한 코드는 목록 1에 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="d3ff2-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d3ff2-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]


<span data-ttu-id="d3ff2-240">목록 1에서 Contact 클래스를 사용 하기 때문에 테스트 프로젝트에 Microsoft Entity Framework에 대 한 참조를 추가 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="d3ff2-241">System.Data.Entity 어셈블리에 대 한 참조를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-241">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="d3ff2-242">목록 1 [TestInitialize] 특성으로 데코 레이트 된 initialize () 메서드가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="d3ff2-243">이 메서드는 각 단위 테스트를 실행 하기 전에 자동으로 호출 됩니다 (5 번 호출할 각 단위 테스트의 바로 앞).</span><span class="sxs-lookup"><span data-stu-id="d3ff2-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="d3ff2-244">Initialize () 메서드 코드의 다음 줄을 사용 하 여 모의 리포지토리를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="d3ff2-245">이 코드 줄 IContactManagerRepository 인터페이스에서 모의 리포지토리를 생성 하려면 Moq 프레임 워크를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="d3ff2-246">모의 리포지토리의 각 단위 테스트를 실행할 때 데이터베이스에 액세스를 방지 하려면 실제 EntityContactManagerRepository 대신 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="d3ff2-247">IContactManagerRepository 인터페이스의 메서드를 구현 하는 모의 리포지토리 하지만 메서드 don t 실제로 아무 것도 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d3ff2-248">간의 구분이 Moq 프레임 워크를 사용할 때 \_mockRepository 및 \_mockRepository.Object 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="d3ff2-249">이전의 Mock 가리킵니다&lt;IContactManagerRepository&gt; 모의 리포지토리를 동작 하는 방법을 지정 하는 메서드를 포함 하는 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="d3ff2-250">후자는 IContactManagerRepository 인터페이스를 구현 하는 실제 모의 리포지토리를 참조 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="d3ff2-251">모의 리포지토리 ContactManagerService 클래스의 인스턴스를 만들 때 initialize () 메서드에서 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="d3ff2-252">모든 개별 단위 테스트를 ContactManagerService 클래스의이 인스턴스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="d3ff2-253">목록 1 각 단위 테스트에 해당 하는 5 개의 메서드를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="d3ff2-254">이러한 각 메서드 [TestMethod] 특성으로 데코레이팅됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="d3ff2-255">단위 테스트를 실행 하면이 특성을 가진 모든 메서드 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="d3ff2-256">즉, [TestMethod] 특성으로 데코 레이트 된 모든 메서드는 단위 테스트.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="d3ff2-257">CreateContact(), 명명 된 첫 번째 단위 테스트를 연락처 클래스의 유효한 인스턴스 메서드에 전달 되 면 CreateContact() 호출 값이 true 반환 하는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="d3ff2-258">테스트는 Contact 클래스의 인스턴스를 만들고 CreateContact() 메서드를 호출 하며 CreateContact() 값이 true를 반환 하는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="d3ff2-259">남은 테스트 확인 잘못 된 연락처를 CreateContact() 메서드를 호출 하는 경우 다음 메서드에서 false가 반환 한 예상된 유효성 검사 오류 메시지가 모델 상태에 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="d3ff2-260">예를 들어 CreateContactRequiredFirstName() 테스트 FirstName 속성에 대해 빈 문자열을 사용 하 여 연락처 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="d3ff2-261">다음으로, CreateContact() 메서드는 잘못 된 연락처를 사용 하 여 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="d3ff2-262">마지막으로 테스트 확인 CreateContact() false를 반환 하 고 모델 상태에 필요한 유효성 검사 오류 메시지를 "이름은 필수입니다."</span><span class="sxs-lookup"><span data-stu-id="d3ff2-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="d3ff2-263">메뉴 옵션을 선택 하 여 목록 1에서 단위 테스트를 실행할 수 있습니다 **테스트를 실행 하 고 솔루션 (CTRL + R, A)의 모든 테스트**합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="d3ff2-264">테스트 결과 창에서 테스트의 결과가 표시 됩니다 (그림 4 참조).</span><span class="sxs-lookup"><span data-stu-id="d3ff2-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


<span data-ttu-id="d3ff2-265">[![테스트 결과](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="d3ff2-266">**그림 04**: 테스트 결과 ([큰 이미지를 보려면 클릭](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d3ff2-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="d3ff2-267">컨트롤러에 대 한 단위 테스트 만들기</span><span class="sxs-lookup"><span data-stu-id="d3ff2-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="d3ff2-268">ASP.NETMVC 응용 프로그램의 사용자 상호 작용 흐름을 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="d3ff2-269">컨트롤러를 테스트할 때는 컨트롤러 오른쪽 작업 결과 및 뷰 데이터를 반환 하는지 여부를 테스트 하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="d3ff2-270">또한 하려는 컨트롤러를 예상 하는 방식으로 모델 클래스와 상호 작용 하는지 여부를 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="d3ff2-271">예를 들어 목록 2 create () 메서드 담당자 컨트롤러에 대 한 두 개의 단위 테스트를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="d3ff2-272">인덱스 작업 create () 메서드 리디렉션됩니다 유효한 연락처를 create () 메서드에 전달 되 면 첫 번째 단위 테스트는 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="d3ff2-273">즉, 유효한 연락처를 전달 하는 경우 create () 메서드는 인덱스 작업을 나타내는 RedirectToRouteResult 반환 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="d3ff2-274">T 컨트롤러 계층을 테스트 하는 경우 ContactManager 서비스 계층을 테스트 하려는 하지 것입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="d3ff2-275">따라서에서는 모의 Initialize 메서드에 다음 코드를 사용 하 여 서비스 계층:</span><span class="sxs-lookup"><span data-stu-id="d3ff2-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="d3ff2-276">CreateValidContact() 단위 테스트에서에서는 모의 서비스 계층의 다음 줄의 코드로 CreateContact() 메서드 호출의 동작:</span><span class="sxs-lookup"><span data-stu-id="d3ff2-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="d3ff2-277">이 코드 줄 하면 모의 ContactManager 서비스가 해당 CreateContact() 메서드가 호출 되 면 true를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="d3ff2-278">서비스 계층을 모의에서는 서비스 계층에서 모든 코드를 실행 하지 않고도 컨트롤러의 동작을 테스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="d3ff2-279">두 번째 단위 테스트는 잘못 된 연락처를 메서드에 전달 될 때 create () 작업 만들기 뷰를 반환 하는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="d3ff2-280">서비스 계층 CreateContact() 메서드 코드의 다음 줄을 사용 하 여 값 false를 반환 하면:</span><span class="sxs-lookup"><span data-stu-id="d3ff2-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="d3ff2-281">Create () 메서드를 의도 한 대로 동작 하는 경우 서비스 계층 값 false를 반환 하는 경우 Create view를 반환 해야 하 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="d3ff2-282">이런 방식으로 컨트롤러 뷰 만들기에서에서 유효성 검사 오류 메시지를 표시할 수 있고 사용자는 잘못 된 연락처 속성을 수정할 수 있는 기회입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="d3ff2-283">컨트롤러에 대 한 단위 테스트를 빌드 하려는 경우 다음 해야 컨트롤러 작업에서 명시적 보기 이름을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="d3ff2-284">예를 들어, 다음과 같은 뷰를 반환 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="d3ff2-285">View();를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-285">return View();</span></span>

<span data-ttu-id="d3ff2-286">대신, 다음과 같은 보기를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-286">Instead, return the view like this:</span></span>

<span data-ttu-id="d3ff2-287">View("Create");를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-287">return View("Create");</span></span>

<span data-ttu-id="d3ff2-288">없는 경우 명시적 보기를 반환 하는 경우 ViewResult.ViewName 속성이 빈 문자열을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


<span data-ttu-id="d3ff2-289">**2-Controllers\ContactControllerTest.cs 나열**</span><span class="sxs-lookup"><span data-stu-id="d3ff2-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="d3ff2-290">요약</span><span class="sxs-lookup"><span data-stu-id="d3ff2-290">Summary</span></span>

<span data-ttu-id="d3ff2-291">이 반복에서 연락처 관리자 응용 프로그램에 대 한 단위 테스트 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="d3ff2-292">언제 든 지 응용 프로그램 것으로 예상 하는 방식으로 계속 작동 하는지 확인 하려면 이러한 단위 테스트를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="d3ff2-293">단위 테스트를 나중에 응용 프로그램을 안전 하 게 수정할 수 있어 응용 프로그램에 대 한 안전망으로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="d3ff2-294">두 개의 단위 테스트 집합을 만들었습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-294">We created two sets of unit tests.</span></span> <span data-ttu-id="d3ff2-295">첫째, 유효성 검사 논리는 서비스 계층에 대 한 단위 테스트를 만들어 테스트 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="d3ff2-296">다음으로,이 흐름 제어 논리는 컨트롤러 계층에 대 한 단위 테스트를 만들어 테스트 했습니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="d3ff2-297">이 서비스 계층을 테스트할 때에서는 별로 격리 된 테스트는 서비스 계층에 대 한이 저장소 계층에서이 저장소 계층을 모의 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="d3ff2-298">컨트롤러 계층을 테스트할 때에서는 별로 격리 된 테스트는 컨트롤러 계층에 대 한 모의 서비스 계층입니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="d3ff2-299">다음 반복에서는 수정 연락처 관리자 응용 프로그램에 게 문의 그룹을 지원 하도록 해당 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="d3ff2-300">이 새로운 기능 테스트 기반 개발을 호출 하는 소프트웨어 디자인 프로세스를 사용 하 여 응용 프로그램을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="d3ff2-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d3ff2-301">[이전](iteration-4-make-the-application-loosely-coupled-cs.md)
> [다음](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d3ff2-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
