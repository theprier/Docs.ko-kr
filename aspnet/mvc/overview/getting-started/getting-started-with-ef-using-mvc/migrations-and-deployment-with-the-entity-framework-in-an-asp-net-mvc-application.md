---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
title: Code First 마이그레이션 및 ASP.NET MVC 응용 프로그램에서 Entity Framework 사용 하 여 배포 | Microsoft Docs
author: tdykstra
description: Contoso University 샘플 웹 응용 프로그램에는 Entity Framework 6 Code First 및 Visual Studio를 사용 하 여 ASP.NET MVC 5 응용 프로그램을 만드는 방법을 보여 줍니다...
ms.author: aspnetcontent
ms.date: 11/07/2014
ms.assetid: d4dfc435-bda6-4621-9762-9ba270f8de4e
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 7c7092b770231b26fd666786af2e202acd70bc8a
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37838688"
---
<a name="code-first-migrations-and-deployment-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="7723b-103">Code First 마이그레이션 및 ASP.NET MVC 응용 프로그램에서 Entity Framework 사용 하 여 배포</span><span class="sxs-lookup"><span data-stu-id="7723b-103">Code First Migrations and Deployment with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="7723b-104">[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="7723b-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="7723b-105">[완료 된 프로젝트를 다운로드](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) 또는 [PDF 다운로드](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="7723b-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="7723b-106">Contoso University 샘플 웹 응용 프로그램에는 Entity Framework 6 Code First 및 Visual Studio 2013을 사용 하 여 ASP.NET MVC 5 응용 프로그램을 만드는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="7723b-107">자습서 시리즈에 대한 정보는 [시리즈의 첫 번째 자습서](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7723b-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="7723b-108">지금까지 응용 프로그램에서 실행 되었음을 로컬 IIS Express 개발 컴퓨터에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-108">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="7723b-109">실제 응용 프로그램을 사용 하 여 인터넷을 통해 다른 사람들이 사용할 수 있도록 하려면 웹 호스팅 공급자에 배포 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-109">To make a real application available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="7723b-110">이 자습서에서는 Azure에서 클라우드로 Contoso University 응용 프로그램 배포.</span><span class="sxs-lookup"><span data-stu-id="7723b-110">In this tutorial, you'll deploy the Contoso University application to the cloud in Azure.</span></span>

<span data-ttu-id="7723b-111">자습서에는 다음과 같은 섹션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-111">The tutorial contains the following sections:</span></span>

- <span data-ttu-id="7723b-112">Code First 마이그레이션을 사용 하도록 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-112">Enable Code First Migrations.</span></span> <span data-ttu-id="7723b-113">마이그레이션 기능을 사용 하면 데이터 모델을 변경 하 고 삭제 하 고 데이터베이스를 다시 만들 필요 없이 데이터베이스 스키마를 업데이트 하 여 변경 내용을 프로덕션에 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-113">The Migrations feature enables you to change the data model and deploy your changes to production by updating the database schema without having to drop and re-create the database.</span></span>
- <span data-ttu-id="7723b-114">Azure에 배포 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-114">Deploy to Azure.</span></span> <span data-ttu-id="7723b-115">이 단계는 선택 사항입니다. 프로젝트를 배포 하지 않고 나머지 자습서를 사용 하 여 계속할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-115">This step is optional; you can continue with the remaining tutorials without having deployed the project.</span></span>

<span data-ttu-id="7723b-116">소스 제어를 사용 하 여 지속적인 통합 프로세스를 사용 하 여 배포에 대 한 있지만이 자습서에서는 해당 항목을 다루지 않습니다 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-116">We recommend that you use a continuous integration process with source control for deployment, but this tutorial does not cover those topics.</span></span> <span data-ttu-id="7723b-117">자세한 내용은 참조는 [소스 제어](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) 및 [연속 통합](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) 챕터의를 [Azure 사용 하 여 실제 클라우드 앱 빌드](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) 전자책.</span><span class="sxs-lookup"><span data-stu-id="7723b-117">For more information, see the [source control](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) and [continuous integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) chapters of the [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-book.</span></span>

## <a name="enable-code-first-migrations"></a><span data-ttu-id="7723b-118">인스턴스 중 하나를 마우스 오른쪽 단추로 클릭  을 클릭 해결를 클릭 하 고 System.Collections.Generic를 사용 하 여입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-118">Enable Code First Migrations</span></span>

<span data-ttu-id="7723b-119">새 응용 프로그램을 개발하는 경우 데이터 모델은 자주 변경되며 모델이 변경될 때마다 데이터베이스와 동기화를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-119">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database.</span></span> <span data-ttu-id="7723b-120">자동으로 삭제 하 고 데이터 모델을 변경할 때마다 데이터베이스를 다시 만들지를 Entity Framework를 구성 했습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-120">You have configured the Entity Framework to automatically drop and re-create the database each time you change the data model.</span></span> <span data-ttu-id="7723b-121">때 추가, 제거 또는 엔터티 클래스를 변경 하거나 변경 하 `DbContext` 클래스 다음에 응용 프로그램을 실행할 때 자동으로 기존 데이터베이스를 삭제, 모델을 테스트 데이터로 시드합니다를 새로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-121">When you add, remove, or change entity classes or change your `DbContext` class, the next time you run the application it automatically deletes your existing database, creates a new one that matches the model, and seeds it with test data.</span></span>

<span data-ttu-id="7723b-122">데이터베이스를 데이터 모델과 동기화된 상태로 유지하는 이 메서드는 응용 프로그램을 프로덕션 환경에 배포할 때까지 잘 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-122">This method of keeping the database in sync with the data model works well until you deploy the application to production.</span></span> <span data-ttu-id="7723b-123">프로덕션 환경에서 실행 중이면 응용 프로그램을 유지 하 고 새 열을 추가 하는 등 변경 될 때마다 모든 손실 하지 않으려는 데이터를 저장 일반적으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-123">When the application is running in production, it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column.</span></span> <span data-ttu-id="7723b-124">합니다 [Code First 마이그레이션을](https://msdn.microsoft.com/data/jj591621) 삭제 하 고 데이터베이스를 다시 작성 하는 대신 데이터베이스 스키마를 업데이트 하려면 Code First를 사용 하 여이 문제를 해결 하는 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-124">The [Code First Migrations](https://msdn.microsoft.com/data/jj591621) feature solves this problem by enabling Code First to update the database schema instead of dropping and re-creating the database.</span></span> <span data-ttu-id="7723b-125">이 자습서에서는 응용 프로그램을 배포 하 고를 준비 하려면 마이그레이션 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-125">In this tutorial, you'll deploy the application, and to prepare for that you'll enable Migrations.</span></span>

1. <span data-ttu-id="7723b-126">이전 주석으로 처리 하거나 삭제 하 여 설정한 이니셜라이저를 사용 하지 않도록 설정 된 `contexts` 응용 프로그램 Web.config 파일에 추가 하는 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-126">Disable the initializer that you set up earlier by commenting out or deleting the `contexts` element that you added to the application Web.config file.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.xml?highlight=2,6)]
2. <span data-ttu-id="7723b-127">응용 프로그램에도 *Web.config* 파일, 연결 문자열에 데이터베이스의 이름을 ContosoUniversity2로 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-127">Also in the application *Web.config* file, change the name of the database in the connection string to ContosoUniversity2.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.xml?highlight=2)]

    <span data-ttu-id="7723b-128">이러한 변경은 첫 번째 마이그레이션이 새 데이터베이스를 만드는 프로젝트를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-128">This change sets up the project so that the first migration will create a new database.</span></span> <span data-ttu-id="7723b-129">이 필요치 있지만 것이 좋습니다 나중에 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-129">This isn't required but you'll see later why it's a good idea.</span></span>
3. <span data-ttu-id="7723b-130">**도구** 메뉴에서 클릭 **라이브러리 패키지 관리자** 차례로 **패키지 관리자 콘솔**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-130">From the **Tools** menu, click **Library Package Manager** and then **Package Manager Console**.</span></span>

    ![Selecting_Package_Manager_Console](https://asp.net/media/4336350/1pm.png)
4. <span data-ttu-id="7723b-132">에 `PM>` 프롬프트에 다음 명령을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-132">At the `PM>` prompt enter the following commands:</span></span>

    `enable-migrations`  
    `add-migration InitialCreate`

    ![코드를 추가 합니다  메서드는 데이터베이스에 고정된 데이터를 삽입할 수 있는 여러 가지 방법 중 하나입니다.](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

    <span data-ttu-id="7723b-134">`enable-migrations` 명령은 만듭니다는 *마이그레이션을* ContosoUniversity 프로젝트에서 폴더는 폴더에 저장을 *Configuration.cs* 파일을 편집 하 여 마이그레이션을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-134">The `enable-migrations` command creates a *Migrations* folder in the ContosoUniversity project, and it puts in that folder a *Configuration.cs* file that you can edit to configure Migrations.</span></span>

    <span data-ttu-id="7723b-135">(데이터베이스 이름을 변경 하도록 안내 하는 위의 단계를 놓친 경우는 기존 데이터베이스 마이그레이션과 자동으로 수행 된 `add-migration` 명령입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-135">(If you missed the step above that directs you to change the database name, Migrations will find the existing database and automatically do the `add-migration` command.</span></span> <span data-ttu-id="7723b-136">뭐, 뜻 데이터베이스를 배포 하기 전에 마이그레이션 코드의 테스트를 실행 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-136">That's OK, it just means you won't run a test of the migrations code before you deploy the database.</span></span> <span data-ttu-id="7723b-137">실행할 때 이상는 `update-database` 명령 데이터베이스는 이미 존재 하므로 아무 작업도 수행 합니다.)</span><span class="sxs-lookup"><span data-stu-id="7723b-137">Later when you run the `update-database` command nothing will happen because the database will already exist.)</span></span>

    ![예제에 표시 합니다 데이터베이스 업데이트 배포 자습서입니다.](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

    <span data-ttu-id="7723b-139">이니셜라이저 클래스는 이전에 본 것 처럼 합니다 `Configuration` 클래스에 포함 되어는 `Seed` 메서드.</span><span class="sxs-lookup"><span data-stu-id="7723b-139">Like the initializer class that you saw earlier, the `Configuration` class includes a `Seed` method.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

    <span data-ttu-id="7723b-140">용도 [시드](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) 메서드를 삽입 하거나 Code First를 만들거나 데이터베이스를 업데이트 한 후 테스트 데이터를 업데이트할 수 있도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-140">The purpose of the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is to enable you to insert or update test data after Code First creates or updates the database.</span></span> <span data-ttu-id="7723b-141">메서드는 데이터베이스를 만들 때와 데이터 모델을 변경한 후 데이터베이스 스키마가 업데이트 될 때마다 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-141">The method is called when the database is created and every time the database schema is updated after a data model change.</span></span>

### <a name="set-up-the-seed-method"></a><span data-ttu-id="7723b-142">Seed 메서드 설정</span><span class="sxs-lookup"><span data-stu-id="7723b-142">Set up the Seed Method</span></span>

<span data-ttu-id="7723b-143">삭제 된 시점과 이니셜라이저 클래스를 사용 하면 모든 데이터 모델 변경에 대해 데이터베이스를 다시 만들 `Seed` 모델 변경할 때마다 데이터베이스가 삭제 됩니다 때문에 테스트 데이터를 삽입 하는 방법 및 모든 테스트 데이터가 손실 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-143">When you are dropping and re-creating the database for every data model change, you use the initializer class's `Seed` method to insert test data, because after every model change the database is dropped and all the test data is lost.</span></span> <span data-ttu-id="7723b-144">Code First 마이그레이션, 데이터베이스 변경 후 데이터는 유지 하는 테스트의 테스트 데이터를 포함 하므로 합니다 [시드](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) 일반적으로 메서드는 필요 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-144">With Code First Migrations, test data is retained after database changes, so including test data in the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is typically not necessary.</span></span> <span data-ttu-id="7723b-145">사실, 원하지는 `Seed` 사용할 마이그레이션 데이터베이스를 프로덕션에 배포 하려면 때문에 경우에 테스트 데이터를 삽입 하는 방법의 `Seed` 메서드는 프로덕션 환경에서 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-145">In fact, you don't want the `Seed` method to insert test data if you'll be using Migrations to deploy the database to production, because the `Seed` method will run in production.</span></span> <span data-ttu-id="7723b-146">원하는 경우에 `Seed` 프로덕션 환경에서 필요한 데이터만 데이터베이스에 삽입 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-146">In that case you want the `Seed` method to insert into the database only the data that you need in production.</span></span> <span data-ttu-id="7723b-147">예를 들어 데이터베이스의 실제 부서 이름을 포함 하려면이 좋습니다는 `Department` 응용 프로그램이 프로덕션 환경에서 사용 가능 해지면 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-147">For example, you might want the database to include actual department names in the `Department` table when the application becomes available in production.</span></span>

<span data-ttu-id="7723b-148">이 자습서에서는 사용할 마이그레이션 배포용 하지만 `Seed` 메서드는 테스트 데이터 삽입 그래도 쉽게 응용 프로그램 기능을 많은 양의 데이터를 수동으로 삽입 하지 않고도 작동 하는 방식을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-148">For this tutorial, you'll be using Migrations for deployment, but your `Seed` method will insert test data anyway in order to make it easier to see how application functionality works without having to manually insert a lot of data.</span></span>

1. <span data-ttu-id="7723b-149">내용을 대체 합니다 *Configuration.cs* 가 새 데이터베이스에 테스트 데이터를 로드 하는 다음 코드를 사용 하 여 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-149">Replace the contents of the *Configuration.cs* file with the following code, which will load test data into the new database.</span></span> 

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

    <span data-ttu-id="7723b-150">합니다 [시드](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) 메서드는 입력된 매개 변수로 데이터베이스 컨텍스트 개체를 사용 하 고 메서드에서 코드를 해당 개체를 사용 하 여 데이터베이스에 새 엔터티를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-150">The [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="7723b-151">각 엔터티 형식에 대 한 코드를 새 엔터티 컬렉션을 만듭니다, 적절 한 추가한 [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) 속성 및 데이터베이스에 변경 내용 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-151">For each entity type, the code creates a collection of new entities, adds them to the appropriate [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) property, and then saves the changes to the database.</span></span> <span data-ttu-id="7723b-152">호출할 필요는 없습니다 합니다 [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) 엔터티의 각 그룹 뒤 메서드를으로 여기에서 수행 되지만 코드는 데이터베이스에 쓰는 동안 예외가 발생 하는 경우 문제의 소스를 찾을 수 있습니다 작업을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-152">It isn't necessary to call the [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

    <span data-ttu-id="7723b-153">일부 데이터를 삽입 하는 문을 사용 합니다 [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) "upsert" 작업을 수행 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-153">Some of the statements that insert data use the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method to perform an "upsert" operation.</span></span> <span data-ttu-id="7723b-154">때문에 합니다 `Seed` 메서드를 실행할 때마다 실행 되는 `update-database` 명령, 일반적으로 각 마이그레이션 후 이기 때문에 추가 하려는 행 이미 있는 데이터베이스를 만드는 첫 번째 마이그레이션 후에 데이터를 삽입할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-154">Because the `Seed` method runs every time you execute the `update-database` command, typically after each migration, you can't just insert data, because the rows you are trying to add will already be there after the first migration that creates the database.</span></span> <span data-ttu-id="7723b-155">"Upsert" 작업 하지만 이미 존재 하는 행을 삽입 하려고 할 경우는 오류를 방지할 수 ***재정의*** 응용 프로그램을 테스트 하는 동안 만들어졌을 수 있는 데이터를 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-155">The "upsert" operation prevents errors that would happen if you try to insert a row that already exists, but it ***overrides*** any changes to data that you may have made while testing the application.</span></span> <span data-ttu-id="7723b-156">일부 테이블의 테스트 데이터를 사용 하 여 하지 않으려는 경우이 위해서는: 경우에 따라 테스트 하는 동안 데이터를 변경한 경우 원하는 데이터베이스 업데이트 후 유지 하려면 변경 내용을 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-156">With test data in some tables you might not want that to happen: in some cases when you change data while testing you want your changes to remain after database updates.</span></span> <span data-ttu-id="7723b-157">조건부 삽입 작업을 수행 하려는 경우: 존재 하지 않는 경우에 행을 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-157">In that case you want to do a conditional insert operation: insert a row only if it doesn't already exist.</span></span> <span data-ttu-id="7723b-158">Seed 메서드는 두 가지 방법을 모두 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-158">The Seed method uses both approaches.</span></span>

    <span data-ttu-id="7723b-159">첫 번째 매개 변수가 전달 되는 [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) 메서드는 행이 이미 존재 하는지 확인 하는 데 속성을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-159">The first parameter passed to the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method specifies the property to use to check if a row already exists.</span></span> <span data-ttu-id="7723b-160">테스트 학생 데이터를 제공 하는 대 한는 `LastName` 목록의 마지막 이름이 있으므로이 목적을 위해 속성을 사용 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-160">For the test student data that you are providing, the `LastName` property can be used for this purpose since each last name in the list is unique:</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

    <span data-ttu-id="7723b-161">이 코드는 마지막 이름이 고유한 지를 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-161">This code assumes that last names are unique.</span></span> <span data-ttu-id="7723b-162">중복 된 성 가진 학생을 수동으로 추가 하는 경우 마이그레이션을 수행한 다음에 다음 예외를 얻게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-162">If you manually add a student with a duplicate last name, you'll get the following exception the next time you perform a migration.</span></span>

    <span data-ttu-id="7723b-163">시퀀스에 요소가 둘 이상</span><span class="sxs-lookup"><span data-stu-id="7723b-163">Sequence contains more than one element</span></span>

    <span data-ttu-id="7723b-164">예: "Alexander Carson" 라는 두 학생 중복 데이터를 처리 하는 방법에 대 한 정보를 참조 하세요 [시드 및 디버깅 EF (Entity Framework) Db](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) Rick Anderson의 블로그에서입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-164">For information about how to handle redundant data such as two students named "Alexander Carson", see [Seeding and Debugging Entity Framework (EF) DBs](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="7723b-165">에 대 한 자세한 내용은 합니다 `AddOrUpdate` 메서드를 참조 하세요 [EF 4.3 AddOrUpdate 메서드를 사용 하 여 주의](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) Julie Lerman의 블로그입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-165">For more information about the `AddOrUpdate` method, see [Take care with EF 4.3 AddOrUpdate Method](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) on Julie Lerman's blog.</span></span>

    <span data-ttu-id="7723b-166">만드는 코드를 `Enrollment` 엔터티가 있다고 가정 합니다 `ID` 에 있는 엔터티의 값은 `students` 컬렉션 컬렉션을 만드는 코드는 해당 속성을 설정 하지 않은 하지만 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-166">The code that creates `Enrollment` entities assumes you have the `ID` value in the entities in the `students` collection, although you didn't set that property in the code that creates the collection.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs?highlight=2)]

    <span data-ttu-id="7723b-167">사용할 수는 `ID` 여기서 속성 때문에 `ID` 를 호출할 때 값이 설정 `SaveChanges` 에 대 한는 `students` 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-167">You can use the `ID` property here because the `ID` value is set when you call `SaveChanges` for the `students` collection.</span></span> <span data-ttu-id="7723b-168">데이터베이스 엔터티 삽입 및 업데이트 하는 경우 자동으로 기본 키 값을 가져옵니다 EF는 `ID` 메모리에서 엔터티의 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-168">EF automatically gets the primary key value when it inserts an entity into the database, and it updates the `ID` property of the entity in memory.</span></span>

    <span data-ttu-id="7723b-169">각 추가 하는 코드 `Enrollment` 엔터티를 합니다 `Enrollments` 엔터티 집합을 사용 하지 않습니다는 `AddOrUpdate` 메서드.</span><span class="sxs-lookup"><span data-stu-id="7723b-169">The code that adds each `Enrollment` entity to the `Enrollments` entity set doesn't use the `AddOrUpdate` method.</span></span> <span data-ttu-id="7723b-170">확인 하는 경우 엔터티의 이미 있으며 존재 하지 않는 경우 엔터티를 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-170">It checks if an entity already exists and inserts the entity if it doesn't exist.</span></span> <span data-ttu-id="7723b-171">이 이렇게 변경 하면는 등록 엔터프라이즈급 응용 프로그램 UI를 사용 하 여이 유지 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-171">This approach will preserve changes you make to an enrollment grade by using the application UI.</span></span> <span data-ttu-id="7723b-172">코드의 각 멤버를 반복 합니다 `Enrollment` [목록](https://msdn.microsoft.com/library/6sh2ey19.aspx) 등록 데이터베이스에 없는 경우에 등록 데이터베이스에 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-172">The code loops through each member of the `Enrollment`[List](https://msdn.microsoft.com/library/6sh2ey19.aspx) and if the enrollment is not found in the database, it adds the enrollment to the database.</span></span> <span data-ttu-id="7723b-173">처음으로 데이터베이스를 업데이트할 데이터베이스 비게 됩니다 되므로 각 등록 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-173">The first time you update the database, the database will be empty, so it will add each enrollment.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs)]
2. <span data-ttu-id="7723b-174">프로젝트를 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-174">Build the project.</span></span>

### <a name="execute-the-first-migration"></a><span data-ttu-id="7723b-175">첫 번째 마이그레이션 실행</span><span class="sxs-lookup"><span data-stu-id="7723b-175">Execute the First Migration</span></span>

<span data-ttu-id="7723b-176">실행 하는 시기를 `add-migration` 명령을 마이그레이션을 처음부터 데이터베이스를 만들 수 있는 코드를 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-176">When you executed the `add-migration` command, Migrations generated the code that would create the database from scratch.</span></span> <span data-ttu-id="7723b-177">이 코드는 또한에 *마이그레이션을* 라는 파일에 있는 폴더  *&lt;타임 스탬프&gt;\_InitialCreate.cs*합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-177">This code is also in the *Migrations* folder, in the file named *&lt;timestamp&gt;\_InitialCreate.cs*.</span></span> <span data-ttu-id="7723b-178">`Up` 메서드를 `InitialCreate` 클래스에는 데이터 모델 엔터티 집합에 해당 하는 데이터베이스 테이블을 만듭니다 및 `Down` 메서드를 삭제 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-178">The `Up` method of the `InitialCreate` class creates the database tables that correspond to the data model entity sets, and the `Down` method deletes them.</span></span>

[!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

<span data-ttu-id="7723b-179">마이그레이션에서는 마이그레이션을 위한 데이터 모델 변경을 구현하기 위해 `Up` 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-179">Migrations calls the `Up` method to implement the data model changes for a migration.</span></span> <span data-ttu-id="7723b-180">업데이트를 롤백하는 명령을 입력하면 마이그레이션에서 `Down` 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-180">When you enter a command to roll back the update, Migrations calls the `Down` method.</span></span>

<span data-ttu-id="7723b-181">이 입력 했을 때 만들어진 초기 마이그레이션을 `add-migration InitialCreate` 명령입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-181">This is the initial migration that was created when you entered the `add-migration InitialCreate` command.</span></span> <span data-ttu-id="7723b-182">매개 변수 (`InitialCreate` 예제에서) 파일에 사용 되는 단어 또는 구를 요약 마이그레이션에서 수행 되는 일반적으로 선택;에 이름을 지정 하 고 원하는 수.</span><span class="sxs-lookup"><span data-stu-id="7723b-182">The parameter (`InitialCreate` in the example) is used for the file name and can be whatever you want; you typically choose a word or phrase that summarizes what is being done in the migration.</span></span> <span data-ttu-id="7723b-183">예를 들어 이후 마이그레이션의 이름을 수 있습니다 &quot;AddDepartmentTable&quot;합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-183">For example, you might name a later migration &quot;AddDepartmentTable&quot;.</span></span>

<span data-ttu-id="7723b-184">데이터베이스가 이미 존재할 때 초기 마이그레이션을 만든 경우 데이터베이스 만들기 코드가 생성되지만 데이터베이스는 이미 데이터 모델과 일치하기 때문에 실행할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-184">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model.</span></span> <span data-ttu-id="7723b-185">데이터베이스가 아직 없는 다른 환경에 앱을 배포하는 경우 이 코드를 실행하여 데이터베이스를 만들기 때문에 먼저 테스트하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-185">When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first.</span></span> <span data-ttu-id="7723b-186">바로 이것이 앞서 연결 문자열의 데이터베이스 이름을 변경한 이유입니다. 따라서 해당 마이그레이션은 처음부터 새로운 데이터베이스를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-186">That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.</span></span>

1. <span data-ttu-id="7723b-187">에 **패키지 관리자 콘솔** 창에서 다음 명령을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-187">In the **Package Manager Console** window, enter the following command:</span></span>

    `update-database`

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

    <span data-ttu-id="7723b-188">합니다 `update-database` 명령이 실행 되는 `Up` 데이터베이스를 만들고 해당 메서드를 실행 합니다 `Seed` 데이터베이스를 채우는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-188">The `update-database` command runs the `Up` method to create the database and then it runs the `Seed` method to populate the database.</span></span> <span data-ttu-id="7723b-189">동일한 프로세스에서에서 실행 됩니다 자동으로 프로덕션 응용 프로그램을 배포한 후 다음 섹션에서 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-189">The same process will run automatically in production after you deploy the application, as you'll see in the following section.</span></span>
2. <span data-ttu-id="7723b-190">사용 하 여 **서버 탐색기** 첫 번째 자습서에서 수행한 것 처럼 데이터베이스를 검사 하 여 작동 하는지 확인 하려면 모든 여전히 동일한 이전 처럼 응용 프로그램을 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-190">Use **Server Explorer** to inspect the database as you did in the first tutorial, and run the application to verify that everything still works the same as before.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="7723b-191">Azure에 배포</span><span class="sxs-lookup"><span data-stu-id="7723b-191">Deploy to Azure</span></span>

<span data-ttu-id="7723b-192">지금까지 응용 프로그램에서 실행 되었음을 로컬 IIS Express 개발 컴퓨터에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-192">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="7723b-193">인터넷을 통해 사용 하도록 다른 사용자를 위해 사용할 수 있도록 하려면 웹 호스팅 공급자를 배포 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-193">To make it available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="7723b-194">이 자습서의이 섹션에서는 Azure에 배포 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-194">In this section of the tutorial you'll deploy it to Azure.</span></span> <span data-ttu-id="7723b-195">이 섹션은 선택 사항입니다. 이 생략 하 고 계속 다음 자습서를 진행 또는 원하는 다른 호스팅 공급자에 대 한이 섹션의 지침을 조정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-195">This section is optional; you can skip this and continue with the following tutorial, or you can adapt the instructions in this section for a different hosting provider of your choice.</span></span>

### <a name="using-code-first-migrations-to-deploy-the-database"></a><span data-ttu-id="7723b-196">Code First 마이그레이션을 사용 하 여 데이터베이스를 배포 하려면</span><span class="sxs-lookup"><span data-stu-id="7723b-196">Using Code First Migrations to Deploy the Database</span></span>

<span data-ttu-id="7723b-197">데이터베이스를 배포 하려면 Code First 마이그레이션을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-197">To deploy the database you'll use Code First Migrations.</span></span> <span data-ttu-id="7723b-198">Visual Studio에서 배포에 대 한 설정을 구성 하는 데 사용 하는 게시 프로필을 만들 때 확인란이 선택 **데이터베이스 업데이트**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-198">When you create the publish profile that you use to configure settings for deploying from Visual Studio, you'll select a check box labeled **Update Database**.</span></span> <span data-ttu-id="7723b-199">이렇게이 설정 하면 자동으로 응용 프로그램을 구성 하는 배포 프로세스 *Web.config* Code First 사용 되도록 대상 서버에서 파일을 `MigrateDatabaseToLatestVersion` 이니셜라이저 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-199">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>

<span data-ttu-id="7723b-200">Visual Studio 프로젝트가 대상 서버로 복사 하는 동안 배포 프로세스 중 데이터베이스를 사용 하 여 어떤 작업도 수행 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-200">Visual Studio doesn't do anything with the database during the deployment process while it is copying your project to the destination server.</span></span> <span data-ttu-id="7723b-201">배포 된 응용 프로그램을 실행 하 고 배포 후 처음으로 데이터베이스에 액세스 하는 경우 Code First 데이터베이스 데이터 모델과 일치 하는 경우 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-201">When you run the deployed application and it accesses the database for the first time after deployment, Code First checks if the database matches the data model.</span></span> <span data-ttu-id="7723b-202">불일치의 경우 Code First 자동으로 데이터베이스를 만듭니다 (아직 존재 하지 않는) 하는 경우 또는 최신 버전으로 데이터베이스 스키마 업데이트 (데이터베이스 존재 하지만 모델과 일치 하지 않습니다) 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-202">If there's a mismatch, Code First automatically creates the database (if it doesn't exist yet) or updates the database schema to the latest version (if a database exists but doesn't match the model).</span></span> <span data-ttu-id="7723b-203">응용 프로그램을 마이그레이션을 구현 하는 경우 `Seed` 메서드를 메서드 실행 후 데이터베이스를 만들거나 스키마 업데이트 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-203">If the application implements a Migrations `Seed` method, the method runs after the database is created or the schema is updated.</span></span>

<span data-ttu-id="7723b-204">마이그레이션을 `Seed` 메서드 테스트 데이터를 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-204">Your Migrations `Seed` method inserts test data.</span></span> <span data-ttu-id="7723b-205">변경 해야 프로덕션 환경에 배포 하는 경우는 `Seed` 메서드 한다는 프로덕션 데이터베이스에 삽입할 하려는 데이터를 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-205">If you were deploying to a production environment, you would have to change the `Seed` method so that it only inserts data that you want to be inserted into your production database.</span></span> <span data-ttu-id="7723b-206">예를 들어, 현재 데이터 모델과 실제 과정 이지만 가상 학생 개발 데이터베이스에 하려는 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-206">For example, in your current data model you might want to have real courses but fictional students in the development database.</span></span> <span data-ttu-id="7723b-207">작성할 수 있습니다는 `Seed` 개발에서 모두를 로드 하 고 프로덕션에 배포 하기 전에 가상의 학생 들을 다음 주석 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-207">You can write a `Seed` method to load both in development, and then comment out the fictional students before you deploy to production.</span></span> <span data-ttu-id="7723b-208">작성할 수 있습니다 또는 `Seed` 과정만을 로드 하 고 응용 프로그램의 UI를 사용 하 여 테스트 데이터베이스에 가상의 학생 들에 게 수동으로 입력 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-208">Or you can write a `Seed` method to load only courses, and enter the fictional students in the test database manually by using the application's UI.</span></span>

### <a name="get-an-azure-account"></a><span data-ttu-id="7723b-209">Azure 계정 가져오기</span><span class="sxs-lookup"><span data-stu-id="7723b-209">Get an Azure account</span></span>

<span data-ttu-id="7723b-210">Azure 계정이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-210">You'll need an Azure account.</span></span> <span data-ttu-id="7723b-211">Visual Studio 구독을 필요가 없는, 하지만 수 있습니다 [구독 혜택을 활성화](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-211">If you don't already have one, but you do have a Visual Studio subscription, you can [activate your subscription benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span></span> <span data-ttu-id="7723b-212">이 고, 그렇지 몇 분만에 무료 평가판 계정을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-212">Otherwise, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="7723b-213">자세한 내용은 참조 하세요 [Azure 무료 평가판](https://azure.microsoft.com/free/)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-213">For details, see [Azure Free Trial](https://azure.microsoft.com/free/).</span></span>

### <a name="create-a-web-site-and-a-sql-database-in-azure"></a><span data-ttu-id="7723b-214">Azure에서 웹 사이트 및 SQL database 만들기</span><span class="sxs-lookup"><span data-stu-id="7723b-214">Create a web site and a SQL database in Azure</span></span>

<span data-ttu-id="7723b-215">Azure에서 웹 앱은 다른 Azure 클라이언트와 공유 되는 virtual machines (Vm)에서 실행 됨을 의미 하는 공유 호스팅 환경에서 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-215">Your web app in Azure will run in a shared hosting environment, which means it runs on virtual machines (VMs) that are shared with other Azure clients.</span></span> <span data-ttu-id="7723b-216">공유 호스팅 환경에는 클라우드에서 시작 방법 저렴 한 비용입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-216">A shared hosting environment is a low-cost way to get started in the cloud.</span></span> <span data-ttu-id="7723b-217">나중에 웹 트래픽이 증가 하면 응용 프로그램 전용된 Vm에서 실행 하 여 필요에 맞게 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-217">Later, if your web traffic increases, the application can scale to meet the need by running on dedicated VMs.</span></span> <span data-ttu-id="7723b-218">Azure App Service에 대 한 가격 책정 옵션에 대 한 자세히 알아보려면 설명서를 참조에서 [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span><span class="sxs-lookup"><span data-stu-id="7723b-218">To learn more about Pricing Options for Azure App Service, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span></span>

<span data-ttu-id="7723b-219">Azure SQL Database로 데이터베이스를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-219">You'll deploy the database to Azure SQL Database.</span></span> <span data-ttu-id="7723b-220">SQL Database는 SQL Server 기술에 기본 제공 되는 클라우드 기반 관계형 데이터베이스 서비스입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-220">SQL Database is a cloud-based relational database service that is built on SQL Server technologies.</span></span> <span data-ttu-id="7723b-221">SQL Database를 사용 하 여 도구와 SQL Server를 사용 하는 응용 프로그램 에서도 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-221">Tools and applications that work with SQL Server also work with SQL Database.</span></span>

1. <span data-ttu-id="7723b-222">에 [Azure 관리 포털](https://portal.azure.com), 클릭 **새로 만들기** 왼쪽된 탭에서 클릭 **모두 보기** 새 블레이드를 클릭 한 다음에 **웹 앱 및 SQL** 에 **웹** 절 및 finally **만들기**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-222">In the [Azure Management Portal](https://portal.azure.com), click **New** in the left tab, click **See all** in new blade, and then click **Web App & SQL** in the **Web** Section and finally **Create**.</span></span>

    ![관리 포털에서 새 단추](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/CreateWeb-Sql.png)

   <span data-ttu-id="7723b-224">합니다 **새 웹 앱 및 SQL-만들기** 마법사가 열립니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-224">The **New Web App & SQL - Create** wizard opens.</span></span>

2. <span data-ttu-id="7723b-225">블레이드에서 문자열을 입력 합니다 **앱 이름** 상자를 응용 프로그램에 대 한 고유 URL로 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-225">In the blade, enter a string in the **App name** box to use as the unique URL for your application.</span></span> <span data-ttu-id="7723b-226">전체 URL을 여기에 입력 및 Azure App Services의 기본 도메인으로 구성 됩니다 (. azurewebsites.net).</span><span class="sxs-lookup"><span data-stu-id="7723b-226">The complete URL will consist of what you enter here plus the default domain of Azure App Services (.azurewebsites.net).</span></span> <span data-ttu-id="7723b-227">경우는 **앱 이름** 이미 수행 되지 않고 마법사는 알려주고이 빨간색 *앱 이름을 사용할 수 없는* 메시지입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-227">If the **App name** is already taken, the Wizard will notify you of this with a red *The app name is not available* message.</span></span> <span data-ttu-id="7723b-228">경우는 **앱 이름** 는 사용 가능한 하면 녹색 확인 표시가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-228">If the **App name** is available, you will get a green checkmark.</span></span>

    ![관리 포털에서 데이터베이스 링크를 사용 하 여 만들기](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-WebApp.png)

3. <span data-ttu-id="7723b-230">에 **구독** 드롭다운에서 하려는 Azure 구독을 선택 하세요 합니다 **App Service** 상주 하 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-230">In the **Subscription** Dropdown, please choose the Azure Subscription in which you want the **App Service** to reside.</span></span>

4. <span data-ttu-id="7723b-231">에 **리소스 그룹** 텍스트 상자에 리소스 그룹을 선택 하거나 새로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-231">In the **Resource Group** text box, choose a Resource Group or create a new one.</span></span> <span data-ttu-id="7723b-232">이 설정은 웹 사이트에서 실행 됩니다 하는 데이터 센터를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-232">This setting specifies which data center your web site will run in.</span></span> <span data-ttu-id="7723b-233">리소스 그룹에 대 한 자세한 내용은 설명서에서 읽은 [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-233">For more information about Resource Groups, read the documentation on [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span></span>
5. <span data-ttu-id="7723b-234">새 **App Service 계획** 를 클릭 하 여는 *App Service 섹션*, **새로 만들기**를 입력 **App Service 계획** (같은 이름으로 일 수 있음 App Service) **위치**, 및 **가격 책정 계층** (사용 가능한 옵션은).</span><span class="sxs-lookup"><span data-stu-id="7723b-234">Create a new **App Service Plan** by clicking the *App Service section*, **Create New**, and fill in **App Service plan** (can be same name as App Service), **Location**, and **Pricing tier** (there is a free option).</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-AppService.png)
6. <span data-ttu-id="7723b-235">클릭 합니다 **SQL Database**, 선택한 *새로 만들기* 하거나 기존 데이터베이스를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-235">Click the **SQL Database**, and choose *Create New* or select an existing database</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-Database.png)

7. <span data-ttu-id="7723b-236">에 **이름을** 상자에서 데이터베이스의 이름을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-236">In the **Name** box, enter a name for your database.</span></span>
8. <span data-ttu-id="7723b-237">클릭 합니다 **대상 서버** 상자에서 **새 서버 만들기**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-237">Click the **Target Server** box, select **Create a new server**.</span></span> <span data-ttu-id="7723b-238">또는 서버를 이전에 만든 경우 해당 서버를 사용할 수 있는 서버 목록에서 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-238">Alternatively, if you previously created a server, you can select that server from list of available servers.</span></span>
9. <span data-ttu-id="7723b-239">선택할 **가격 책정 계층** 섹션을 선택 *무료*합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-239">Choose **Pricing tier** section, choose *Free*.</span></span> <span data-ttu-id="7723b-240">추가 리소스가 필요한 경우 데이터베이스 언제 든 지 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-240">If additional resources are needed, the database can be scaled up at any time.</span></span> <span data-ttu-id="7723b-241">Azure SQL 가격 책정 자세히 알아보려면 계속 읽어주세요 설명서 [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-241">To learn more on Azure SQL Pricing, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
10. <span data-ttu-id="7723b-242">수정할 [데이터 정렬](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) 필요에 따라 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-242">Modify [collation](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) as needed.</span></span>
11. <span data-ttu-id="7723b-243">관리자가 입력 **SQL 관리자 사용자 이름** 하 고 **SQL 관리자 암호**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-243">Enter an administrator **SQL Admin Username** and **SQL Admin Password**.</span></span> <span data-ttu-id="7723b-244">선택한 경우 **새 SQL Database 서버**기존 이름 및 여기에 암호를 입력 하지 않고, 새 이름 및 데이터베이스를 액세스 하는 경우 나중에 사용할 수 지금 정의 하는 암호를 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-244">If you selected **New SQL Database server**, you aren't entering an existing name and password here, you're entering a new name and password that you're defining now to use later when you access the database.</span></span> <span data-ttu-id="7723b-245">이전에 만든 서버를 선택한 경우 해당 서버에 대 한 자격 증명을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-245">If you selected a server that you created previously, you'll enter credentials for that server.</span></span>
12. <span data-ttu-id="7723b-246">Application Insights를 사용 하 여 App Service에 대 한 원격 분석 수집을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-246">Telemetry collection can be enabled for App Service using Application Insights.</span></span> <span data-ttu-id="7723b-247">간단한 구성 사용 하 여 application Insights는 중요 한 이벤트, 예외, 종속성, 요청 및 추적 정보를 수집 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-247">Application Insights with little configuration collects valuable event, exception, dependency, request, and trace information.</span></span> <span data-ttu-id="7723b-248">Application Insights에 대 한 자세한 내용은 시작할 [Azure Docs](https://azure.microsoft.com/services/application-insights/)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-248">To learn more about Application Insights, get started in [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span></span>
13. <span data-ttu-id="7723b-249">클릭 **만들기** 하 여 마쳤음을 블레이드의 맨 아래에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-249">Click **Create** at the bottom of the blade to indicate that you're finished.</span></span>
  
    <span data-ttu-id="7723b-250">관리 포털에서 대시보드 페이지로 반환 하며 **알림을** 블레이드에서 페이지의 맨 위에 있는 사이트는 생성 되 고 있음을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-250">The Management Portal returns to the Dashboards page, and the **Notifications** blade at the top of the page shows that the site is being created.</span></span> <span data-ttu-id="7723b-251">잠시 (일반적으로 1 분 미만), 배포 성공 알림이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-251">After a while (typically less than a minute), there will be a notification that the Deployment succeeded.</span></span> <span data-ttu-id="7723b-252">왼쪽 탐색 모음에서 새 **App Service** 에 표시 되는 *App Services* 섹션과 새 **SQL Database** 나타나는 *SQL 데이터베이스*  섹션입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-252">In the navigation bar at the left, the new **App Service** appears in the *App Services* section and the new **SQL Database** appears in the *SQL Databases* section.</span></span>

### <a name="deploy-the-application-to-azure"></a><span data-ttu-id="7723b-253">Azure 응용 프로그램 배포</span><span class="sxs-lookup"><span data-stu-id="7723b-253">Deploy the application to Azure</span></span>

1. <span data-ttu-id="7723b-254">Visual studio에서에서 프로젝트를 마우스 오른쪽 단추로 **솔루션 탐색기** 선택한 **게시** 상황에 맞는 메뉴입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-254">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
  
    ![프로젝트 상황에 맞는 메뉴에서 게시](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image10.png)
2. <span data-ttu-id="7723b-256">에 **프로필** 탭의 **웹 게시** 마법사 클릭 **Microsoft Azure App Service**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-256">In the **Profile** tab of the **Publish Web** wizard, click **Microsoft Azure App Service**.</span></span>
  
    ![게시 설정 가져오기](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-ChooseTarget.png)
3. <span data-ttu-id="7723b-258">Visual Studio에서 Azure 구독을 이전에 추가 하지 않은 경우 화면의 단계를 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-258">If you have not previously added your Azure subscription in Visual Studio, perform the steps on the screen.</span></span> <span data-ttu-id="7723b-259">다음이 단계를 사용 하도록 설정 연결 하도록 Visual Studio Azure 구독에 있으므로 목록을 **App Services** 웹 사이트가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-259">These steps enable Visual Studio to connect to your Azure subscription so that the list of **App Services** will include your web site.</span></span>
 
4. <span data-ttu-id="7723b-260">선택 합니다 **구독** 후에 App Service를 추가한를 **App Service 계획** App Service의 일부인 폴더 마지막으로 **App Service** 뒤 자체 **확인**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-260">Select the **Subscription** you added the App Service to, then the **App Service Plan** folder your App Service is a part of, and finally the **App Service** itself followed by **Ok**.</span></span>

    ![App Service를 선택 합니다.](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-AppService.png)
5. <span data-ttu-id="7723b-262">프로필을 구성한 후 합니다 **연결** 탭이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-262">After the Profile has been configured, the **Connection** tab will be shown.</span></span> <span data-ttu-id="7723b-263">클릭 **연결 유효성 검사** 설정이 정확한 지 확인 하려면</span><span class="sxs-lookup"><span data-stu-id="7723b-263">Click **Validate Connection** to make sure that the settings are correct</span></span>

    ![연결 유효성 검사](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Connection.png)
6. <span data-ttu-id="7723b-265">연결 검증 된 녹색 확인 표시가 옆에 표시 되는 **연결 유효성 검사** 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-265">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span> <span data-ttu-id="7723b-266">**다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-266">Click **Next**.</span></span>
  
    ![성공적으로 유효성이 검사 된 연결](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-SettingsValidated.png)
7. <span data-ttu-id="7723b-268">열기는 **원격 연결 문자열** 드롭 다운 목록에서 **SchoolContext** 만든 데이터베이스에 대 한 연결 문자열을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-268">Open the **Remote connection string** drop-down list under **SchoolContext** and select the connection string for the database you created.</span></span>
8. <span data-ttu-id="7723b-269">선택 **데이터베이스 업데이트**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-269">Select **Update database**.</span></span>

    ![설정 탭](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Settings.png)

    <span data-ttu-id="7723b-271">이렇게이 설정 하면 자동으로 응용 프로그램을 구성 하는 배포 프로세스 *Web.config* Code First 사용 되도록 대상 서버에서 파일을 `MigrateDatabaseToLatestVersion` 이니셜라이저 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-271">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>
9. <span data-ttu-id="7723b-272">**다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-272">Click **Next**.</span></span>
10. <span data-ttu-id="7723b-273">에 **미리 보기** 탭을 클릭 **미리 보기 시작**합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-273">In the **Preview** tab, click **Start Preview**.</span></span>
  
    ![미리 보기 탭에서 미리 단추](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Preview.png)
  
    <span data-ttu-id="7723b-275">탭에는 서버에 복사 될 파일의 목록을 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-275">The tab displays a list of the files that will be copied to the server.</span></span> <span data-ttu-id="7723b-276">미리 보기를 표시 합니다. 응용 프로그램을 게시할 필요는 없습니다 이지만 알아야 할 유용한 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-276">Displaying the preview isn't required to publish the application but is a useful function to be aware of.</span></span> <span data-ttu-id="7723b-277">이 경우 표시 되는 파일의 목록을 사용 하 여 아무 작업도 수행할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-277">In this case, you don't need to do anything with the list of files that is displayed.</span></span> <span data-ttu-id="7723b-278">이 응용 프로그램을 배포한 다음에이 목록에 변경 된 파일만 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-278">The next time you deploy this application, only the files that have changed will be in this list.</span></span>
    <span data-ttu-id="7723b-279">![미리 파일 출력](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span><span class="sxs-lookup"><span data-stu-id="7723b-279">![StartPreview file output](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span></span>

11. <span data-ttu-id="7723b-280">**게시**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-280">Click **Publish**.</span></span>
    <span data-ttu-id="7723b-281">Visual Studio Azure 서버로 파일을 복사 하는 프로세스를 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-281">Visual Studio begins the process of copying the files to the Azure server.</span></span>
12. <span data-ttu-id="7723b-282">합니다 **출력** 어떤 배포 동작을 보여 줍니다. 창과 성공적인 배포 완료를 보고 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-282">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span>
  
    ![출력 창 성공적인 배포를 보고](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-BuildOutput.png)
13. <span data-ttu-id="7723b-284">배포에 성공 하면 기본 브라우저가 자동으로 배포 된 웹 사이트의 URL로 열립니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-284">Upon successful deployment, the default browser automatically opens to the URL of the deployed web site.</span></span>
    <span data-ttu-id="7723b-285">만든 응용 프로그램이 이제 클라우드에서 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-285">The application you created is now running in the cloud.</span></span> 
  
    ![Students_index_page_with_paging](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Site.png)

<span data-ttu-id="7723b-287">이 시점에서 사용자 *SchoolContext* 데이터베이스가 선택 했기 때문에 Azure SQL Database에서 생성 되었습니다 **Execute Code First Migrations (앱 시작 시 실행)** 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-287">At this point your *SchoolContext* database has been created in the Azure SQL Database because you selected **Execute Code First Migrations (runs on app start)**.</span></span> <span data-ttu-id="7723b-288">합니다 *Web.config* 배포 된 웹 사이트의 파일이 변경 되었습니다 있도록 합니다 [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) 이니셜라이저 코드를 읽거나 (발생 하는 데이터베이스에서 데이터를 씁니다 처음으로 실행 선택 했을 **학생** 탭):</span><span class="sxs-lookup"><span data-stu-id="7723b-288">The *Web.config* file in the deployed web site has been changed so that the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer runs the first time your code reads or writes data in the database (which happened when you selected the **Students** tab):</span></span>

![](https://asp.net/media/4367421/mig.png)

<span data-ttu-id="7723b-289">배포 프로세스에도 새 연결 문자열을 생성 *(SchoolContext\_DatabasePublish*) 데이터베이스 스키마를 업데이트 하 고 데이터베이스 시 딩에 사용 하도록 Code First 마이그레이션에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-289">The deployment process also created a new connection string *(SchoolContext\_DatabasePublish*) for Code First Migrations to use for updating the database schema and seeding the database.</span></span>

![Database_Publish 연결 문자열](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image26.png)

<span data-ttu-id="7723b-291">Web.config 파일에서 자신의 컴퓨터에 배포 된 버전을 찾을 수 있습니다 *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*합니다. 배포에 액세스할 수 있습니다 *Web.config* FTP를 사용 하 여 자체 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-291">You can find the deployed version of the Web.config file on your own computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. You can access the deployed *Web.config* file itself by using FTP.</span></span> <span data-ttu-id="7723b-292">자세한 내용은 [Visual Studio를 사용 하 여 ASP.NET 웹 배포: 코드 업데이트 배포](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-292">For instructions, see [ASP.NET Web Deployment using Visual Studio: Deploying a Code Update](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span></span> <span data-ttu-id="7723b-293">로 시작 하는 지침에 따라 "FTP 도구를 사용 하려면 다음 세 가지: FTP URL, 사용자 이름 및 암호."</span><span class="sxs-lookup"><span data-stu-id="7723b-293">Follow the instructions that start with "To use an FTP tool, you need three things: the FTP URL, the user name, and the password."</span></span>

> [!NOTE]
> <span data-ttu-id="7723b-294">웹 앱 URL을 습득 한 사람이 데이터를 변경할 수 있도록 보안을 구현 하지 않는 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-294">The web app doesn't implement security, so anyone who finds the URL can change the data.</span></span> <span data-ttu-id="7723b-295">웹 사이트를 보호 하는 방법에 지침은 [멤버 자격, OAuth 및 SQL Database를 사용 하 여 보안 ASP.NET MVC 앱을 Azure에 배포](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-295">For instructions on how to secure the web site, see [Deploy a Secure ASP.NET MVC app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span> <span data-ttu-id="7723b-296">Azure 관리 포털을 사용 하 여 사이트를 사용 하 여 다른 사용자를 방지할 수 있습니다 또는 **서버 탐색기** 사이트를 중지 하려면 Visual Studio에서 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-296">You can prevent other people from using the site by using the Azure Management Portal or **Server Explorer** in Visual Studio to stop the site.</span></span>


![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Stop-Service.png)

## <a name="advanced-migrations-scenarios"></a><span data-ttu-id="7723b-297">고급 마이그레이션 시나리오</span><span class="sxs-lookup"><span data-stu-id="7723b-297">Advanced Migrations Scenarios</span></span>

<span data-ttu-id="7723b-298">이 자습서에 표시 된 대로 자동으로 마이그레이션을 실행 하 여 데이터베이스를 배포 하는 경우 여러 서버에서 실행 되는 웹 사이트에 배포 하는 동시 마이그레이션을 실행 하는 동안 여러 서버를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-298">If you deploy a database by running migrations automatically as shown in this tutorial, and you are deploying to a web site that runs on multiple servers, you could get multiple servers trying to run migrations at the same time.</span></span> <span data-ttu-id="7723b-299">마이그레이션 되므로 원자성 두 서버를 동일한 마이그레이션을 실행 하려고 하는 경우 하나는 성공 하 고 (작업을 두 번 수행할 수 없는 것으로 가정) 다른 하지 못합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-299">Migrations are atomic, so if two servers try to run the same migration, one will succeed and the other will fail (assuming the operations can't be done twice).</span></span> <span data-ttu-id="7723b-300">이 시나리오에서는 이러한 문제를 방지 하려는 경우 마이그레이션을 수동으로 호출할를 사용자 고유의 코드를 한 번 발생 되도록 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-300">In that scenario if you want to avoid those issues, you can call migrations manually and set up your own code so that it only happens once.</span></span> <span data-ttu-id="7723b-301">자세한 내용은 [실행 및 코드에서 마이그레이션 스크립팅](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) Rowan Miller 블로그 및 [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (에 대 한 마이그레이션 명령줄에서 실행 중) MSDN에서.</span><span class="sxs-lookup"><span data-stu-id="7723b-301">For more information, see [Running and Scripting Migrations from Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) on Rowan Miller's blog and [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (for executing migrations from the command line) on MSDN.</span></span>

<span data-ttu-id="7723b-302">다른 마이그레이션 시나리오에 대 한 자세한 내용은 [마이그레이션을 스크린 캐스트 시리즈가](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-302">For information about other migrations scenarios, see [Migrations Screencast Series](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span></span>

## <a name="code-first-initializers"></a><span data-ttu-id="7723b-303">첫 번째 이니셜라이저 코드</span><span class="sxs-lookup"><span data-stu-id="7723b-303">Code First Initializers</span></span>

<span data-ttu-id="7723b-304">배포 섹션에서 살펴보았습니다 합니다 [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) 이니셜라이저를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-304">In the deployment section you saw the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer being used.</span></span> <span data-ttu-id="7723b-305">코드 먼저 제공 등 다른 이니셜라이저 [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (기본값), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (이전에 사용한)는 및 [ DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-305">Code First also provides other initializers, including [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (the default), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (which you used earlier) and [DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span></span> <span data-ttu-id="7723b-306">`DropCreateAlways` 이니셜라이저는 단위 테스트에 대 한 조건을 설정 하는 데 유용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-306">The `DropCreateAlways` initializer can be useful for setting up conditions for unit tests.</span></span> <span data-ttu-id="7723b-307">고유한 이니셜라이저를 작성할 수도 있습니다 및 응용 프로그램에서 읽거나 데이터베이스에 기록 될 때까지 대기 하지 않으려는 경우 이니셜라이저를 명시적으로 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-307">You can also write your own initializers, and you can call an initializer explicitly if you don't want to wait until the application reads from or writes to the database.</span></span> <span data-ttu-id="7723b-308">2013 년 11 월에에서이 자습서를 쓰고 타임 마이그레이션을 사용 하기 전에 만들고 DropCreate 이니셜라이저만 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-308">At the time this tutorial is being written in November, 2013, you can only use the Create and DropCreate initializers before you enable migrations.</span></span> <span data-ttu-id="7723b-309">Entity Framework 팀에서 이러한 이니셜라이저 마이그레이션과 함께 사용할 수 있도록 노력 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-309">The Entity Framework team is working on making these initializers usable with migrations as well.</span></span>

<span data-ttu-id="7723b-310">이니셜라이저에 대 한 자세한 내용은 참조 하세요. [Entity Framework Code first 데이터베이스 이니셜라이저 이해](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) 및 책의 6 장 [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) Julie lerman 작성 Rowan Miller 하 고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-310">For more information about initializers, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) and chapter 6 of the book [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) by Julie Lerman and Rowan Miller.</span></span>

## <a name="summary"></a><span data-ttu-id="7723b-311">요약</span><span class="sxs-lookup"><span data-stu-id="7723b-311">Summary</span></span>

<span data-ttu-id="7723b-312">이 자습서에서 마이그레이션을 사용 하도록 설정 하 여 응용 프로그램을 배포 하는 방법을 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-312">In this tutorial you've seen how to enable migrations and deploy the application.</span></span> <span data-ttu-id="7723b-313">다음 자습서에서 데이터 모델을 확장 하 여 좀 더 고급 항목을 보면 먼저 합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-313">In the next tutorial you'll begin looking at more advanced topics by expanding the data model.</span></span>

<span data-ttu-id="7723b-314">이 자습서를 연결 하는 방법을 개선할 수 것에 의견을 남겨 주세요.</span><span class="sxs-lookup"><span data-stu-id="7723b-314">Please leave feedback on how you liked this tutorial and what we could improve.</span></span> <span data-ttu-id="7723b-315">새 항목을 요청할 수도 있습니다 [표시 코드 사용 방법 보기](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-315">You can also request new topics at [Show Me How With Code](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span></span>

<span data-ttu-id="7723b-316">다른 Entity Framework 리소스에 대 한 링크에서 찾을 수 있습니다 [ASP.NET 데이터 액세스-권장 리소스](xref:whitepapers/aspnet-data-access-content-map)합니다.</span><span class="sxs-lookup"><span data-stu-id="7723b-316">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](xref:whitepapers/aspnet-data-access-content-map).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7723b-317">[이전](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
> [다음](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="7723b-317">[Previous](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Next](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span></span>
