---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
title: SqlDataSource (C#)를 사용 하 여 매개 변수가 있는 쿼리를 사용 하 여 | Microsoft Docs
author: rick-anderson
description: 이 자습서에서는 살펴보겠습니다 SqlDataSource 컨트롤을 계속 하 고 매개 변수가 있는 쿼리를 정의 하는 방법을 알아봅니다. 매개 변수를 지정할 수 있습니다 모두 선언 하는 중...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9128aaac-afe2-449f-84b2-bb1d035083c4
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 654c0ce5520a206e5e8e2fd20bed92ac1075bfe9
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41837556"
---
<a name="using-parameterized-queries-with-the-sqldatasource-c"></a><span data-ttu-id="06bdf-104">SqlDataSource (C#)를 사용 하 여 매개 변수가 있는 쿼리를 사용 하 여</span><span class="sxs-lookup"><span data-stu-id="06bdf-104">Using Parameterized Queries with the SqlDataSource (C#)</span></span>
====================
<span data-ttu-id="06bdf-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="06bdf-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="06bdf-106">[샘플 앱을 다운로드](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) 또는 [PDF 다운로드](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="06bdf-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) or [Download PDF](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span></span>

> <span data-ttu-id="06bdf-107">이 자습서에서는 살펴보겠습니다 SqlDataSource 컨트롤을 계속 하 고 매개 변수가 있는 쿼리를 정의 하는 방법을 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-107">In this tutorial, we continue our look at the SqlDataSource control and learn how to define parameterized queries.</span></span> <span data-ttu-id="06bdf-108">매개 변수를 선언적으로 프로그래밍 방식으로 지정할 수 있으며 많은 쿼리 문자열, 세션 상태, 기타 컨트롤 등과 같은 위치에서 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-108">The parameters can be specified both declaratively and programmatically, and can be pulled from a number of locations such as the querystring, Session state, other controls, and more.</span></span>


## <a name="introduction"></a><span data-ttu-id="06bdf-109">소개</span><span class="sxs-lookup"><span data-stu-id="06bdf-109">Introduction</span></span>

<span data-ttu-id="06bdf-110">이전 자습서에서 SqlDataSource 컨트롤을 사용 하 여 데이터베이스에서 직접 데이터를 검색 하는 방법에 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-110">In the previous tutorial we saw how to use the SqlDataSource control to retrieve data directly from a database.</span></span> <span data-ttu-id="06bdf-111">데이터 소스 구성 마법사를 사용 하 여 선택할 수 있습니다 데이터베이스 및 다음: 테이블 또는 뷰에서; 반환할 열을 선택 합니다. 사용자 지정 SQL 문;를 입력 합니다. 또는 저장된 프로시저를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-111">Using the Configure Data Source wizard, we could choose the database and then either: pick the columns to return from a table or view; enter a custom SQL statement; or use a stored procedure.</span></span> <span data-ttu-id="06bdf-112">테이블 또는 뷰에서 열을 선택 하는 사용자 지정 SQL 문 입력, SqlDataSource s를 제어 하는지 여부를 `SelectCommand` 속성은 결과 임시 SQL 할당 `SELECT` 문과 것 입니까 `SELECT` 있는 문에 될 때 실행 되는 SqlDataSource의 `Select()` 메서드 (프로그래밍 방식으로 또는 자동으로 데이터 웹 컨트롤에서에서).</span><span class="sxs-lookup"><span data-stu-id="06bdf-112">Whether selecting columns from a table or view or entering a custom SQL statement, the SqlDataSource control s `SelectCommand` property is assigned the resulting ad-hoc SQL `SELECT` statement and it is this `SELECT` statement that is executed when the SqlDataSource s `Select()` method is invoked (either programmatically or automatically from a data Web control).</span></span>

<span data-ttu-id="06bdf-113">SQL `SELECT` 없었습니다 이전 자습서의 데모에 사용 된 문이 `WHERE` 절.</span><span class="sxs-lookup"><span data-stu-id="06bdf-113">The SQL `SELECT` statements used in the previous tutorial s demos lacked `WHERE` clauses.</span></span> <span data-ttu-id="06bdf-114">에 `SELECT` 문에서 `WHERE` 반환 된 결과 제한 하려면 절을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-114">In a `SELECT` statement, the `WHERE` clause can be used to limit the results returned.</span></span> <span data-ttu-id="06bdf-115">예를 들어 비용 $50.00 이상 제품의 이름을 표시할 다음 쿼리를 사용할 수 했습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-115">For example, to display the names of products costing more than $50.00, we could use the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="06bdf-116">에 사용 된 값으로는 `WHERE` 절 querystring 값, 세션 변수 또는 페이지의 웹 컨트롤에서 사용자 입력 등 일부 외부 소스에 의해 결정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-116">Typically, the values used in a `WHERE` clause are determine by some external source, such as a querystring value, a session variable, or user input from a Web control on the page.</span></span> <span data-ttu-id="06bdf-117">사용 하 여 이러한 입력을 지정 하는 것이 좋습니다 *매개 변수*합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-117">Ideally, such inputs are specified through the use of *parameters*.</span></span> <span data-ttu-id="06bdf-118">Microsoft SQL Server를 사용 하 여 매개 변수를 사용 하 여 표시 됩니다 `@parameterName`에서처럼:</span><span class="sxs-lookup"><span data-stu-id="06bdf-118">With Microsoft SQL Server, parameters are denoted using `@parameterName`, as in:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample2.sql)]

<span data-ttu-id="06bdf-119">SqlDataSource 둘 다에 대 한 매개 변수가 있는 쿼리를 지 원하는 `SELECT` 문 및 `INSERT`, `UPDATE`, 및 `DELETE` 문.</span><span class="sxs-lookup"><span data-stu-id="06bdf-119">The SqlDataSource supports parameterized queries, both for `SELECT` statements and `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="06bdf-120">또한 매개 변수 값을 끌어올 수 있습니다 자동으로 다양 한 원본에서에서 쿼리 문자열, 세션 상태 페이지의 컨트롤 등 있고 프로그래밍 방식으로 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-120">Moreover, the parameter values can be automatically pulled from a variety of sources the querystring, session state, controls on the page, and so on or can be assigned programmatically.</span></span> <span data-ttu-id="06bdf-121">이 자습서에서는 선언적 및 프로그래밍 방식으로 값 매개 변수를 지정 하는 방법 뿐만 아니라 매개 변수가 있는 쿼리를 정의 하는 방법을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-121">In this tutorial, we'll see how to define parameterized queries as well as how to specify the parameter values both declaratively and programmatically.</span></span>

> [!NOTE]
> <span data-ttu-id="06bdf-122">이전 자습서에서 해당 개념적 유사성 주목할 SqlDataSource 사용 하 여 먼저 46 자습서를 통해 원하는 도구인 된 ObjectDataSource 비교 했습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-122">In the previous tutorial we compared the ObjectDataSource which has been our tool of choice over the first 46 tutorials with the SqlDataSource, noting their conceptual similarities.</span></span> <span data-ttu-id="06bdf-123">이러한 유사성 매개 변수를 확장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-123">These similarities also extend to parameters.</span></span> <span data-ttu-id="06bdf-124">ObjectDataSource s 매개 변수는 비즈니스 논리 계층에서 메서드에 대 한 입력된 매개 변수에 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-124">The ObjectDataSource s parameters mapped to the input parameters for the methods in the Business Logic Layer.</span></span> <span data-ttu-id="06bdf-125">SqlDataSource를 사용 하 여 매개 변수는 SQL 쿼리 내에서 직접 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-125">With the SqlDataSource, the parameters are defined directly within the SQL query.</span></span> <span data-ttu-id="06bdf-126">두 컨트롤의 매개 변수 컬렉션에는 해당 `Select()`, `Insert()`를 `Update()`, 및 `Delete()` 메서드 및 모두 채워집니다 (querystring 값, 세션 변수 및 등 미리 정의 된 원본에서 이러한 매개 변수 값을 가질 수 ) 또는 프로그래밍 방식으로 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-126">Both controls have collections of parameters for their `Select()`, `Insert()`, `Update()`, and `Delete()` methods, and both can have these parameter values populated from pre-defined sources (querystring values, session variables, and so on) or assigned programmatically.</span></span>


## <a name="creating-a-parameterized-query"></a><span data-ttu-id="06bdf-127">매개 변수가 있는 쿼리 만들기</span><span class="sxs-lookup"><span data-stu-id="06bdf-127">Creating a Parameterized Query</span></span>

<span data-ttu-id="06bdf-128">SqlDataSource 컨트롤의 데이터 소스 구성 마법사는 데이터베이스 레코드를 검색 하기 위해 실행 하는 명령을 정의 하는 세 가지 방법을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-128">The SqlDataSource control s Configure Data Source wizard offers three avenues for defining the command to execute to retrieve database records:</span></span>

- <span data-ttu-id="06bdf-129">기존 테이블 또는 보기에서 열을 선택 하 여</span><span class="sxs-lookup"><span data-stu-id="06bdf-129">By picking the columns from an existing table or view,</span></span>
- <span data-ttu-id="06bdf-130">사용자 지정 SQL 문을 입력 하 여 또는</span><span class="sxs-lookup"><span data-stu-id="06bdf-130">By entering a custom SQL statement, or</span></span>
- <span data-ttu-id="06bdf-131">저장된 프로시저를 선택 하 여</span><span class="sxs-lookup"><span data-stu-id="06bdf-131">By choosing a stored procedure</span></span>

<span data-ttu-id="06bdf-132">기존 테이블 또는 뷰, 매개 변수에서 열을 선택할 때 합니다 `WHERE` 추가 통해 절을 지정 해야 `WHERE` 절 대화 상자.</span><span class="sxs-lookup"><span data-stu-id="06bdf-132">When picking columns from an existing table or view, the parameters for the `WHERE` clause must be specified through the Add `WHERE` Clause dialog box.</span></span> <span data-ttu-id="06bdf-133">그러나 사용자 지정 SQL 문을 만들 때 입력할 수 있습니다에 직접 매개 변수를 `WHERE` 절 (사용 하 여 `@parameterName` 각 매개 변수를 나타내기 위해).</span><span class="sxs-lookup"><span data-stu-id="06bdf-133">When creating a custom SQL statement, however, you can enter the parameters directly into the `WHERE` clause (using `@parameterName` to denote each parameter).</span></span> <span data-ttu-id="06bdf-134">A [저장 프로시저](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) 하나 이상의 SQL 문 구성 및 이러한 문을 매개 변수화 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-134">A [stored procedure](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) consists of one or more SQL statements, and these statements can be parameterized.</span></span> <span data-ttu-id="06bdf-135">그러나 SQL 문에서 사용 된 매개 변수에 전달 되어야 합니다에서 입력된 매개 변수로 저장 프로시저.</span><span class="sxs-lookup"><span data-stu-id="06bdf-135">The parameters used in the SQL statements, however, must be passed in as input parameters to the stored procedure.</span></span>

<span data-ttu-id="06bdf-136">매개 변수가 있는 쿼리를 만드는 방법에 따라 다릅니다 하므로 SqlDataSource의 `SelectCommand` 는 지정 된, s 살펴보겠습니다 전혀 세 가지 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-136">Since creating a parameterized query depends on how the SqlDataSource s `SelectCommand` is specified, let s take a look at all three approaches.</span></span> <span data-ttu-id="06bdf-137">시작 하려면 열기를 `ParameterizedQueries.aspx` 페이지에 `SqlDataSource` 폴더, SqlDataSource 컨트롤을 디자이너 도구 상자에서 끌어서 설정 해당 `ID` 에 `Products25BucksAndUnderDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-137">To get started, open the `ParameterizedQueries.aspx` page in the `SqlDataSource` folder, drag a SqlDataSource control from the Toolbox onto the Designer, and set its `ID` to `Products25BucksAndUnderDataSource`.</span></span> <span data-ttu-id="06bdf-138">다음으로, 컨트롤 s 스마트 태그의 데이터 소스 구성 링크를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-138">Next, click the Configure Data Source link from the control s smart tag.</span></span> <span data-ttu-id="06bdf-139">데이터베이스를 사용 하 여 선택 (`NORTHWINDConnectionString`) 다음을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-139">Select the database to use (`NORTHWINDConnectionString`) and click Next.</span></span>

## <a name="step-1-adding-awhereclause-when-picking-the-columns-from-a-table-or-view"></a><span data-ttu-id="06bdf-140">1 단계: 추가 된`WHERE`절에서 테이블 또는 뷰의 열을 선택할 때</span><span class="sxs-lookup"><span data-stu-id="06bdf-140">Step 1: Adding a`WHERE`Clause When Picking the Columns from a Table or View</span></span>

<span data-ttu-id="06bdf-141">SqlDataSource 컨트롤을 사용 하 여 데이터베이스에서 반환할 데이터를 선택할 때 데이터 소스 구성 마법사를 단순히 기존 테이블에서 반환 하거나 (그림 1 참조)을 보려면 열을 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-141">When selecting the data to return from the database with the SqlDataSource control, the Configure Data Source wizard allows us to simply pick the columns to return from an existing table or view (see Figure 1).</span></span> <span data-ttu-id="06bdf-142">자동으로 수행 하는 sql 작성 `SELECT` 문을 데이터베이스로 전달 되는 내용 때 SqlDataSource의 `Select()` 메서드가 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-142">Doing so automatically builds up a SQL `SELECT` statement, which is what is sent to the database when the SqlDataSource s `Select()` method is invoked.</span></span> <span data-ttu-id="06bdf-143">이전 자습서에서 했던 것 처럼 드롭 다운 목록에서 Products 테이블을 선택 하 고 확인 합니다 `ProductID`, `ProductName`, 및 `UnitPrice` 열입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-143">As we did in the previous tutorial, select the Products table from the drop-down list and check the `ProductID`, `ProductName`, and `UnitPrice` columns.</span></span>


<span data-ttu-id="06bdf-144">[![테이블 또는 보기에서 반환할 열을 선택 합니다.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-144">[![Pick the Columns to Return from a Table or View](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="06bdf-145">**그림 1**: 테이블 또는 뷰를 반환 하는 열을 선택 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-145">**Figure 1**: Pick the Columns to Return from a Table or View ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span></span>


<span data-ttu-id="06bdf-146">포함 하는 `WHERE` 절을 `SELECT` 문을 클릭를 `WHERE` 추가을 표시 하는 단추를 `WHERE` 절 대화 상자 (그림 2 참조).</span><span class="sxs-lookup"><span data-stu-id="06bdf-146">To include a `WHERE` clause in the `SELECT` statement, click the `WHERE` button, which brings up the Add `WHERE` Clause dialog box (see Figure 2).</span></span> <span data-ttu-id="06bdf-147">반환한 결과 제한 하려면 매개 변수를는 `SELECT` 쿼리 먼저 열을 선택 하 여 데이터를 필터링 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-147">To add a parameter to limit the results returned by the `SELECT` query, first choose the column to filter the data by.</span></span> <span data-ttu-id="06bdf-148">그런 다음 필터링에 사용할 연산자를 선택 (=, &lt;, &lt;=, &gt;등).</span><span class="sxs-lookup"><span data-stu-id="06bdf-148">Next, choose the operator to use for filtering (=, &lt;, &lt;=, &gt;, and so on).</span></span> <span data-ttu-id="06bdf-149">마지막으로, 쿼리 문자열 또는 세션 상태에서 같은 매개 변수의 값의 소스를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-149">Finally, choose the source of the parameter s value, such as from the querystring or session state.</span></span> <span data-ttu-id="06bdf-150">매개 변수를 구성한 후에 포함할 추가 단추를 클릭 합니다 `SELECT` 쿼리 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-150">After configuring the parameter, click the Add button to include it in the `SELECT` query.</span></span>

<span data-ttu-id="06bdf-151">예를 들어 let s 해당 결과만 반환 위치는 `UnitPrice` $25.00 보다 작거나 같은 값이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-151">For this example, let s only return those results where the `UnitPrice` value is less than or equal to $25.00.</span></span> <span data-ttu-id="06bdf-152">따라서 선택할 `UnitPrice` 열의 드롭다운 목록에서 및 &lt;연산자 드롭다운 목록에서 =.</span><span class="sxs-lookup"><span data-stu-id="06bdf-152">Therefore, pick `UnitPrice` from the Column drop-down list and &lt;= from the Operator drop-down list.</span></span> <span data-ttu-id="06bdf-153">하드 코드 된 매개 변수 값 (예: $25.00)를 사용 하는 경우 또는 매개 변수 값을 프로그래밍 방식으로 지정할 경우 원본 드롭다운 목록에서 없음를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-153">When using a hard-coded parameter value (such as $25.00) or if the parameter value is to be specified programmatically, select None from the Source drop-down list.</span></span> <span data-ttu-id="06bdf-154">다음으로, 25.00 값 텍스트 상자에 하드 코드 된 매개 변수 값을 입력 하 고 추가 단추를 클릭 하 여 프로세스를 완료 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-154">Next, enter the hard-coded parameter value in the Value textbox 25.00 and complete the process by clicking the Add button.</span></span>


<span data-ttu-id="06bdf-155">[![반환 된 결과 제한 합니다 추가 WHERE 절 대화 상자](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-155">[![Limit the Results Returned from the Add WHERE Clause Dialog Box](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="06bdf-156">**그림 2**: 추가에서 반환 된 결과 제한할 `WHERE` 절 대화 상자 ([클릭 하 여 큰 이미지 보기](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-156">**Figure 2**: Limit the Results Returned from the Add `WHERE` Clause Dialog Box ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span></span>


<span data-ttu-id="06bdf-157">매개 변수를 추가한 후 확인을 클릭 하 고 데이터 소스 구성 마법사로 돌아갑니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-157">After adding the parameter, click OK to return to the Configure Data Source wizard.</span></span> <span data-ttu-id="06bdf-158">합니다 `SELECT` 마법사의 맨 아래에 문을 포함할지 이제는 `WHERE` 라는 매개 변수를 사용 하 여 절 `@UnitPrice`:</span><span class="sxs-lookup"><span data-stu-id="06bdf-158">The `SELECT` statement at the bottom of the wizard should now include a `WHERE` clause with a parameter named `@UnitPrice`:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample3.sql)]

> [!NOTE]
> <span data-ttu-id="06bdf-159">여러 조건을 지정 하는 경우는 `WHERE` 추가 절 `WHERE` 절 대화 상자에서 마법사를 조인 하는 `AND` 연산자입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-159">If you specify multiple conditions in the `WHERE` clause from the Add `WHERE` Clause dialog box, the wizard joins them with the `AND` operator.</span></span> <span data-ttu-id="06bdf-160">포함 해야 하는 경우는 `OR` 에 `WHERE` 절 (같은 `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) 작성 해야 합니다는 `SELECT` 문을 사용자 지정 SQL 문 화면을 통해.</span><span class="sxs-lookup"><span data-stu-id="06bdf-160">If you need to include an `OR` in the `WHERE` clause (such as `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) then you have to build the `SELECT` statement through the custom SQL statement screen.</span></span>


<span data-ttu-id="06bdf-161">(클릭이 어 마침을) SqlDataSource 구성 완료 하 고 SqlDataSource s 선언적 태그를 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-161">Complete configuring the SqlDataSource (click Next, then Finish) and then inspect the SqlDataSource s declarative markup.</span></span> <span data-ttu-id="06bdf-162">태그 이제는 `<SelectParameters>` 매개 변수는 원본을 확인 하는 컬렉션을 `SelectCommand`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-162">The markup now includes a `<SelectParameters>` collection, which spells out the sources for the parameters in the `SelectCommand`.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample4.aspx)]

<span data-ttu-id="06bdf-163">때 SqlDataSource s `Select()` 메서드가 호출 되는 `UnitPrice` 매개 변수 값 (25.00)에 적용 됩니다는 `@UnitPrice` 의 매개 변수는 `SelectCommand` 데이터베이스로 전송 되기 전에 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-163">When the SqlDataSource s `Select()` method is invoked, the `UnitPrice` parameter value (25.00) is applied to the `@UnitPrice` parameter in the `SelectCommand` before being sent to the database.</span></span> <span data-ttu-id="06bdf-164">결과 $25.00 작거나에서 반환 된 제품에만 `Products` 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-164">The net result is that only those products less than or equal to $25.00 are returned from the `Products` table.</span></span> <span data-ttu-id="06bdf-165">확인이 페이지에 GridView를 추가,이 데이터 원본에 바인딩하지 한 다음 브라우저를 통해 페이지를 봅니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-165">To confirm this, add a GridView to the page, bind it to this data source, and then view the page through a browser.</span></span> <span data-ttu-id="06bdf-166">그림 3에서 확인 된 $25.00, 보다 작거나 같은 나열 된 제품만 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-166">You should only see those products listed that are less than or equal to $25.00, as Figure 3 confirms.</span></span>


<span data-ttu-id="06bdf-167">[![이러한 제품 보다 작음 또는 $25.00 같음만 표시 됩니다.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-167">[![Only Those Products Less Than or Equal to $25.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="06bdf-168">**그림 3**:만 해당 제품 보다 작음 또는 $25.00 같음 표시 됩니다 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-168">**Figure 3**: Only Those Products Less Than or Equal to $25.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span></span>


## <a name="step-2-adding-parameters-to-a-custom-sql-statement"></a><span data-ttu-id="06bdf-169">2 단계: 사용자 지정 SQL 문에 매개 변수 추가</span><span class="sxs-lookup"><span data-stu-id="06bdf-169">Step 2: Adding Parameters to a Custom SQL Statement</span></span>

<span data-ttu-id="06bdf-170">사용자 지정 SQL 문을 추가 하는 때를 입력 합니다 `WHERE` 절 명시적으로 하거나 쿼리 작성기의 필터 셀에 값을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-170">When adding a custom SQL statement you can enter the `WHERE` clause explicitly or specify a value in the Filter cell of the Query Builder.</span></span> <span data-ttu-id="06bdf-171">이 보여 주기 위해 s를 특정 임계값 보다 작은 가격은 GridView에 이러한 제품에만 표시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-171">To demonstrate this, let s display just those products in a GridView whose prices are less than a certain threshold.</span></span> <span data-ttu-id="06bdf-172">입력란을 추가 하 여 시작 합니다 `ParameterizedQueries.aspx` 임계값이 사용자 로부터 수집 하는 페이지입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-172">Start by adding a TextBox to the `ParameterizedQueries.aspx` page to collect this threshold value from the user.</span></span> <span data-ttu-id="06bdf-173">집합 TextBox s `ID` 속성을 `MaxPrice`입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-173">Set the TextBox s `ID` property to `MaxPrice`.</span></span> <span data-ttu-id="06bdf-174">단추 웹 컨트롤을 추가 하 고 설정 해당 `Text` 표시와 일치 하는 제품에는 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-174">Add a Button Web control and set its `Text` property to Display Matching Products .</span></span>

<span data-ttu-id="06bdf-175">다음으로 GridView를 페이지로 끌어 및 스마트 태그에서를 작성 하기로 라는 새 SqlDataSource `ProductsFilteredByPriceDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-175">Next, drag a GridView onto the page and from its smart tag choose to create a new SqlDataSource named `ProductsFilteredByPriceDataSource`.</span></span> <span data-ttu-id="06bdf-176">데이터 소스 구성 마법사에서 지정 된 사용자 지정 SQL 문 또는 저장된 프로시저 화면 이동 됩니다. (그림 4 참조) 다음 쿼리를 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-176">From the Configure Data Source wizard, proceed to the Specify a custom SQL statement or stored procedure screen (see Figure 4) and enter the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample5.sql)]

<span data-ttu-id="06bdf-177">쿼리 (직접 또는 쿼리 작성기를 통해)을 입력 한 후 다음을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-177">After entering the query (either manually or through the Query Builder), click Next.</span></span>


<span data-ttu-id="06bdf-178">[![매개 변수 값 보다 작은 제품만 반환](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-178">[![Return Only Those Products Less Than or Equal to a Parameter Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="06bdf-179">**그림 4**: 반환할만 해당 제품 보다 작음 또는 매개 변수 값을 같음 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-179">**Figure 4**: Return Only Those Products Less Than or Equal to a Parameter Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span></span>


<span data-ttu-id="06bdf-180">쿼리 매개 변수를 포함 하므로 마법사의 다음 화면 매개 변수 값의 원본에 대 한 요청입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-180">Since the query includes parameters, the next screen in the wizard prompts us for the source of the parameters values.</span></span> <span data-ttu-id="06bdf-181">매개 변수 원본 드롭다운 목록에서 컨트롤을 선택 하 고 `MaxPrice` (s 텍스트 상자 컨트롤 `ID` 값) ControlID 드롭 다운 목록에서.</span><span class="sxs-lookup"><span data-stu-id="06bdf-181">Choose Control from the Parameter source drop-down list and `MaxPrice` (the TextBox control s `ID` value) from the ControlID drop-down list.</span></span> <span data-ttu-id="06bdf-182">사용자가 모든 텍스트를 입력 하지 경우에서 사용 하는 선택적 기본 값을 입력할 수도 있습니다는 `MaxPrice` 텍스트 상자에 붙여넣습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-182">You can also enter an optional default value to use in the case where the user has not entered any text into the `MaxPrice` TextBox.</span></span> <span data-ttu-id="06bdf-183">당분간, 기본 값을 입력 하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="06bdf-183">For the time being, do not enter a default value.</span></span>


<span data-ttu-id="06bdf-184">[![텍스트 속성은 매개 변수 원본으로 사용 MaxPrice TextBox s](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-184">[![The MaxPrice TextBox s Text Property is Used as the Parameter Source](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="06bdf-185">**그림 5**: 합니다 `MaxPrice` 텍스트 상자 s `Text` 속성은 매개 변수 원본으로 사용 ([클릭 하 여 큰 이미지 보기](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-185">**Figure 5**: The `MaxPrice` TextBox s `Text` Property is Used as the Parameter Source ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span></span>


<span data-ttu-id="06bdf-186">다음을 클릭 하 여 데이터 소스 구성 마법사를 완료 한 다음 완료 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-186">Complete the Configure Data Source wizard by clicking Next, then Finish.</span></span> <span data-ttu-id="06bdf-187">GridView, 텍스트, 단추 및 SqlDataSource에 대 한 선언적 태그는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-187">The declarative markup for the GridView, TextBox, Button, and SqlDataSource follows:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample6.aspx)]

<span data-ttu-id="06bdf-188">SqlDataSource s 내에서 매개 변수 `<SelectParameters>` 섹션은는 `ControlParameter`와 같은 추가적인 속성도 포함 `ControlID` 및 `PropertyName`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-188">Note that the parameter within the SqlDataSource s `<SelectParameters>` section is a `ControlParameter`, which includes additional properties like `ControlID` and `PropertyName`.</span></span> <span data-ttu-id="06bdf-189">때 SqlDataSource s `Select()` 메서드가 호출 되는 `ControlParameter` 지정된 된 웹 컨트롤 속성의 값을 가져와 하 고 해당 매개 변수에 할당 합니다 `SelectCommand`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-189">When the SqlDataSource s `Select()` method is invoked, the `ControlParameter` grabs the value from the specified Web control property and assigns it to the corresponding parameter in the `SelectCommand`.</span></span> <span data-ttu-id="06bdf-190">이 예제에서는 합니다 `MaxPrice` s 텍스트 속성으로 사용 되는 `@MaxPrice` 매개 변수 값입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-190">In this example, the `MaxPrice` s Text property is used as the `@MaxPrice` parameter value.</span></span>

<span data-ttu-id="06bdf-191">브라우저를 통해이 페이지를 보려면 1 분이 걸립니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-191">Take a minute to view this page through a browser.</span></span> <span data-ttu-id="06bdf-192">먼저 페이지를 방문 하는 경우 또는 때마다는 `MaxPrice` 텍스트 상자에 GridView에 레코드가 표시 됩니다 값이 없는 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-192">When first visiting the page or whenever the `MaxPrice` TextBox lacks a value no records are displayed in the GridView.</span></span>


<span data-ttu-id="06bdf-193">[![표시 되는 경우는 MaxPrice 텍스트 상자에 비어 있는 레코드가 없습니다.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-193">[![No Records are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="06bdf-194">**그림 6**: 아니요 레코드는 경우 표시 합니다 `MaxPrice` 텍스트 상자가 비어 있지 않습니다 ([전체 크기 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-194">**Figure 6**: No Records are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span></span>


<span data-ttu-id="06bdf-195">제품이 표시 되는 이유는 기본적으로 매개 변수 값에 대 한 빈 문자열을 데이터베이스로 변환 하기 때문에 `NULL` 값입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-195">The reason no products are shown is because, by default, an empty string for a parameter value is converted into a database `NULL` value.</span></span> <span data-ttu-id="06bdf-196">비교 이후 `[UnitPrice] <= NULL` 항상 평가 결과가 False로 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-196">Since the comparison of `[UnitPrice] <= NULL` always evaluates as False, no results are returned.</span></span>

<span data-ttu-id="06bdf-197">5.00 같은 텍스트 상자에 값을 입력 하 고 일치 하는 제품 표시 단추를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-197">Enter a value into the textbox, like 5.00, and click the Display Matching Products button.</span></span> <span data-ttu-id="06bdf-198">포스트백에서 SqlDataSource GridView 해당 매개 변수 원본 중 하나는 변경에 알립니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-198">On postback, the SqlDataSource informs the GridView that one of its parameter sources has changed.</span></span> <span data-ttu-id="06bdf-199">따라서 GridView 제품 작거나 같거나 $5.00를 표시, SqlDataSource에 다시 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-199">Consequently, the GridView rebinds to the SqlDataSource, displaying those products less than or equal to $5.00.</span></span>


<span data-ttu-id="06bdf-200">[![제품 보다 작음 또는 $5.00 같음 표시](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-200">[![Products Less Than or Equal to $5.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span></span>

<span data-ttu-id="06bdf-201">**그림 7**: 제품 보다 작음 또는 $5.00 같음 표시 됩니다 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-201">**Figure 7**: Products Less Than or Equal to $5.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span></span>


## <a name="initially-displaying-all-products"></a><span data-ttu-id="06bdf-202">처음에 모든 제품을 표시</span><span class="sxs-lookup"><span data-stu-id="06bdf-202">Initially Displaying All Products</span></span>

<span data-ttu-id="06bdf-203">페이지가 처음 로드 될 때 없는 제품을 표시 하는 대신 표시 해야 할 수도 있으므로 *모든* 제품입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-203">Rather than displaying no products when the page is first loaded, we may want to display *all* products.</span></span> <span data-ttu-id="06bdf-204">모든 제품을 나열 하는 한 가지 방법은 때마다는 `MaxPrice` TextBox 비어 있습니다. 일부 만드세요 높은 값으로 s 매개 변수 기본값을 설정 하는 것, 1000000 같은 있으므로 s는 Northwind Traders는 적이 있는 인벤토리 단가 가능성이 초과 1,000,000 달러를 초과 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-204">One way to list all products whenever the `MaxPrice` TextBox is empty is to set the parameter s default value to some insanely high value, like 1000000, since it s unlikely that Northwind Traders will ever have inventory whose unit price exceeds $1,000,000.</span></span> <span data-ttu-id="06bdf-205">그러나이 방법은 근시안적 이며 다른 상황에서 작동 하지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-205">However, this approach is shortsighted and might not work in other situations.</span></span>

<span data-ttu-id="06bdf-206">이전 자습서- [선언적 매개 변수](../basic-reporting/declarative-parameters-cs.md) 하 고 [마스터/세부 정보 필터링으로 DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) 유사한 문제에 직면 했습니다 했습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-206">In previous tutorials - [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) and [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) we were faced with a similar problem.</span></span> <span data-ttu-id="06bdf-207">우리의 솔루션 비즈니스 논리 계층에서이 논리를 배치 하는 것 이었습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-207">Our solution there was to put this logic in the Business Logic Layer.</span></span> <span data-ttu-id="06bdf-208">BLL 들어오는 값을 검사 하는 특히 및 있었다면 `NULL` 또는 일부 예약 값, 호출 라우팅된 모든 레코드를 반환 하는 DAL 메서드.</span><span class="sxs-lookup"><span data-stu-id="06bdf-208">Specifically, the BLL examined the incoming value and, if it was `NULL` or some reserved value, the call was routed to the DAL method that returned all records.</span></span> <span data-ttu-id="06bdf-209">매개 변수가 있는 SQL 문을 실행 하는 DAL 메서드를 호출 했습니다 들어오는 값이 일반 필터링 값이 었을 경우 `WHERE` 절 제공 된 값을 사용 하 여 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-209">If the incoming value was a normal filtering value, a call was made to the DAL method that executed a SQL statement that used a parameterized `WHERE` clause with the supplied value.</span></span>

<span data-ttu-id="06bdf-210">아쉽게도 SqlDataSource를 사용 하는 경우 아키텍처를 무시 했습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-210">Unfortunately, we bypass the architecture when using the SqlDataSource.</span></span> <span data-ttu-id="06bdf-211">대신 SQL 문을 지능적으로 하는 경우 모든 레코드를 가져오는 사용자 지정 해야 합니다 `@MaximumPrice` 매개 변수는 `NULL` 또는 예약 된 값입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-211">Instead, we need to customize the SQL statement to intelligently grab all records if the `@MaximumPrice` parameter is `NULL` or some reserved value.</span></span> <span data-ttu-id="06bdf-212">이 연습에서는 s 수 있습니다 따라서 경우는 `@MaximumPrice` 매개 변수 값과 같음 `-1.0`, 한 다음 *모든* 반환 되는 레코드의 (`-1.0` 제품이 없습니다 음수 있을수있으므로예약된값으로작동`UnitPrice`값).</span><span class="sxs-lookup"><span data-stu-id="06bdf-212">For this exercise, let s have it so that if the `@MaximumPrice` parameter is equal to `-1.0`, then *all* of the records are to be returned (`-1.0` works as a reserved value since no product can have a negative `UnitPrice` value).</span></span> <span data-ttu-id="06bdf-213">이 작업을 수행한 다음 SQL 문을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-213">To accomplish this we can use the following SQL statement:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample7.sql)]

<span data-ttu-id="06bdf-214">이 `WHERE` 절에서 반환 *모든* 경우 기록 합니다 `@MaximumPrice` 매개 변수와 같으면 `-1.0`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-214">This `WHERE` clause returns *all* records if the `@MaximumPrice` parameter equals `-1.0`.</span></span> <span data-ttu-id="06bdf-215">매개 변수 값에는 없는 경우 `-1.0`, 제품만입니다 `UnitPrice` 보다 작거나 같음는 `@MaximumPrice` 매개 변수 값이 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-215">If the parameter value is not `-1.0`, only those products whose `UnitPrice` is less than or equal to the `@MaximumPrice` parameter value are returned.</span></span> <span data-ttu-id="06bdf-216">기본값을 설정 하 여는 `@MaximumPrice` 매개 변수를 `-1.0`, 첫 번째 페이지 로드 시 (또는 때마다를 `MaxPrice` TextBox 비어 있습니다.), `@MaximumPrice` 의 값이 포함 됩니다 `-1.0` 모든 제품이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-216">By setting the default value of the `@MaximumPrice` parameter to `-1.0`, on the first page load (or whenever the `MaxPrice` TextBox is empty), `@MaximumPrice` will have a value of `-1.0` and all products will be displayed.</span></span>


<span data-ttu-id="06bdf-217">[![이제 모든 제품이 표시 때 the MaxPrice 텍스트 상자가 비어 있는](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-217">[![Now All Products are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span></span>

<span data-ttu-id="06bdf-218">**그림 8**: 이제 모든 제품은 때 표시 되는 `MaxPrice` 텍스트 상자가 비어 있지 않습니다 ([전체 크기 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-218">**Figure 8**: Now All Products are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span></span>


<span data-ttu-id="06bdf-219">이 방법을 사용 하 여 주의 사항이 몇 가지 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-219">There are a couple of caveats to note with this approach.</span></span> <span data-ttu-id="06bdf-220">먼저, 매개 변수의 데이터 형식에 의해 유추는 실현 SQL 쿼리에서 사용량입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-220">First, realize that the parameter s data type is inferred by it s usage in the SQL query.</span></span> <span data-ttu-id="06bdf-221">변경 하는 경우는 `WHERE` 절 `@MaximumPrice = -1.0` 를 `@MaximumPrice = -1`, 런타임 정수 매개 변수를 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-221">If you change the `WHERE` clause from `@MaximumPrice = -1.0` to `@MaximumPrice = -1`, the runtime treats the parameter as an integer.</span></span> <span data-ttu-id="06bdf-222">그런 다음 할당 하려는 경우는 `MaxPrice` 텍스트 상자에 붙여넣습니다 (예: 5.00) 10 진수 값으로 5.00 정수로 변환할 수 없는 때문에 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-222">If you then attempt to assign the `MaxPrice` TextBox to a decimal value (like 5.00 ), an error will occur because it cannot convert 5.00 to an integer.</span></span> <span data-ttu-id="06bdf-223">이 해결 하려면 하나를 사용 해야 `@MaximumPrice = -1.0` 에 `WHERE` 절 또는 아직 설정 합니다 `ControlParameter` s 개체 `Type` 10 진수로 속성.</span><span class="sxs-lookup"><span data-stu-id="06bdf-223">To remedy this, either make sure that you use `@MaximumPrice = -1.0` in the `WHERE` clause or, better yet, set the `ControlParameter` object s `Type` property to Decimal .</span></span>

<span data-ttu-id="06bdf-224">추가 하 여 둘째, 합니다 `OR @MaximumPrice = -1.0` 에 `WHERE` 절, 쿼리 엔진에서 인덱스를 사용할 수 없습니다 `UnitPrice` (가정 하나가 있는) 테이블 검색에서는 그 결과로 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-224">Secondly, by adding the `OR @MaximumPrice = -1.0` to the `WHERE` clause, the query engine cannot use an index on `UnitPrice` (assuming one exists), thereby resulting in a table scan.</span></span> <span data-ttu-id="06bdf-225">충분히 많은 수의 레코드의 경우 성능에 영향이 `Products` 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-225">This can impact performance if there are a sufficiently large number of records in the `Products` table.</span></span> <span data-ttu-id="06bdf-226">더 나은 방법은 저장된 프로시저에이 논리를 이동 하는 것 위치는 `IF` 문을 수행 하거나를 `SELECT` 에서 쿼리를 `Products` 하지 않고 테이블을 `WHERE` 하나 또는 모든 레코드를 반환 해야 하는 경우 절입니다 `WHERE` 절만 포함 된 `UnitPrice` 조건을 인덱스를 사용할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-226">A better approach would be to move this logic to a stored procedure where an `IF` statement would either perform a `SELECT` query from the `Products` table without a `WHERE` clause when all records need to be returned or one whose `WHERE` clause contains just the `UnitPrice` criteria, so that an index can be used.</span></span>

## <a name="step-3-creating-and-using-parameterized-stored-procedures"></a><span data-ttu-id="06bdf-227">3 단계: 만들기 및 매개 변수가 있는 저장된 프로시저를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-227">Step 3: Creating and Using Parameterized Stored Procedures</span></span>

<span data-ttu-id="06bdf-228">저장된 프로시저는 저장된 프로시저 내에 정의 된 SQL 문을 지정에 사용할 수 있는 입력된 매개 변수 집합을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-228">Stored procedures can include a set of input parameters that can then be used in the SQL statement(s) defined within the stored procedure.</span></span> <span data-ttu-id="06bdf-229">입력된 매개 변수를 받아들이는 저장된 프로시저를 사용 하 여 SqlDataSource를 구성할 때 이러한 매개 변수 값을 임시 SQL 문이 마찬가지로 동일한 기술을 사용 하 여 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-229">When configuring the SqlDataSource to use a stored procedure that accepts input parameters, these parameter values can be specified using the same techniques as with ad-hoc SQL statements.</span></span>

<span data-ttu-id="06bdf-230">S let 라는 Northwind 데이터베이스의 새 저장된 프로시저 만들기를 설명 하기 위해 SqlDataSource에서 저장된 프로시저를 사용 하 여 `GetProductsByCategory`, 라는 매개 변수를 받아들이는 `@CategoryID` 모든 제품의 열을 반환 하 고 해당 `CategoryID` 열이 일치 `@CategoryID`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-230">To illustrate using stored procedures in the SqlDataSource, let s create a new stored procedure in the Northwind database named `GetProductsByCategory`, which accepts a parameter named `@CategoryID` and returns all of the columns of the products whose `CategoryID` column matches `@CategoryID`.</span></span> <span data-ttu-id="06bdf-231">저장된 프로시저를 만들려면 서버 탐색기로 이동 하 고 드릴 다운을 `NORTHWND.MDF` 데이터베이스입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-231">To create a stored procedure, go to the Server Explorer and drill down into the `NORTHWND.MDF` database.</span></span> <span data-ttu-id="06bdf-232">(서버 탐색기에 표시 하는 t don 가동 시킵니다 보기 메뉴로 이동 하 고 서버 탐색기 옵션을 선택 하 여.)</span><span class="sxs-lookup"><span data-stu-id="06bdf-232">(If you don t see the Server Explorer, bring it up by going to the View menu and selecting the Server Explorer option.)</span></span>

<span data-ttu-id="06bdf-233">`NORTHWND.MDF` 데이터베이스, Stored Procedures 폴더를 마우스 오른쪽 단추로 클릭 하 고, 새 저장 프로시저 추가 선택 하 고 다음 구문을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-233">From the `NORTHWND.MDF` database, right-click on the Stored Procedures folder, choose Add New Stored Procedure, and enter the following syntax:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample8.sql)]

<span data-ttu-id="06bdf-234">저장된 프로시저를 저장 하려면 저장 아이콘 (또는 Ctrl + S)를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-234">Click the Save icon (or Ctrl+S) to save the stored procedure.</span></span> <span data-ttu-id="06bdf-235">Stored Procedures 폴더에서 마우스 오른쪽 단추로 클릭 하 고 실행을 선택 하 여 저장된 프로시저를 테스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-235">You can test the stored procedure by right-clicking it from the Stored Procedures folder and choosing Execute.</span></span> <span data-ttu-id="06bdf-236">묻는 메시지가 나타납니다 s 저장된 프로시저 매개 변수에 대 한 (`@CategoryID`, 이런에서), 후 출력 창에는 결과 표시 되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-236">This will prompt you for the stored procedure s parameters (`@CategoryID`, in this instance), after which the results will be displayed in the Output window.</span></span>


<span data-ttu-id="06bdf-237">[![GetProductsByCategory 저장 프로시저를 사용 하 여 실행 하는 경우는 @CategoryID 1](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-237">[![The GetProductsByCategory Stored Procedure when Executed with a @CategoryID of 1](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span></span>

<span data-ttu-id="06bdf-238">**그림 9**: 합니다 `GetProductsByCategory` 사용 하 여 실행 하는 경우 저장 프로시저를 `@CategoryID` 1 ([전체 크기 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-238">**Figure 9**: The `GetProductsByCategory` Stored Procedure when Executed with a `@CategoryID` of 1 ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span></span>


<span data-ttu-id="06bdf-239">이 저장된 프로시저를 사용 하 여 음료 범주를 GridView에 모든 제품을 전시 하기 s 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-239">Let s use this stored procedure to display all products in the Beverages category in a GridView.</span></span> <span data-ttu-id="06bdf-240">페이지에 새 GridView를 추가 하 고 명명 된 새 SqlDataSource에 바인딩할 `BeverageProductsDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-240">Add a new GridView to the page and bind it to a new SqlDataSource named `BeverageProductsDataSource`.</span></span> <span data-ttu-id="06bdf-241">사용자 지정 SQL 문 또는 저장된 프로시저 화면 지정 계속, 저장 프로시저 라디오 단추를 선택 하 고, 선택는 `GetProductsByCategory` 드롭 다운 목록에서 프로시저를 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-241">Continue to the Specify a custom SQL statement or stored procedure screen, select the Stored procedure radio button, and pick the `GetProductsByCategory` stored procedure from the drop-down list.</span></span>


<span data-ttu-id="06bdf-242">[![GetProductsByCategory 선택 드롭다운 목록에서 프로시저를 저장 합니다.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-242">[![Select the GetProductsByCategory Stored Procedure from the Drop-Down List](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span></span>

<span data-ttu-id="06bdf-243">**그림 10**: 선택 된 `GetProductsByCategory` 드롭 다운 목록에서 저장 프로시저 ([클릭 하 여 큰 이미지 보기](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-243">**Figure 10**: Select the `GetProductsByCategory` Stored Procedure from the Drop-Down List ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png))</span></span>


<span data-ttu-id="06bdf-244">저장된 프로시저 입력된 매개 변수를 허용 하므로 (`@CategoryID`),이 매개 변수의 값에 대 한 원본을 지정 하도록 요청 다음을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-244">Since the stored procedure accepts an input parameter (`@CategoryID`), clicking Next prompts us to specify the source for this parameter s value.</span></span> <span data-ttu-id="06bdf-245">음료 `CategoryID` 1 이므로 매개 변수 원본 드롭다운 목록에 없음 두고 DefaultValue 텍스트 상자에 1을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-245">The Beverages `CategoryID` is 1, so leave the Parameter source drop-down list at None and enter 1 into the DefaultValue textbox.</span></span>


<span data-ttu-id="06bdf-246">[![하드 코드 된 값이 1 사용 하 여 음료 범주에서 제품을 반환 하려면](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-246">[![Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span></span>

<span data-ttu-id="06bdf-247">**그림 11**: Hard-Coded 값 1 사용 하 여 음료 범주에서 제품을 반환할 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-247">**Figure 11**: Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span></span>


<span data-ttu-id="06bdf-248">저장된 프로시저, SqlDataSource s를 사용 하는 경우 다음 선언적 태그와 같이 `SelectCommand` 저장된 프로시저의 이름 속성 및 [ `SelectCommandType` 속성](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) 로 설정 된 `StoredProcedure`나타내는 `SelectCommand` 를 임시 SQL 문이 아니라 저장된 프로시저의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-248">As the following declarative markup shows, when using a stored procedure, the SqlDataSource s `SelectCommand` property is set to the name of the stored procedure and the [`SelectCommandType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) is set to `StoredProcedure`, indicating that the `SelectCommand` is the name of a stored procedure rather than an ad-hoc SQL statement.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample9.aspx)]

<span data-ttu-id="06bdf-249">브라우저에서 페이지를 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-249">Test out the page in a browser.</span></span> <span data-ttu-id="06bdf-250">하지만 음료 범주에 속하는 제품만 표시 됩니다 *모든* 이후 제품의 필드가 표시 됩니다는 `GetProductsByCategory` 에서 열의 모든 저장된 프로시저 반환을 `Products` 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-250">Only those products that belong to the Beverages category are displayed, although *all* of the product fields are displayed since the `GetProductsByCategory` stored procedure returns all of the columns from the `Products` table.</span></span> <span data-ttu-id="06bdf-251">수 없습니다, 그리고 물론 제한 하거나 GridView가의 열 편집 대화 상자에서 GridView에 표시 되는 필드를 사용자 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-251">We could, of course, limit or customize the fields displayed in the GridView from the GridView s Edit Columns dialog box.</span></span>


<span data-ttu-id="06bdf-252">[![음료 모두 표시](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-252">[![All of the Beverages are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span></span>

<span data-ttu-id="06bdf-253">**그림 12**: 모든는 음료 표시 됩니다 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-253">**Figure 12**: All of the Beverages are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span></span>


## <a name="step-4-programmatically-invoking-a-sqldatasource-sselectstatement"></a><span data-ttu-id="06bdf-254">4 단계: 프로그래밍 방식으로 SqlDataSource의`Select()`문</span><span class="sxs-lookup"><span data-stu-id="06bdf-254">Step 4: Programmatically Invoking a SqlDataSource s`Select()`Statement</span></span>

<span data-ttu-id="06bdf-255">예제에서는 이전 자습서와이 자습서를 지금 나온 ve SqlDataSource 컨트롤을 GridView에 직접 바인딩한 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-255">The examples we ve seen in the previous tutorial and this tutorial so far have bound SqlDataSource controls directly to a GridView.</span></span> <span data-ttu-id="06bdf-256">그러나 SqlDataSource 컨트롤의 데이터 프로그래밍 방식으로 액세스 하 고 수 코드에 열거 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-256">The SqlDataSource control s data, however, can be programmatically accessed and enumerated in code.</span></span> <span data-ttu-id="06bdf-257">이 기능은, 검사 데이터를 쿼리할 해야 하지만 안 표시 해야 하는 경우에 특히 유용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-257">This can be particularly useful when you need to query data to inspect it, but don t need to display it.</span></span> <span data-ttu-id="06bdf-258">모든 데이터베이스에 연결 하 여 명령을 지정 하 고 결과 검색 하는 ADO.NET 코드 상용구를 작성 하는 대신 SqlDataSource 단조로운이 코드를 처리 하도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-258">Rather than having to write all of the boilerplate ADO.NET code to connect to the database, specify the command, and retrieve the results, you can let the SqlDataSource handle this monotonous code.</span></span>

<span data-ttu-id="06bdf-259">SqlDataSource s 사용 하 여 작업을 설명 하기 위해 데이터는 상사에 도달 하면 임의로 선택 된 범주 및 관련된 제품의 이름을 표시 하는 웹 페이지를 만들기 위한 요청을 사용 하 여 프로그래밍 방식으로, imagine.</span><span class="sxs-lookup"><span data-stu-id="06bdf-259">To illustrate working with the SqlDataSource s data programmatically, imagine that your boss has approached you with a request to create a web page that displays the name of a randomly selected category and its associated products.</span></span> <span data-ttu-id="06bdf-260">즉, 사용자가이 페이지를 방문 하면 원하는 임의로에서 범주를 선택 하 여 `Categories` 테이블, 범주 이름을 표시 한 다음 해당 범주에 속하는 제품을 나열 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-260">That is, when a user visits this page, we want to randomly choose a category from the `Categories` table, display the category name, and then list the products belonging to that category.</span></span>

<span data-ttu-id="06bdf-261">SqlDataSource 컨트롤을 두 개 하나에서 임의 범주를 선택 해야이 작업을 수행 하는 `Categories` 테이블과 다른 s 제품 범주를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-261">To accomplish this we need two SqlDataSource controls one to grab a random category from the `Categories` table and another to get the category s products.</span></span> <span data-ttu-id="06bdf-262">이 단계에 임의 범주 레코드를 검색 하는 SqlDataSource를 구축해 보겠습니다. 5 단계 SqlDataSource 범주의 제품을 검색 하는 과정에 대해 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-262">We'll build the SqlDataSource that retrieves a random category record in this step; Step 5 looks at crafting the SqlDataSource that retrieves the category s products.</span></span>

<span data-ttu-id="06bdf-263">SqlDataSource를 추가 하 여 시작 `ParameterizedQueries.aspx` 설정 및 해당 `ID` 에 `RandomCategoryDataSource`입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-263">Start by adding a SqlDataSource to `ParameterizedQueries.aspx` and set its `ID` to `RandomCategoryDataSource`.</span></span> <span data-ttu-id="06bdf-264">다음 SQL 쿼리를 사용할 수 있도록 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-264">Configure it so that it uses the following SQL query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample10.sql)]

<span data-ttu-id="06bdf-265">`ORDER BY NEWID()` 임의 순서로 정렬 하는 레코드를 반환 합니다 (참조 [사용 하 여 `NEWID()` 임의로 정렬 레코드](http://www.sqlteam.com/item.asp?ItemID=8747)).</span><span class="sxs-lookup"><span data-stu-id="06bdf-265">`ORDER BY NEWID()` returns the records sorted in random order (see [Using `NEWID()` to Randomly Sort Records](http://www.sqlteam.com/item.asp?ItemID=8747)).</span></span> <span data-ttu-id="06bdf-266">`SELECT TOP 1` 결과 집합에서 첫 번째 레코드를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-266">`SELECT TOP 1` returns the first record from the result set.</span></span> <span data-ttu-id="06bdf-267">종합적으로이 쿼리는 반환 합니다 `CategoryID` 및 `CategoryName` 단일, 임의로 선택 된 범주에서 열 값입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-267">Put together, this query returns the `CategoryID` and `CategoryName` column values from a single, randomly selected category.</span></span>

<span data-ttu-id="06bdf-268">S 범주를 표시할 `CategoryName` 값, 페이지 레이블 웹 컨트롤을 추가 하 고, 설정 해당 `ID` 속성을 `CategoryNameLabel`를 지울 및 해당 `Text` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-268">To display the category s `CategoryName` value, add a Label Web control to the page, set its `ID` property to `CategoryNameLabel`, and clear out its `Text` property.</span></span> <span data-ttu-id="06bdf-269">SqlDataSource 컨트롤에서 데이터를 프로그래밍 방식으로 검색을 하려면 호출 해야 해당 `Select()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="06bdf-269">To programmatically retrieve the data from a SqlDataSource control, we need to invoke its `Select()` method.</span></span> <span data-ttu-id="06bdf-270">[ `Select()` 메서드](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) 형식의 단일 입력 매개 변수 [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), 반환 되기 전에 4kb 되어 데이터를 해야 하는 방법을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-270">The [`Select()` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) expects a single input parameter of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), which specifies how the data should be messaged before being returned.</span></span> <span data-ttu-id="06bdf-271">이 데이터를 정렬 및 필터링에 대 한 지침을 포함할 수 있습니다 하 고 데이터 정렬 또는 SqlDataSource 컨트롤에서 데이터를 페이징 하는 경우 웹 컨트롤에 의해 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-271">This can include instructions on sorting and filtering the data, and is used by the data Web controls when sorting or paging through the data from a SqlDataSource control.</span></span> <span data-ttu-id="06bdf-272">예를 들어 하지만 반환 되기 전에 수정할 데이터 t 필요 하지 하 고 있으므로 전달 된 `DataSourceSelectArguments.Empty` 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-272">For our example, though, we don t need the data to be modified before being returned, and therefore will pass in the `DataSourceSelectArguments.Empty` object.</span></span>

<span data-ttu-id="06bdf-273">합니다 `Select()` 메서드를 구현 하는 개체를 반환 합니다. `IEnumerable`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-273">The `Select()` method returns an object that implements `IEnumerable`.</span></span> <span data-ttu-id="06bdf-274">정확한 형식이 반환 SqlDataSource 컨트롤 s의 값에 따라 달라 집니다 [ `DataSourceMode` 속성](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-274">The precise type returned depends on the value of the SqlDataSource control s [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span></span> <span data-ttu-id="06bdf-275">이전 자습서에서 설명 했 듯이이 속성의 값으로 설정할 수 있습니다 `DataSet` 또는 `DataReader`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-275">As discussed in the previous tutorial, this property can be set to a value of either `DataSet` or `DataReader`.</span></span> <span data-ttu-id="06bdf-276">경우로 `DataSet`, `Select()` 메서드가 반환 되는 [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) 로 설정 하면 개체 `DataReader`, 구현 하는 개체를 반환 [ `IDataReader` ](https://msdn.microsoft.com/library/system.data.idatareader.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-276">If set to `DataSet`, the `Select()` method returns a [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) object; if set to `DataReader`, it returns an object that implements [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx).</span></span> <span data-ttu-id="06bdf-277">있으므로 합니다 `RandomCategoryDataSource` SqlDataSource에 해당 `DataSourceMode` 속성이로 설정 `DataSet` (기본값), 우리가 사용할 DataView 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-277">Since the `RandomCategoryDataSource` SqlDataSource has its `DataSourceMode` property set to `DataSet` (the default), we will be working with a DataView object.</span></span>

<span data-ttu-id="06bdf-278">다음 코드에서 레코드를 검색 하는 방법을 보여 줍니다 합니다 `RandomCategoryDataSource` SqlDataSource DataView로 읽는 방법 뿐만 아니라는 `CategoryName` DataView의 첫 번째 행의 열 값:</span><span class="sxs-lookup"><span data-stu-id="06bdf-278">The following code illustrates how to retrieve the records from the `RandomCategoryDataSource` SqlDataSource as a DataView as well as how to read the `CategoryName` column value from the first DataView row:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample11.cs)]

<span data-ttu-id="06bdf-279">`randomCategoryView[0]` 첫 번째 개체가 반환 `DataRowView` DataView에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-279">`randomCategoryView[0]` returns the first `DataRowView` in the DataView.</span></span> <span data-ttu-id="06bdf-280">`randomCategoryView[0]["CategoryName"]` 값을 반환 합니다 `CategoryName` 이 첫 번째 행의 열입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-280">`randomCategoryView[0]["CategoryName"]` returns the value of the `CategoryName` column in this first row.</span></span> <span data-ttu-id="06bdf-281">DataView는 느슨한 형 note 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-281">Note that the DataView is loosely-typed.</span></span> <span data-ttu-id="06bdf-282">특정 열 값을 참조 하는 열 이름 (이 경우 CategoryName) 문자열로 전달 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-282">To reference a particular column value we need to pass in the name of the column as a string ( CategoryName, in this case).</span></span> <span data-ttu-id="06bdf-283">그림 13에 표시 되는 메시지를 표시 합니다 `CategoryNameLabel` 페이지를 보고 하는 경우.</span><span class="sxs-lookup"><span data-stu-id="06bdf-283">Figure 13 shows the message displayed in the `CategoryNameLabel` when viewing the page.</span></span> <span data-ttu-id="06bdf-284">표시 되는 실제 범주 이름에서 임의로 선택은 물론,는 `RandomCategoryDataSource` 포스트백 등 페이지를 방문할 때마다에서 SqlDataSource 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-284">Of course, the actual category name displayed is randomly selected by the `RandomCategoryDataSource` SqlDataSource on each visit to the page (including postbacks).</span></span>


<span data-ttu-id="06bdf-285">[![이름은 임의로 선택한 범주 s](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-285">[![The Randomly Selected Category s Name is Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span></span>

<span data-ttu-id="06bdf-286">**그림 13**: The 임의로 선택한 범주의 이름이 표시 됩니다 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-286">**Figure 13**: The Randomly Selected Category s Name is Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span></span>


> [!NOTE]
> <span data-ttu-id="06bdf-287">SqlDataSource가 제어 하는 경우 `DataSourceMode` 속성으로 설정 된 `DataReader`의 반환 값을 `Select()` 메서드를 캐스팅 해야 `IDataReader`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-287">If the SqlDataSource control s `DataSourceMode` property had been set to `DataReader`, the return value from the `Select()` method would have needed to be cast to `IDataReader`.</span></span> <span data-ttu-id="06bdf-288">읽을 수는 `CategoryName` d에서는 첫 번째 행의 열 값이 같은 코드를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-288">To read the `CategoryName` column value from the first row, we d use code like:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample12.cs)]

<span data-ttu-id="06bdf-289">SqlDataSource와 함께 무작위로 선택할 범주를 범주의 제품을 나열 하는 GridView를 추가 하려면 준비 된 것입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-289">With the SqlDataSource randomly selecting a category, we re ready to add the GridView that lists the category s products.</span></span>

> [!NOTE]
> <span data-ttu-id="06bdf-290">범주의 이름에 표시할 레이블 웹 컨트롤을 사용 하는 대신 수에 추가 했습니다 FormView 또는 DetailsView 페이지 SqlDataSource에 바인딩하지 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-290">Rather than using a Label Web control to display the category s name, we could have added a FormView or DetailsView to the page, binding it to the SqlDataSource.</span></span> <span data-ttu-id="06bdf-291">그러나 수 SqlDataSource s를 프로그래밍 방식으로 호출 하는 방법에 대해 레이블을 사용 하 여, `Select()` 문 및 코드에서 결과 데이터를 사용 하 여 작업 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-291">Using the Label, however, allowed us to explore how to programmatically invoke the SqlDataSource s `Select()` statement and work with its resulting data in code.</span></span>


## <a name="step-5-assigning-parameter-values-programmatically"></a><span data-ttu-id="06bdf-292">5 단계: 매개 변수 값을 프로그래밍 방식으로 할당</span><span class="sxs-lookup"><span data-stu-id="06bdf-292">Step 5: Assigning Parameter Values Programmatically</span></span>

<span data-ttu-id="06bdf-293">모든 예제에서는이 자습서에서는 지금까지 본 ve 하드 코드 된 매개 변수 값 또는 미리 정의 된 매개 변수 원본 (고 페이지의 웹 컨트롤, querystring 값) 중 하나에서 가져온 하나 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-293">All of the examples we ve seen so far in this tutorial have used either a hard-coded parameter value or one taken from one of the pre-defined parameter sources (a querystring value, a Web control on the page, and so on).</span></span> <span data-ttu-id="06bdf-294">그러나 SqlDataSource 컨트롤 s 매개 변수를 프로그래밍 방식으로 설정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-294">However, the SqlDataSource control s parameters can also be set programmatically.</span></span> <span data-ttu-id="06bdf-295">현재 예제를 완료 하려면 모든 지정된 된 범주에 속하는 제품을 반환 하는 SqlDataSource 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-295">To complete our current example, we need a SqlDataSource that returns all of the products belonging to a specified category.</span></span> <span data-ttu-id="06bdf-296">이 SqlDataSource 해야는 `CategoryID` 기반으로 하는 매개 변수 값을 설정 해야 합니다 `CategoryID` 에서 반환 된 열 값을 `RandomCategoryDataSource` SqlDataSource에서를 `Page_Load` 이벤트 처리기.</span><span class="sxs-lookup"><span data-stu-id="06bdf-296">This SqlDataSource will have a `CategoryID` parameter whose value needs to be set based on the `CategoryID` column value returned by the `RandomCategoryDataSource` SqlDataSource in the `Page_Load` event handler.</span></span>

<span data-ttu-id="06bdf-297">페이지에 GridView를 추가 하 여 시작 하 고 명명 된 새 SqlDataSource에 바인딩할 `ProductsByCategoryDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-297">Start by adding a GridView to the page and bind it to a new SqlDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="06bdf-298">3 단계에서에서 수행한 마찬가지로, SqlDataSource 호출 하도록 구성 된 `GetProductsByCategory` 저장 프로시저입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-298">Much like we did in Step 3, configure the SqlDataSource so that it invokes the `GetProductsByCategory` stored procedure.</span></span> <span data-ttu-id="06bdf-299">None, 매개 변수 원본 드롭다운 목록에서 설정 된 채로 하지만 프로그래밍 방식으로 기본 값이 설정으로 기본 값을 입력 하지 않으면.</span><span class="sxs-lookup"><span data-stu-id="06bdf-299">Leave the Parameter source drop-down list set to None, but do not enter a default value, as we will set this default value programmatically.</span></span>


<span data-ttu-id="06bdf-300">[![매개 변수 원본 또는 기본 값을 지정 하지 않으면](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-300">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span></span>

<span data-ttu-id="06bdf-301">**그림 14**: 매개 변수 원본 또는 기본 값을 지정 하지 않으면 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-301">**Figure 14**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span></span>


<span data-ttu-id="06bdf-302">SqlDataSource 마법사를 완료 한 후 결과 선언적 태그는 다음과 비슷하게 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-302">After completing the SqlDataSource wizard, the resulting declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample13.aspx)]

<span data-ttu-id="06bdf-303">할당할 수 있습니다 합니다 `DefaultValue` 의 합니다 `CategoryID` 프로그래밍 방식으로 매개 변수는 `Page_Load` 이벤트 처리기:</span><span class="sxs-lookup"><span data-stu-id="06bdf-303">We can assign the `DefaultValue` of the `CategoryID` parameter programmatically in the `Page_Load` event handler:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample14.cs)]

<span data-ttu-id="06bdf-304">이 또한을 사용 하 여 페이지를 임의로 선택 된 범주와 관련 된 제품이 표시 되는 GridView를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-304">With this addition, the page includes a GridView that shows the products associated with the randomly selected category.</span></span>


<span data-ttu-id="06bdf-305">[![매개 변수 원본 또는 기본 값을 지정 하지 않으면](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="06bdf-305">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span></span>

<span data-ttu-id="06bdf-306">**그림 15**: 매개 변수 원본 또는 기본 값을 지정 하지 않으면 ([큰 이미지를 보려면 클릭](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="06bdf-306">**Figure 15**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="06bdf-307">요약</span><span class="sxs-lookup"><span data-stu-id="06bdf-307">Summary</span></span>

<span data-ttu-id="06bdf-308">SqlDataSource는 페이지 개발자가 매개 변수 값을 가진 하드 코드 된, 미리 정의 된 매개 변수 원본에서 가져온 하거나 수 할당을 프로그래밍 방식으로 매개 변수가 있는 쿼리를 정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-308">The SqlDataSource enables page developers to define parameterized queries whose parameter values can be hard-coded, pulled from pre-defined parameter sources, or assigned programmatically.</span></span> <span data-ttu-id="06bdf-309">이 자습서에서는 임시 SQL 쿼리 및 저장된 프로시저 모두에 대 한 데이터 소스 구성 마법사에서 매개 변수가 있는 쿼리를 작성 하는 방법에 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-309">In this tutorial we saw how to craft a parameterized query from the Configure Data Source wizard for both ad-hoc SQL queries and stored procedures.</span></span> <span data-ttu-id="06bdf-310">또한 살펴보았습니다 하드 코드 된 매개 변수 원본에 매개 변수 원본으로 웹 컨트롤을 사용 하 고 프로그래밍 방식으로 매개 변수 값을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-310">We also looked at using hard-coded parameter sources, a Web control as a parameter source, and programmatically specifying the parameter value.</span></span>

<span data-ttu-id="06bdf-311">같은 ObjectDataSource를 사용 하 여 SqlDataSource 또한 기능을 제공 해당 기본 데이터를 수정 합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-311">Like with the ObjectDataSource, the SqlDataSource also provides capabilities to modify its underlying data.</span></span> <span data-ttu-id="06bdf-312">다음 자습서에서 살펴보겠습니다 정의 하는 방법 `INSERT`, `UPDATE`, 및 `DELETE` SqlDataSource 사용 하 여 문입니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-312">In the next tutorial we'll look at how to define `INSERT`, `UPDATE`, and `DELETE` statements with the SqlDataSource.</span></span> <span data-ttu-id="06bdf-313">이러한 문은 추가한 후 삽입, 편집 및 삭제 기능 GridView, DetailsView 및 FormView 컨트롤에 내재 된 기본 제공을 활용 하 여 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-313">Once these statements have been added, we can utilize the built-in inserting, editing, and deleting features inherent to the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="06bdf-314">즐거운 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="06bdf-314">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="06bdf-315">저자 소개</span><span class="sxs-lookup"><span data-stu-id="06bdf-315">About the Author</span></span>

<span data-ttu-id="06bdf-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 7 ASP/ASP.NET 서적의 저자 이자 설립자입니다 [4GuysFromRolla.com](http://www.4guysfromrolla.com), 1998 Microsoft 웹 기술을 사용 하 여 왔습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="06bdf-317">Scott는 독립 컨설턴트, 강사, 그리고 기록기로 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-317">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="06bdf-318">최근 저서는 [ *Sams 설명 직접 ASP.NET 2.0 24 시간 동안의*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-318">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="06bdf-319">그에 도달할 수 있습니다 [ mitchell@4GuysFromRolla.com합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="06bdf-319">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="06bdf-320">찾을 수 있는 저자의 블로그를 통해 또는 [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)합니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-320">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="06bdf-321">특별히 감사</span><span class="sxs-lookup"><span data-stu-id="06bdf-321">Special Thanks To</span></span>

<span data-ttu-id="06bdf-322">이 자습서 시리즈는 많은 유용한 검토자가 검토 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-322">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="06bdf-323">이 자습서에 대 한 선행 검토자 Scott와을 클라이드, Randell Schmidt 및 박 단은 Pespisa 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="06bdf-323">Lead reviewers for this tutorial were Scott Clyde, Randell Schmidt, and Ken Pespisa.</span></span> <span data-ttu-id="06bdf-324">내 향후 MSDN 문서를 검토에 관심이 있으십니까?</span><span class="sxs-lookup"><span data-stu-id="06bdf-324">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="06bdf-325">그렇다면 삭제 나에서 선 [ mitchell@4GuysFromRolla.com합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="06bdf-325">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="06bdf-326">[이전](querying-data-with-the-sqldatasource-control-cs.md)
> [다음](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="06bdf-326">[Previous](querying-data-with-the-sqldatasource-control-cs.md)
[Next](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span></span>
