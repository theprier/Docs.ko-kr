---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: "데이터 액세스 계층 (VB) 만들기 | Microsoft Docs"
author: rick-anderson
description: "이 자습서에서는 처음부터 시작 알아보고 만들기 DAL 데이터 액세스 계층 (), 형식화 된 데이터 집합을 사용 하 여 데이터베이스의 정보에 액세스 하려면 하겠습니다."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: 556b90f5e29f30756a4bd3b16be9608011558c4d
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-data-access-layer-vb"></a><span data-ttu-id="29b91-103">데이터 액세스 계층 (VB)을 만들려면</span><span class="sxs-lookup"><span data-stu-id="29b91-103">Creating a Data Access Layer (VB)</span></span>
====================
<span data-ttu-id="29b91-104">으로 [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="29b91-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="29b91-105">[샘플 앱을 다운로드](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) 또는 [PDF 다운로드](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="29b91-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) or [Download PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span></span>

> <span data-ttu-id="29b91-106">이 자습서에서는 처음부터 시작 알아보고 만들기 DAL 데이터 액세스 계층 (), 형식화 된 데이터 집합을 사용 하 여 데이터베이스의 정보에 액세스 하려면 하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="29b91-107">소개</span><span class="sxs-lookup"><span data-stu-id="29b91-107">Introduction</span></span>

<span data-ttu-id="29b91-108">웹 개발자로 우리 생활 편의 중심으로 데이터를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="29b91-109">데이터를 검색 하 고, 및를 수집 하 여 요약할 웹 페이지를 수정 하는 코드를 저장 하는 데이터베이스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="29b91-110">ASP.NET 2.0에서 이와 같은 일반적인 패턴을 구현 하기 위한 기술을 살펴봅니다 긴 시리즈의 첫 번째 자습서입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="29b91-111">만들기 작업을 시작 합니다는 [소프트웨어 아키텍처](http://en.wikipedia.org/wiki/Software_architecture) 되는 프레젠테이션 계층의 ASP.NET 구성된 페이지 및 사용자 지정 비즈니스 규칙을 적용 하는의 액세스 DAL (데이터 계층) 형식화 된 데이터 집합, 한 BLL 비즈니스 논리 계층 ()를 사용 하 여 구성 일반 페이지 레이아웃을 공유 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="29b91-112">이 백 엔드 기반이 살펴본 다음에, 보고로 이동 되 면, 표시 하는 방법을 보여 주는 요약, 수집 및 웹 응용 프로그램에서 데이터 유효성을 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="29b91-113">이러한 자습서를 간결 하 게 하는 프로세스를 통해 시각적으로 다량의 스크린 샷을 단계별 지침을 제공 하 게 조정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="29b91-114">각 자습서 C# 및 Visual Basic 버전에서 사용할 수 있으며 사용 되는 전체 코드의 다운로드에 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="29b91-115">(이 첫 번째 자습서는 매우 긴 하지만 나머지 훨씬 더 많은 양이 청크에서 제공 됩니다.)</span><span class="sxs-lookup"><span data-stu-id="29b91-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="29b91-116">이 자습서에 사용할 예정에 배치 하 고 Northwind 데이터베이스의 Microsoft SQL Server 2005 Express Edition 버전은 `App_Data` 디렉터리입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the `App_Data` directory.</span></span> <span data-ttu-id="29b91-117">데이터베이스 파일 외에 `App_Data` 폴더는 데이터베이스를 만들기 위한 SQL 스크립트를 다른 데이터베이스 버전을 사용 하려는 경우에 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-117">In addition to the database file, the `App_Data` folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="29b91-118">이러한 스크립트는 또한 수 있습니다 [Microsoft에서 직접 다운로드](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en)하려는 경우, 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="29b91-119">Northwind 데이터베이스의 다른 SQL Server 버전을 사용 하는 경우 업데이트 해야 합니다는 `NORTHWNDConnectionString` 응용 프로그램의 설정 `Web.config` 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-119">If you use a different SQL Server version of the Northwind database, you will need to update the `NORTHWNDConnectionString` setting in the application's `Web.config` file.</span></span> <span data-ttu-id="29b91-120">Visual Studio 2005 Professional Edition을 사용 하 여 파일 시스템 기반 웹 사이트 프로젝트와 웹 응용 프로그램 구축 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="29b91-121">그러나이 자습서의 모든 작업은 Visual Studio 2005의 무료 버전에 잘 [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/)합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>

<span data-ttu-id="29b91-122">이 자습서에서는 합니다를 맨 처음부터 시작 하 고 액세스 계층 DAL (데이터)를 만들어 다음을 만듭니다는 [BLL 비즈니스 논리 계층 ()](creating-a-business-logic-layer-vb.md) 두 번째 자습서에서는 및에 대 한 작업에서 [페이지 레이아웃 및탐색](master-pages-and-site-navigation-vb.md) 세 번째에서입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the [Business Logic Layer (BLL)](creating-a-business-logic-layer-vb.md) in the second tutorial, and working on [page layout and navigation](master-pages-and-site-navigation-vb.md) in the third.</span></span> <span data-ttu-id="29b91-123">세 번째 기초 기반으로 구축 되며 후 자습서에서는 처음 3 개에 배치 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="29b91-124">이 첫 번째 자습서에서 다루지 않으므로 Visual Studio를 시작 하 고 이제 시작 하겠습니다를 많은 접수 했습니다!</span><span class="sxs-lookup"><span data-stu-id="29b91-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="29b91-125">1 단계: 웹 프로젝트 만들기 및 데이터베이스에 연결</span><span class="sxs-lookup"><span data-stu-id="29b91-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="29b91-126">우리의 액세스 DAL (데이터 계층)을 만들 수 있습니다, 전에 먼저 웹 사이트를 만들고 데이터베이스를 설치 하려면 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="29b91-127">먼저 새 파일 시스템 기반 ASP.NET 웹 사이트를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="29b91-128">이를 위해 파일 메뉴로 이동 하 고 새 웹 사이트 대화 상자를 표시 하는 새 웹 사이트를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="29b91-129">ASP.NET 웹 사이트 템플릿을 선택한, 파일 시스템에 위치 드롭 다운 목록을 설정, 웹 사이트를 배치할 폴더를 선택 및 Visual basic 언어를 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span>


<span data-ttu-id="29b91-130">[![새 파일 시스템 기반 웹 사이트 만들기](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span></span>

<span data-ttu-id="29b91-131">**그림 1**: New File System-Based 웹 사이트 만들기 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image3.png))</span></span>


<span data-ttu-id="29b91-132">이렇게 하면 새 웹 사이트에 만들어집니다는 `Default.aspx` ASP.NET 페이지는 `App_Data` 폴더 및 `Web.config` 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-132">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

<span data-ttu-id="29b91-133">만든 웹 사이트, Visual Studio 서버 탐색기에서 데이터베이스에 대 한 참조를 추가 하는 다음 단계가입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="29b91-134">서버 탐색기에 데이터베이스를 추가 하 여 테이블, 저장된 프로시저, 뷰 및 Visual Studio 내에서 온 모든을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="29b91-135">테이블 데이터를 볼 하거나 쿼리 작성기를 통해 직접 또는 그래픽으로 사용자 고유의 쿼리를 만들 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="29b91-136">또한 DAL에 대 한 형식화 된 데이터 집합을 구축 했습니다 형식화 된 데이터 집합을 생성 해야 하는 데이터베이스 지점 Visual Studio로 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="29b91-137">시간의 해당 지점에서이 연결 정보를 제공할 수 있습니다, 하는 동안 Visual Studio 서버 탐색기에 이미 등록 된 데이터베이스의 드롭 다운 목록을 자동으로 채웁니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="29b91-138">서버 탐색기에 Northwind 데이터베이스를 추가 하기 위한 단계에서 SQL Server 2005 Express Edition 데이터베이스 사용 여부에 따라 달라 집니다는 `App_Data` 폴더 또는 Microsoft SQL Server 2000 또는 2005 데이터베이스 서버 설정 사용 하려는 있는 경우 대신 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the `App_Data` folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="29b91-139">데이터베이스를 사용 하 여`App_Data`폴더</span><span class="sxs-lookup"><span data-stu-id="29b91-139">Using a Database in the`App_Data`Folder</span></span>

<span data-ttu-id="29b91-140">데이터베이스 서버에 데이터베이스를 추가할 필요가 없도록 하려면 SQL Server 2000 또는 2005 데이터베이스 서버를 연결할 수 없는 경우에 다운로드 한 websit에 있는 Northwind 데이터베이스의 SQL Server 2005 Express Edition 버전을 사용할 수 있습니다. e's `App_Data` 폴더 (`NORTHWND.MDF`).</span><span class="sxs-lookup"><span data-stu-id="29b91-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's `App_Data` folder (`NORTHWND.MDF`).</span></span>

<span data-ttu-id="29b91-141">데이터베이스에 배치 된 `App_Data` 폴더가 서버 탐색기에 자동으로 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-141">A database placed in the `App_Data` folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="29b91-142">사용자에 게 컴퓨터에 설치 하는 SQL Server 2005 Express Edition 가정 NORTHWND 라는 노드가 표시 됩니다. 서버 탐색기에서 MDF를 확장 하 고 해당 테이블, 뷰, 저장된 프로시저 및에 (그림 2 참조)를 탐색할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="29b91-143">`App_Data` 폴더 Microsoft Access 포함할 수 `.mdb` 처럼 SQL Server 대응 자동으로 추가 됩니다 서버 탐색기에 있는 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-143">The `App_Data` folder can also hold Microsoft Access `.mdb` files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="29b91-144">SQL Server 옵션 중 하나를 사용 하지 않으려면 경우 언제 든 지 [Northwind 데이터베이스 파일의 Microsoft Access 버전을 다운로드](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) 빠져나와 `App_Data` 디렉터리입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the `App_Data` directory.</span></span> <span data-ttu-id="29b91-145">그러나,으로 Access 데이터베이스에 없는 유지 풍부한 기능의 SQL Server와 및 웹 사이트 시나리오에 사용 하도록 설계 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="29b91-146">또한 몇 가지 35 + 자습서는 Access에서 지원 되지 않는 특정 데이터베이스 수준 기능을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="29b91-147">Microsoft SQL Server 2000 또는 2005 데이터베이스 서버에서 데이터베이스에 연결</span><span class="sxs-lookup"><span data-stu-id="29b91-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="29b91-148">데이터베이스 서버에 설치 된 Northwind 데이터베이스에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="29b91-149">데이터베이스 서버에 아직 없는 경우 Northwind 데이터베이스를 설치, 먼저 추가 해야 데이터베이스 서버에 또는이 자습서 다운로드에 포함 된 설치 스크립트를 실행 하 여 [SQL Server 2000 버전의 Northwind 다운로드 합니다. 설치 스크립트 및](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) Microsoft 웹 사이트에서 직접 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="29b91-150">설치 되어 있는 데이터베이스를 만든 후 이동 Visual Studio에서 서버 탐색기에 데이터 연결 노드 단추로 클릭 하 고 연결 추가 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="29b91-151">보기로 이동 하 여 서버 탐색기에 표시 되지 않는 경우 / 서버 탐색기 또는 적중된 Ctrl + Alt + S입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="29b91-152">그러면 인증 정보 및 데이터베이스 이름을 지정할 수 있는에 연결할 서버, 연결 추가 대화 상자를 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="29b91-153">데이터베이스 연결 정보를 구성 하 고 확인 단추를 클릭 하면 성공적으로, 데이터베이스 노드 아래에 데이터 연결 노드로 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="29b91-154">테이블, 뷰, 저장된 프로시저 및 등을 탐색 하는 데이터베이스 노드를 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![데이터베이스 서버의 Northwind 데이터베이스에 대 한 연결 추가](creating-a-data-access-layer-vb/_static/image4.png)

<span data-ttu-id="29b91-156">**그림 2**: 데이터베이스 서버의 Northwind 데이터베이스에 대 한 연결 추가</span><span class="sxs-lookup"><span data-stu-id="29b91-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="29b91-157">2 단계: 데이터 액세스 계층을 만들려면</span><span class="sxs-lookup"><span data-stu-id="29b91-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="29b91-158">작업할 때는 데이터 하나의 옵션은 웹 응용 프로그램을 프레젠테이션 계층을 ASP.NET 페이지 확인) (에서 프레젠테이션 계층에 직접 데이터 관련 논리를 포함할입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="29b91-159">ASP.NET 페이지의 코드 부분에서 ADO.NET 코드를 작성 하거나 SqlDataSource 컨트롤 태그 부분에서 사용 하 여 형식의 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="29b91-160">두 경우 모두이 방법은 프레젠테이션 계층으로 데이터 액세스 논리 밀접 하 게 결합 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="29b91-161">그러나 권장 하는 방법,입니다 프레젠테이션 계층과에서 데이터 액세스 논리를 분리 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="29b91-162">이 별도 계층은 줄여서 DAL 데이터 액세스 계층으로 이라고 하며 일반적으로 별도 클래스 라이브러리 프로젝트로 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="29b91-163">이 계층된 아키텍처의 이점 문서화 되어 (이러한 장점에 대 한 내용은이 자습서의 끝에 "추가 정보" 섹션 참조)이이 시리즈의 해당 메뉴로 이동 합니다는 하다 고 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="29b91-164">데이터베이스에 대 한 연결을 만드는 등의 데이터 원본에만 적용 되는 모든 코드를 발급 `SELECT`, `INSERT`, `UPDATE`, 및 `DELETE` 명령 및 기타 등등 DAL에 배치 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing `SELECT`, `INSERT`, `UPDATE`, and `DELETE` commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="29b91-165">프레젠테이션 계층 이러한 데이터 액세스 코드에 대 한 참조를 포함 해야 하지만 대신 모든 데이터를 요청에 대 한 DAL 호출 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="29b91-166">데이터 액세스 계층에는 일반적으로 기본 데이터베이스 데이터에 액세스 하기 위한 메서드가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="29b91-167">Northwind 데이터베이스에 예를 들어 `Products` 및 `Categories` 속한 범주 및 판매에 대 한 제품을 기록 하는 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-167">The Northwind database, for example, has `Products` and `Categories` tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="29b91-168">우리의 DAL에 같은 메서드는 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="29b91-169">`GetCategories(),`모든 범주에 대 한 정보를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-169">`GetCategories(),` which will return information about all of the categories</span></span>
- <span data-ttu-id="29b91-170">`GetProducts()`를 하는 모든 제품에 대 한 정보를 반환</span><span class="sxs-lookup"><span data-stu-id="29b91-170">`GetProducts()`, which will return information about all of the products</span></span>
- <span data-ttu-id="29b91-171">`GetProductsByCategoryID(categoryID)`는 지정된 된 범주에 속하는 모든 제품을 반환 합니다</span><span class="sxs-lookup"><span data-stu-id="29b91-171">`GetProductsByCategoryID(categoryID)`, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="29b91-172">`GetProductByProductID(productID)`는 특정 제품에 대 한 정보를 반환 합니다</span><span class="sxs-lookup"><span data-stu-id="29b91-172">`GetProductByProductID(productID)`, which will return information about a particular product</span></span>

<span data-ttu-id="29b91-173">이러한 메서드를 호출 하는 경우 데이터베이스에 연결 하 고 적절 한 쿼리를 실행 하 고 결과 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="29b91-174">이러한 결과 반환 하는 것이 중요 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-174">How we return these results is important.</span></span> <span data-ttu-id="29b91-175">데이터 집합 또는 DataReader 데이터베이스 쿼리를 사용해 이러한 메서드를 반환 하기만 하면 수 있지만 이상적으로 이러한 결과 반환할지를 사용 하 여 *강력한 형식의 개체*합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="29b91-176">강력한 형식의 개체는 스키마는 컴파일 타임에 엄격 하 게 정의 된 반면 반대 자유로운 형식의 개체는 스키마 런타임이 될 때까지 알 수 없는 하나.</span><span class="sxs-lookup"><span data-stu-id="29b91-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="29b91-177">예를 들어 DataReader와 기본적으로 데이터 집합은 자유로운 형식의 개체 스키마를 채우는 데 사용 되는 데이터베이스 쿼리에서 반환 된 열에 의해 정의 된 이후입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="29b91-178">같은 구문을 사용 해야 하는 느슨한 형 DataTable에서 특정 열에 액세스 하려면: `DataTable.Rows(index)("columnName")`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: `DataTable.Rows(index)("columnName")`.</span></span> <span data-ttu-id="29b91-179">이 예에서 DataTable의 느슨한 입력 문자열 또는 서 수 인덱스를 사용 하 여 열 이름에 액세스 해야 하는 팩트에서 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="29b91-180">강력한 형식의 DataTable 반면에 갖습니다의 각 열 속성으로 구현 되기 때문에 다음과 같은 코드를: `DataTable.Rows(index).columnName`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: `DataTable.Rows(index).columnName`.</span></span>

<span data-ttu-id="29b91-181">강력한 형식의 개체를 반환 하려면 개발자가 자신의 사용자 지정 비즈니스 개체를 만들 하거나 형식화 된 데이터 집합을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="29b91-182">비즈니스 개체 속성은 일반적으로 비즈니스 개체의 기본 데이터베이스 테이블의 열을 반영 하는 클래스를 나타내는 대로 개발자가 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="29b91-183">형식화 된 데이터 집합은 데이터베이스 스키마 및 해당 멤버는이 스키마에 따라 강력한 형식에 따라 Visual Studio에서 자동으로 생성 하는 클래스.</span><span class="sxs-lookup"><span data-stu-id="29b91-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="29b91-184">ADO.NET DataSet, DataTable 및 DataRow 클래스를 확장 하는 클래스의 형식화 된 데이터 집합 자체 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="29b91-185">뿐만 아니라 강력한 형식의 Datatable 형식화 된 데이터 집합 이제 포함 하는 데이터 집합의 Datatable 채우기 및 수정은 Datatable 내에서 데이터베이스에 다시 전파 하기 위한 메서드를 사용 하 여 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="29b91-186">형식화 된 데이터 집합을 사용 하 여 사용자 지정 비즈니스 개체와의 장단점에 자세한 내용은를 참조 [데이터 계층 구성 요소를 디자인 하 고 계층 간 데이터 전달](https://msdn.microsoft.com/en-us/library/ms978496.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/en-us/library/ms978496.aspx).</span></span>


<span data-ttu-id="29b91-187">이 자습서의이 아키텍처에 대 한 강력한 형식의 데이터 집합을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="29b91-188">그림 3에서는 형식화 된 데이터 집합을 사용 하는 응용 프로그램의 다른 계층 간에 워크플로 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="29b91-189">[![모든 데이터 액세스 코드에는 dal과 있어는](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span></span>

<span data-ttu-id="29b91-190">**그림 3**:에 dal과 모든 데이터 액세스 코드는 있어 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="29b91-191">형식화 된 데이터 집합 및 테이블 어댑터 만들기</span><span class="sxs-lookup"><span data-stu-id="29b91-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="29b91-192">우리의 DAL 만들기를 시작 하려면이 프로젝트에 형식화 된 데이터 집합을 추가 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="29b91-193">이렇게 하려면 솔루션 탐색기에서 프로젝트 노드를 마우스 오른쪽 단추로 클릭 하 고 새 항목 추가 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="29b91-194">템플릿 목록에서 데이터 집합 옵션을 선택 하 고 이름을 `Northwind.xsd`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-194">Select the DataSet option from the list of templates and name it `Northwind.xsd`.</span></span>


<span data-ttu-id="29b91-195">[![프로젝트에 새 데이터 집합을 추가 하려면 선택 합니다.](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span></span>

<span data-ttu-id="29b91-196">**그림 4**: 프로젝트에 새 데이터 집합을 추가 하도록 선택 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image10.png))</span></span>


<span data-ttu-id="29b91-197">데이터 집합을 추가 하 라는 메시지가 나타나면 추가 클릭 한 후의 `App_Code` 폴더, 예를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-197">After clicking Add, when prompted to add the DataSet to the `App_Code` folder, choose Yes.</span></span> <span data-ttu-id="29b91-198">형식화 된 데이터 집합에 대 한 디자이너가 표시 됩니다, 그리고 및 TableAdapter 구성 마법사가 시작 형식화 된 데이터 집합에 첫 번째 여 TableAdapter를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="29b91-199">데이터의 강력한 형식의 컬렉션으로 형식화 된 데이터 집합 사용 강력한 형식의 DataRow 인스턴스의 구성 되어 있으며 각 DataTable 인스턴스 강력한 형식으로 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="29b91-200">이 자습서 시리즈의 작업할 해야 하는 기본 데이터베이스 테이블의 각 항목에 대 한 강력한 형식의 DataTable를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="29b91-201">에 대 한 데이터 테이블을 만드는 것부터 시작 하겠습니다는 `Products` 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-201">Let's start with creating a DataTable for the `Products` table.</span></span>

<span data-ttu-id="29b91-202">강력한 형식의 Datatable의 기본 데이터베이스 테이블에서 데이터에 액세스 하는 방법에는 정보를 포함 하지 않는 것을 명심 하십시오.</span><span class="sxs-lookup"><span data-stu-id="29b91-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="29b91-203">DataTable을 채우는 데 데이터를 검색 하기 위해 데이터 액세스 계층으로 작동 하는 TableAdapter 클래스를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="29b91-204">에 대 한 우리의 `Products` DataTable TableAdapter에는 메서드가 포함 됩니다 `GetProducts()`, `GetProductByCategoryID(categoryID)`등 프레젠테이션 계층에서 호출한입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-204">For our `Products` DataTable, the TableAdapter will contain the methods `GetProducts()`, `GetProductByCategoryID(categoryID)`, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="29b91-205">DataTable의 역할은 계층 간에 데이터를 전달 하는 데 사용 하는 강력한 형식의 개체 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="29b91-206">TableAdapter 구성 마법사 사용 하는 데이터베이스를 선택 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="29b91-207">드롭 다운 목록 서버 탐색기에서 해당 데이터베이스에 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="29b91-208">서버 탐색기에 Northwind 데이터베이스를 추가 하지 않은 경우 웹 페이지 그러려면이 이번에 새 연결 단추를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="29b91-209">[![드롭다운 목록에서 Northwind 데이터베이스를 선택 합니다.](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span></span>

<span data-ttu-id="29b91-210">**그림 5**: 드롭 다운 목록에서 Northwind 데이터베이스를 선택 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image13.png))</span></span>


<span data-ttu-id="29b91-211">데이터베이스를 선택한 다음을 클릭 하 여, 후 묻는에서 연결 문자열을 저장 하려면는 `Web.config` 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the `Web.config` file.</span></span> <span data-ttu-id="29b91-212">연결 문자열을 저장 하 여 하드 코딩 된 TableAdapter 클래스에서를 연결 문자열 정보는 나중에 변경 되 면 작업을 간소화할 수 있는 것을 방지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="29b91-213">에 위치한 구성 파일에서 연결 문자열을 저장 하도록 선택할 경우는 `<connectionStrings>` 될 수 있는 섹션 [필요에 따라 암호화 된](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) 내에서 새 ASP.NET 2.0 속성 페이지를 통해 나중에 수정 되거나 보안 향상에 대 한 IIS GUI 관리 되는 도구를 관리자에 더 적합 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-213">If you opt to save the connection string in the configuration file it's placed in the `<connectionStrings>` section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="29b91-214">[![Web.config에 연결 문자열 저장](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span></span>

<span data-ttu-id="29b91-215">**그림 6**:에 연결 문자열 저장 `Web.config` ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-215">**Figure 6**: Save the Connection String to `Web.config` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image16.png))</span></span>


<span data-ttu-id="29b91-216">다음으로, 하 강력한 형식의 첫 번째 데이터 테이블에 대 한 스키마를 정의 하 고 강력한 형식의 DataSet을 채울 때 사용 하 여 TableAdapter 첫 번째 방법을 제공 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="29b91-217">이러한 두 단계는이 DataTable에 반영 한다고 테이블에서 열을 반환 하는 쿼리를 만들어 동시에 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="29b91-218">마법사의 마지막에이 쿼리에 메서드 이름을 지정 하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="29b91-219">된을 달성 되 면 우리의 프레젠테이션 계층에서이 메서드를 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="29b91-220">메서드는 정의 된 쿼리를 실행 하 고 강력한 형식의 DataTable을 채우는 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="29b91-221">SQL 쿼리를 정의 합니다. 시작 하려면 TableAdapter 쿼리를 실행 해야 원하는 먼저 지정 해야 했습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="29b91-222">임시 SQL 문을 사용 하 여, 새 저장된 프로시저를 만드는 하거나 수 기존 저장된 프로시저를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="29b91-223">이 자습서에 대 한 임시 SQL 문을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="29b91-224">참조 [Brian Noyes](http://briannoyes.net/)문서의 [Visual Studio 2005 데이터 집합 디자이너로 데이터 액세스 계층 빌드](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) 저장된 프로시저를 사용 하는 예제에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="29b91-225">[![임시 SQL 문을 사용 하 여 데이터를 쿼리 합니다.](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span></span>

<span data-ttu-id="29b91-226">**그림 7**: 특별 SQL 문을 사용 하 여 데이터를 쿼리 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image19.png))</span></span>


<span data-ttu-id="29b91-227">이 시점에서는 입력할 수 SQL 쿼리를 직접.</span><span class="sxs-lookup"><span data-stu-id="29b91-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="29b91-228">TableAdapter의 첫 번째 메서드를 만들 때에 보통 쿼리를 해당 DataTable에 표현 되어야 하는 열을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="29b91-229">모든 열과의 모든 행을 반환 하는 쿼리를 만들어이 작업을 수행할 수 있습니다는 `Products` 테이블:</span><span class="sxs-lookup"><span data-stu-id="29b91-229">We can accomplish this by creating a query that returns all columns and all rows from the `Products` table:</span></span>


<span data-ttu-id="29b91-230">[![입력란에 SQL 쿼리를 입력 합니다.](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span></span>

<span data-ttu-id="29b91-231">**그림 8**: SQL 쿼리에는 텍스트 입력 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image22.png))</span></span>


<span data-ttu-id="29b91-232">또는 쿼리 작성기를 사용 하 고 그래픽으로 그림 9에 표시 된 것 처럼 쿼리를 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="29b91-233">[![쿼리 편집기를 통해 쿼리를 그래픽으로 만들기](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span></span>

<span data-ttu-id="29b91-234">**그림 9**:는 쿼리 그래픽으로 쿼리 편집기를 통해 만들기 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image25.png))</span></span>


<span data-ttu-id="29b91-235">쿼리를 만든 후 다음 화면으로 이동 하기 전에 고급 옵션 버튼을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="29b91-236">웹 사이트 프로젝트에서는 "생성 Insert, Update 및 Delete 문을"는 유일 하 게 고급는 기본적으로 선택 옵션 클래스 라이브러리 또는 Windows 프로젝트에서이 마법사를 실행 하는 경우에 "낙관적 동시성 사용" 옵션 선택 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="29b91-237">현재 선택 되지 않은 "낙관적 동시성 사용" 옵션을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="29b91-238">낙관적 동시성 이후 자습서에서 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="29b91-239">[![생성 Insert, Update 및 Delete 문 옵션을 선택 합니다.](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span></span>

<span data-ttu-id="29b91-240">**그림 10**: 생성 Insert, Update 및 Delete 문 옵션을 선택 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image28.png))</span></span>


<span data-ttu-id="29b91-241">고급 옵션을 확인 한 후 최종 화면으로 이동 하려면 다음을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="29b91-242">여기 라는 요청 TableAdapter에 추가 하는 방법을 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="29b91-243">데이터를 채우기 위한 두 가지 패턴 가지가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="29b91-244">**DataTable 채우기** 쿼리 결과에 따라이 방법을 사용 하는 메서드가 만들어집니다을 받으며 매개 변수로 DataTable에 채웁니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="29b91-245">ADO.NET DataAdapter 클래스와 함께이 패턴을 구현 예를 들어 해당 `Fill()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-245">The ADO.NET DataAdapter class, for example, implements this pattern with its `Fill()` method.</span></span>
- <span data-ttu-id="29b91-246">**DataTable 반환** 이 접근 방식 메서드 및 드립니다 DataTable을 채우는 만들어 메서드 반환 값으로 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="29b91-247">이러한 패턴 중 하나 또는 모두를 구현 하는 TableAdapter를 가질 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="29b91-248">여기에 제공 하는 메서드 이름을 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="29b91-249">만 사용할 예정 이러한 자습서 전체에서 후자의 패턴 하는 경우에 두 확인란이 모두 선택 옵션을 선택 떠나 자 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="29b91-250">또한의 이름을 아니라 제네릭 `GetData` 메서드를 `GetProducts`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-250">Also, let's rename the rather generic `GetData` method to `GetProducts`.</span></span>

<span data-ttu-id="29b91-251">이 옵션을 선택 하는 경우 최종 확인란 "GenerateDBDirectMethods" 만듭니다 `Insert()`, `Update()`, 및 `Delete()` TableAdapter에 대 한 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates `Insert()`, `Update()`, and `Delete()` methods for the TableAdapter.</span></span> <span data-ttu-id="29b91-252">이 옵션을 선택 하는 경우 모든 업데이트 할 TableAdapter의 위한 유일한을 통해 수행할 수 `Update()` 메서드와 형식의 DataSet, DataTable, 단일 DataRow 또는 Datarow의 배열입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole `Update()` method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="29b91-253">(선택한 경우이 확인란을 그림 9의 고급 속성에서 선택 되지 않은 "생성 Insert, Update 및 Delete 문을" 옵션 설정은 아무런 효과가 없습니다.) 이 확인란은 선택한 둡니다 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="29b91-254">[![GetData에서 GetProducts로 메서드 이름 변경](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span></span>

<span data-ttu-id="29b91-255">**그림 11**:에서 메서드 이름을 변경 `GetData` 를 `GetProducts` ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-255">**Figure 11**: Change the Method Name from `GetData` to `GetProducts` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image31.png))</span></span>


<span data-ttu-id="29b91-256">마침을 클릭 하 여 마법사를 완료 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="29b91-257">마법사를 닫은 후 방금 만든 DataTable을 보여 주는 데이터 집합 디자이너도 돌아옵니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="29b91-258">열 목록을 볼 수 있습니다는 `Products` DataTable (`ProductID`, `ProductName`등)의 메서드는 `ProductsTableAdapter` (`Fill()` 및 `GetProducts()`).</span><span class="sxs-lookup"><span data-stu-id="29b91-258">You can see the list of columns in the `Products` DataTable (`ProductID`, `ProductName`, and so on), as well as the methods of the `ProductsTableAdapter` (`Fill()` and `GetProducts()`).</span></span>


<span data-ttu-id="29b91-259">[![제품 DataTable 및 ProductsTableAdapter 형식화 된 데이터 집합에 추가 되었습니다.](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span></span>

<span data-ttu-id="29b91-260">**그림 12**:는 `Products` DataTable 및 `ProductsTableAdapter` 형식화 된 데이터 집합에 추가 되었습니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-260">**Figure 12**: The `Products` DataTable and `ProductsTableAdapter` have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image34.png))</span></span>


<span data-ttu-id="29b91-261">단일 DataTable로 형식화 된 DataSet 했으므로 시점에서 (`Northwind.Products`) 및 DataAdapter 강력한 형식의 클래스 (`NorthwindTableAdapters.ProductsTableAdapter`)와 `GetProducts()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-261">At this point we have a Typed DataSet with a single DataTable (`Northwind.Products`) and a strongly-typed DataAdapter class (`NorthwindTableAdapters.ProductsTableAdapter`) with a `GetProducts()` method.</span></span> <span data-ttu-id="29b91-262">모든 제품의 목록을 다음과 같은 코드에서 액세스 하 이러한 개체를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

<span data-ttu-id="29b91-263">이 코드에 쓴 다음 한 약간의 데이터 액세스 관련 코드가 필요 하지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="29b91-264">모든 ADO.NET 클래스를 인스턴스화할 수 없는, 연결 문자열, SQL 쿼리를 참조 하지 필요가 우리 또는 저장 프로시저.</span><span class="sxs-lookup"><span data-stu-id="29b91-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="29b91-265">대신, TableAdapter에 낮은 수준의 데이터 액세스 코드를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="29b91-266">이 예에서 사용 된 각 개체는 강력한 형식의 Visual Studio IntelliSense 및 컴파일 타임 형식 검사를 수행할 수 있도록 허용 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="29b91-267">및 TableAdapter를 반환한 모든 Datatable의 ASP.NET 데이터 GridView, DetailsView, DropDownList, CheckBoxList, 등과 같은 여러 웹 컨트롤을 바인딩할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="29b91-268">다음 예제에서 반환 된 DataTable을 바인딩하는 `GetProducts()` 방금 롤아웃할 세 줄의 코드 내에서 GridView 메서드는 `Page_Load` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-268">The following example illustrates binding the DataTable returned by the `GetProducts()` method to a GridView in just a scant three lines of code within the `Page_Load` event handler.</span></span>

<span data-ttu-id="29b91-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="29b91-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

<span data-ttu-id="29b91-270">AllProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="29b91-270">AllProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]


<span data-ttu-id="29b91-271">[![제품 목록은 GridView에 표시 됩니다.](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span></span>

<span data-ttu-id="29b91-272">**그림 13**:는 GridView에 제품의 목록이 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image37.png))</span></span>


<span data-ttu-id="29b91-273">이 예제에서는 ASP.NET 페이지의 코드의 세 줄 작성 하는 데 필요한 반면 `Page_Load` 이벤트 처리기, 이후 자습서는 ObjectDataSource를 사용 하 여 선언적으로 DAL에서 데이터를 검색 하는 방법을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-273">While this example required that we write three lines of code in our ASP.NET page's `Page_Load` event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="29b91-274">코드를 작성 해야 우리는 ObjectDataSource와도 페이징 및 정렬 지원을 받을 수 및!</span><span class="sxs-lookup"><span data-stu-id="29b91-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="29b91-275">3 단계: 추가 데이터 액세스 계층 하는 메서드를 매개 변수화</span><span class="sxs-lookup"><span data-stu-id="29b91-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="29b91-276">이 시점에서 우리의 `ProductsTableAdapter` 클래스에는 한 가지 방법은 하지만 `GetProducts()`, 데이터베이스의 모든 제품을 반환 하는입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-276">At this point our `ProductsTableAdapter` class has but one method, `GetProducts()`, which returns all of the products in the database.</span></span> <span data-ttu-id="29b91-277">모든 제품을 사용 하기 위해서는 확실히 유용 하지만, 특정 제품 또는 특정 범주에 속하는 모든 제품에 대 한 정보를 검색할 하고자 하는 경우 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="29b91-278">데이터 액세스 계층에 이러한 기능을 추가 하려면 TableAdapter에 매개 변수가 있는 메서드를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="29b91-279">추가 `GetProductsByCategoryID(categoryID)` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-279">Let's add the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="29b91-280">데이터 집합 디자이너 돌아가서 DAL에 새 메서드를 추가 하려면 마우스 오른쪽 단추로 클릭는 `ProductsTableAdapter` 섹션을 추가 하는 쿼리를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the `ProductsTableAdapter` section, and choose Add Query.</span></span>


![TableAdapter를 마우스 오른쪽 단추로 클릭 하 고 선택 쿼리 추가](creating-a-data-access-layer-vb/_static/image38.png)

<span data-ttu-id="29b91-282">**그림 14**: TableAdapter를 마우스 오른쪽 단추로 클릭 하 고 선택 쿼리 추가</span><span class="sxs-lookup"><span data-stu-id="29b91-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="29b91-283">우리는 먼저 임시 SQL 문 또는 기존 또는 새 저장된 프로시저를 사용 하 여 데이터베이스에 액세스 하고자 하는 방법에 대 한 라는 메시지가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="29b91-284">임시 SQL 문을 다시 사용 하도록 선택할 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="29b91-285">다음으로 어떤 유형의 SQL 쿼리 사용 같은 요청 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="29b91-286">지정된 된 범주에 속하는 모든 제품을 반환할 할 것 이므로 작성 하려고는 `SELECT` 문이 행을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-286">Since we want to return all products that belong to a specified category, we want to write a `SELECT` statement which returns rows.</span></span>


<span data-ttu-id="29b91-287">[![행을 반환 하는 SELECT 문을 만드는 선택](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span></span>

<span data-ttu-id="29b91-288">**그림 15**: 만들기 하기로 결정 한 `SELECT` 문에 반환 행 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-288">**Figure 15**: Choose to Create a `SELECT` Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image41.png))</span></span>


<span data-ttu-id="29b91-289">다음 단계에서는 데이터에 액세스 하는 데 사용 하는 SQL 쿼리를 정의 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="29b91-290">특정 범주에 속해 있는 제품만 반환할 할 것 이므로 동일한 사용 `SELECT` 에서 문을 `GetProducts()`, 다음 코드를 추가 하지만 `WHERE` 절: `WHERE CategoryID = @CategoryID`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-290">Since we want to return only those products that belong to a particular category, I use the same `SELECT` statement from `GetProducts()`, but add the following `WHERE` clause: `WHERE CategoryID = @CategoryID`.</span></span> <span data-ttu-id="29b91-291">`@CategoryID` 만들려는 메서드 (즉, nullable 정수)에서 해당 유형의 입력된 매개 변수는 매개 변수 TableAdapter 마법사를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-291">The `@CategoryID` parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="29b91-292">[![만 지정된 된 범주에서 제품을 반환 하는 쿼리를 입력 합니다.](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span></span>

<span data-ttu-id="29b91-293">**그림 16**: 지정 된 범주에만 반환 제품에 쿼리를 입력 하십시오 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image44.png))</span></span>


<span data-ttu-id="29b91-294">마지막 단계에서 선택할 수 있습니다 데이터 액세스를 사용할 수 있을 뿐만 아니라 생성 된 메서드 이름을 사용자 지정 하는 패턴입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="29b91-295">채우기 패턴 이름을 변경해 보겠습니다 `FillByCategoryID` DataTable 반환에 대 한 패턴을 반환 하 고 (의 `GetX` 메서드), 사용 하 여 보겠습니다 `GetProductsByCategoryID`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-295">For the Fill pattern, let's change the name to `FillByCategoryID` and for the return a DataTable return pattern (the `GetX` methods), let's use `GetProductsByCategoryID`.</span></span>


<span data-ttu-id="29b91-296">[![TableAdapter 메서드는에 대 한 이름을 선택합니다](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span></span>

<span data-ttu-id="29b91-297">**그림 17**: TableAdapter 메서드는에 대 한 이름을 선택 합니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image47.png))</span></span>


<span data-ttu-id="29b91-298">마법사를 완료 한 후 데이터 집합 디자이너에서 새 TableAdapter 메서드를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![제품 수 이제 범주별으로 쿼리할 수](creating-a-data-access-layer-vb/_static/image48.png)

<span data-ttu-id="29b91-300">**그림 18**:의 제품 수 이제 범주별으로 쿼리할 수</span><span class="sxs-lookup"><span data-stu-id="29b91-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="29b91-301">추가 하는 `GetProductByProductID(productID)` 동일한 기법을 사용 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-301">Take a moment to add a `GetProductByProductID(productID)` method using the same technique.</span></span>

<span data-ttu-id="29b91-302">데이터 집합 디자이너에서 직접 이러한 매개 변수가 있는 쿼리를 테스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="29b91-303">TableAdapter의 메서드에 단추로 클릭 하 고 데이터 미리 보기를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="29b91-304">다음으로 매개 변수를 사용 하 고 미리 보기를 클릭 하는 값을 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="29b91-305">[![이러한 제품 속하는 음료 범주에 표시 됩니다.](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span></span>

<span data-ttu-id="29b91-306">**그림 19**: 음료 범주에 있는 제품 속하는 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image51.png))</span></span>


<span data-ttu-id="29b91-307">와 `GetProductsByCategoryID(categoryID)` 우리의 DAL에 메서드,에서는 지정 된 범주의 제품만 표시 하는 ASP.NET 페이지가 이제 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-307">With the `GetProductsByCategoryID(categoryID)` method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="29b91-308">다음 예제를 포함 하는 음료 범주에 있는 모든 제품을 `CategoryID` 1입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-308">The following example shows all products that are in the Beverages category, which have a `CategoryID` of 1.</span></span>

<span data-ttu-id="29b91-309">Beverages.aspx</span><span class="sxs-lookup"><span data-stu-id="29b91-309">Beverages.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

<span data-ttu-id="29b91-310">Beverages.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="29b91-310">Beverages.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]


<span data-ttu-id="29b91-311">[![이러한 제품 음료 범주에 표시 됩니다.](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span></span>

<span data-ttu-id="29b91-312">**그림 20**: 음료 범주에서 제품 하는 것이 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="29b91-313">4 단계: 삽입, 업데이트 및 데이터 삭제</span><span class="sxs-lookup"><span data-stu-id="29b91-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="29b91-314">일반적으로 삽입, 업데이트 및 데이터 삭제에 사용 하는 두 가지 패턴이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="29b91-315">데이터베이스 직접 패턴 이라고 부르겠습니다의 첫 번째 패턴을 만들어야 메서드는 호출 되 면 문제는 `INSERT`, `UPDATE`, 또는 `DELETE` 단일 데이터베이스 레코드에 작동 하는 데이터베이스에 명령 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an `INSERT`, `UPDATE`, or `DELETE` command to the database that operates on a single database record.</span></span> <span data-ttu-id="29b91-316">이러한 메서드는 일반적으로 삽입, 업데이트 또는 삭제 된 값으로 일련의 해당 하는 스칼라 값 (정수, 문자열, 부울, Datetime, 및 등)에 전달 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="29b91-317">이 패턴에 대 한 사용 예를 들어는 `Products` delete 메서드는 정수 매개 변수에서 수행 되는 테이블을 나타내는 `ProductID` insert 메서드에 대 한 문자열에 수행 되는 동안 삭제할 레코드의는 `ProductName`는 에대한10진수`UnitPrice`에 대 한 정수는 `UnitsOnStock`등입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-317">For example, with this pattern for the `Products` table the delete method would take in an integer parameter, indicating the `ProductID` of the record to delete, while the insert method would take in a string for the `ProductName`, a decimal for the `UnitPrice`, an integer for the `UnitsOnStock`, and so on.</span></span>


<span data-ttu-id="29b91-318">[![각 삽입, 업데이트 및 삭제 요청에 즉시 데이터베이스에 전송 됩니다.](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span></span>

<span data-ttu-id="29b91-319">**그림 21**: 각 삽입, 업데이트 및 삭제 요청에 즉시 데이터베이스에 전송 됩니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image57.png))</span></span>


<span data-ttu-id="29b91-320">참조 업데이트 패턴에 따라 일괄 처리 하는 것을 다른 패턴은 전체 데이터 집합, DataTable, 또는 한 메서드 호출에서 Datarow의 컬렉션을 업데이트 하기 위해서입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="29b91-321">이 패턴으로 개발자 삭제, 삽입 및 수정 DataTable에 Datarow 하 고 update 메서드를 이러한 Datarow 또는 DataTable을 전달 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="29b91-322">이 메서드를 다음에 전달 된 Datarow를 열거, 확인 여부은 한 수정, 추가 되거나 삭제 (DataRow의 통해 [RowState 속성](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) 값), 각 레코드에 대 한 적절 한 데이터베이스 요청을 실행 하 고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="29b91-323">[![Update 메서드를 호출 하면 모든 변경 내용이 데이터베이스와 동기화](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span></span>

<span data-ttu-id="29b91-324">**그림 22**: Update 메서드를 호출 하면 모든 변경 내용이 데이터베이스와 동기화 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image60.png))</span></span>


<span data-ttu-id="29b91-325">TableAdapter 일괄 처리 업데이트 패턴을 사용 하 여 기본적으로 지만 DB 직접 패턴을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="29b91-326">우리의 TableAdapter를 만들 때 고급 속성에서 "생성 Insert, Update 및 Delete 문을" 옵션을 선택 했습니다 않아는 `ProductsTableAdapter` 포함는 `Update()` 일괄 처리 업데이트 패턴을 구현 하는 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the `ProductsTableAdapter` contains an `Update()` method, which implements the batch update pattern.</span></span> <span data-ttu-id="29b91-327">TableAdapter가 포함 된 특히는 `Update()` 형식화 된 데이터 집합, 강력한 형식의 데이터 테이블 또는 하나 이상의 Datarow 전달 될 수 있는 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-327">Specifically, the TableAdapter contains an `Update()` method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="29b91-328">두 었으 면 "GenerateDBDirectMethods" 확인란이 선택 때 먼저 DB 직접 패턴은 TableAdapter를 만들기도 구현 될 통해 `Insert()`, `Update()`, 및 `Delete()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via `Insert()`, `Update()`, and `Delete()` methods.</span></span>

<span data-ttu-id="29b91-329">두 데이터 수정 패턴을 사용 하 여 TableAdapter의 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 발급 하는 속성의 `INSERT`, `UPDATE`, 및 `DELETE` 명령을 데이터베이스에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-329">Both data modification patterns use the TableAdapter's `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties to issue their `INSERT`, `UPDATE`, and `DELETE` commands to the database.</span></span> <span data-ttu-id="29b91-330">검사 및 수정할 수는 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 속성 데이터 집합 디자이너의 TableAdapter에서 클릭 한 다음 속성 창으로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-330">You can inspect and modify the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="29b91-331">(및 TableAdapter를 선택 했는지 확인는 `ProductsTableAdapter` 이 개체는 속성 창에서 드롭 다운 목록에서 선택 합니다.)</span><span class="sxs-lookup"><span data-stu-id="29b91-331">(Make sure you have selected the TableAdapter, and that the `ProductsTableAdapter` object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="29b91-332">[![TableAdapter에 InsertCommand, UpdateCommand, 및 DeleteCommand 속성](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span></span>

<span data-ttu-id="29b91-333">**그림 23**: The TableAdapter에 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 속성 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-333">**Figure 23**: The TableAdapter has `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image63.png))</span></span>


<span data-ttu-id="29b91-334">클릭을 검사 하거나 이러한 데이터베이스 명령 속성을 수정 하려면는 `CommandText` 하위 속성은 쿼리 작성기를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-334">To examine or modify any of these database command properties, click on the `CommandText` subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="29b91-335">[![쿼리 작성기에서 INSERT, UPDATE 및 DELETE 문이 구성](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span></span>

<span data-ttu-id="29b91-336">**그림 24**: 구성에서 `INSERT`, `UPDATE`, 및 `DELETE` 쿼리 작성기에서 문 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-336">**Figure 24**: Configure the `INSERT`, `UPDATE`, and `DELETE` Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image66.png))</span></span>


<span data-ttu-id="29b91-337">다음 코드 예제에서는 단종 되지 고 25 단위 이내 재고에 있는 모든 제품의 가격을 두 배로 일괄 처리 업데이트 패턴을 사용 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

<span data-ttu-id="29b91-338">아래 코드 DB 직접 패턴을 사용 하 여 프로그래밍 방식으로 특정 제품을 삭제 한 다음 하나를 업데이트 한 다음 새 복제본을 추가 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="29b91-339">만드는 사용자 지정 Insert, Update 및 Delete 메서드</span><span class="sxs-lookup"><span data-stu-id="29b91-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="29b91-340">`Insert()`, `Update()`, 및 `Delete()` DB 직접 메서드에서 만든 메서드 특히 많은 열이 있는 테이블에 대 한 약간은 복잡할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-340">The `Insert()`, `Update()`, and `Delete()` methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="29b91-341">이전 코드 예제에서는 IntelliSense의 명확 하지 않은 경우가 특히 무엇을 할 수 없이 살펴보면 `Products` 테이블 열에 각 입력된 매개 변수를 매핑하는 `Update()` 및 `Insert()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what `Products` table column maps to each input parameter to the `Update()` and `Insert()` methods.</span></span> <span data-ttu-id="29b91-342">때만 포함 하려고를 단일 열 또는 둘을 업데이트 하거나 원하는 사용자 지정 하는 경우가 있을 수 있습니다 `Insert()` 메서드는, 새로 삽입된 된 레코드의 값을 반환 `IDENTITY` (자동 증분) 필드입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-342">There may be times when we only want to update a single column or two, or want a customized `Insert()` method that will, perhaps, return the value of the newly inserted record's `IDENTITY` (auto-increment) field.</span></span>

<span data-ttu-id="29b91-343">사용자 지정 메서드를 만들려면 데이터 집합 디자이너를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="29b91-344">TableAdapter 고 TableAdapter 마법사를 반환 하는 추가 쿼리를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="29b91-345">두 번째 화면에서 만들 쿼리의 형식을 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="29b91-346">새 제품을 추가한 후 새로 추가 된 레코드의 값을 반환 하는 메서드를 만들어 보겠습니다 `ProductID`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-346">Let's create a method that adds a new product and then returns the value of the newly added record's `ProductID`.</span></span> <span data-ttu-id="29b91-347">따라서 만들도록 선택한는 `INSERT` 쿼리 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-347">Therefore, opt to create an `INSERT` query.</span></span>


<span data-ttu-id="29b91-348">[![Products 테이블에 새 행을 추가 하는 메서드 만들기](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span></span>

<span data-ttu-id="29b91-349">**그림 25**: 새 행을 추가 하는 메서드 만들기는 `Products` 테이블 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-349">**Figure 25**: Create a Method to Add a New Row to the `Products` Table ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image69.png))</span></span>


<span data-ttu-id="29b91-350">다음 화면에서의 `InsertCommand`의 `CommandText` 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-350">On the next screen the `InsertCommand`'s `CommandText` appears.</span></span> <span data-ttu-id="29b91-351">추가 하 여이 쿼리를 보강할 `SELECT SCOPE_IDENTITY()` 쿼리의 끝에 삽입 된 마지막 id 값을 반환 합니다는 `IDENTITY` 같은 범위에 있는 열입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-351">Augment this query by adding `SELECT SCOPE_IDENTITY()` at the end of the query, which will return the last identity value inserted into an `IDENTITY` column in the same scope.</span></span> <span data-ttu-id="29b91-352">(참조는 [기술 문서](https://msdn.microsoft.com/en-us/library/ms190315.aspx) 에 대 한 자세한 내용은 `SCOPE_IDENTITY()` 하고자 하는 이유 및 [범위를 사용 하 여\_@ 대신 IDENTITY()@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) 끝낼 때는 `INSERT` 문을 세미콜론으로 추가 하기 전에 `SELECT` 문.</span><span class="sxs-lookup"><span data-stu-id="29b91-352">(See the [technical documentation](https://msdn.microsoft.com/en-us/library/ms190315.aspx) for more information about `SCOPE_IDENTITY()` and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the `INSERT` statement with a semi-colon before adding the `SELECT` statement.</span></span>


<span data-ttu-id="29b91-353">[![Scope_identity () 값을 반환 하도록 쿼리를 확장 합니다.](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span></span>

<span data-ttu-id="29b91-354">**그림 26**: 반환 하도록 쿼리를 확장 하 고 `SCOPE_IDENTITY()` 값 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-354">**Figure 26**: Augment the Query to Return the `SCOPE_IDENTITY()` Value ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image72.png))</span></span>


<span data-ttu-id="29b91-355">마지막으로, 새 메서드를 이름을 `InsertProduct`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-355">Finally, name the new method `InsertProduct`.</span></span>


<span data-ttu-id="29b91-356">[![새 메서드 이름을 InsertProduct로 설정](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span></span>

<span data-ttu-id="29b91-357">**그림 27**: 새 메서드 이름으로 설정 `InsertProduct` ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-357">**Figure 27**: Set the New Method Name to `InsertProduct` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image75.png))</span></span>


<span data-ttu-id="29b91-358">다시 방문 데이터 집합 디자이너 표시 됩니다는 `ProductsTableAdapter` 새 메서드가 포함 `InsertProduct`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-358">When you return to the DataSet Designer you'll see that the `ProductsTableAdapter` contains a new method, `InsertProduct`.</span></span> <span data-ttu-id="29b91-359">이 새로운 방법을 각 열에 대 한 매개 변수 없는 경우는 `Products` 테이블 될 확률이 종료 하지 않았습니다 고 `INSERT` 문을 세미콜론으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-359">If this new method doesn't have a parameter for each column in the `Products` table, chances are you forgot to terminate the `INSERT` statement with a semi-colon.</span></span> <span data-ttu-id="29b91-360">구성에서 `InsertProduct` 메서드 세미콜론으로 구분 해야 하 고는 `INSERT` 및 `SELECT` 문.</span><span class="sxs-lookup"><span data-stu-id="29b91-360">Configure the `InsertProduct` method and ensure you have a semi-colon delimiting the `INSERT` and `SELECT` statements.</span></span>

<span data-ttu-id="29b91-361">기본적으로 삽입 메서드 문제 쿼리가 아닌 메서드, 즉 영향을 받는 행 수를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="29b91-362">그러나 원하는 `InsertProduct` 영향을 받는 행 수가 아니라 쿼리에 의해 반환 되는 값을 반환 하는 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-362">However, we want the `InsertProduct` method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="29b91-363">이를 위해 조정는 `InsertProduct` 메서드의 `ExecuteMode` 속성을 `Scalar`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-363">To accomplish this, adjust the `InsertProduct` method's `ExecuteMode` property to `Scalar`.</span></span>


<span data-ttu-id="29b91-364">[![스칼라 ExecuteMode 속성 변경](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span></span>

<span data-ttu-id="29b91-365">**그림 28**: 변경 된 `ExecuteMode` 속성을 `Scalar` ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-365">**Figure 28**: Change the `ExecuteMode` Property to `Scalar` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image78.png))</span></span>


<span data-ttu-id="29b91-366">다음 코드에서는 새로운 `InsertProduct` 메서드 실행에서:</span><span class="sxs-lookup"><span data-stu-id="29b91-366">The following code shows this new `InsertProduct` method in action:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="29b91-367">5 단계: 완료 데이터 액세스 계층</span><span class="sxs-lookup"><span data-stu-id="29b91-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="29b91-368">`ProductsTableAdapters` 반환 클래스는 `CategoryID` 및 `SupplierID` 에서 값의 `Products` 테이블, 포함 되지 않습니다는 `CategoryName` 열에서는 `Categories` 테이블 또는 `CompanyName` 열에서는 `Suppliers` 이러한 옵션은 가능성이 제품 정보를 표시 하는 때를 표시 하려는 열 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-368">Note that the `ProductsTableAdapters` class returns the `CategoryID` and `SupplierID` values from the `Products` table, but doesn't include the `CategoryName` column from the `Categories` table or the `CompanyName` column from the `Suppliers` table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="29b91-369">TableAdapter의 초기 메서드를 추가할 수 있습니다 `GetProducts()`, 둘 다 포함 하는 `CategoryName` 및 `CompanyName` 열 값과는 강력한 형식의 DataTable 이러한 새 열을 포함 하도록 업데이트 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-369">We can augment the TableAdapter's initial method, `GetProducts()`, to include both the `CategoryName` and `CompanyName` column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="29b91-370">그러나이 수는 문제를 TableAdapter의 메서드를 삽입 하기 위한 같은 업데이트 시키며 삭제 데이터는이 초기 방법을 기반으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="29b91-371">다행히 자동 생성 된 메서드를 삽입, 업데이트 및 삭제 하지 않은 영향을 받는의 하위 쿼리는 `SELECT` 절.</span><span class="sxs-lookup"><span data-stu-id="29b91-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the `SELECT` clause.</span></span> <span data-ttu-id="29b91-372">이 쿼리를 추가 하도록 하 여 `Categories` 및 `Suppliers` 하위 쿼리로 대신 `JOIN` s, 우리 합니다 필요가 데이터 수정에 대 한 이러한 메서드를 다시 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-372">By taking care to add our queries to `Categories` and `Suppliers` as subqueries, rather than `JOIN` s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="29b91-373">마우스 오른쪽 단추로 클릭는 `GetProducts()` 에서 메서드는 `ProductsTableAdapter` 구성을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-373">Right-click on the `GetProducts()` method in the `ProductsTableAdapter` and choose Configure.</span></span> <span data-ttu-id="29b91-374">그런 다음 조정 된 `SELECT` 절 표시 되도록 같은:</span><span class="sxs-lookup"><span data-stu-id="29b91-374">Then, adjust the `SELECT` clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]


<span data-ttu-id="29b91-375">[![SELECT 문은 GetProducts() 메서드에 대 한 업데이트](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span></span>

<span data-ttu-id="29b91-376">**그림 29**: 업데이트는 `SELECT` 문에 `GetProducts()` 메서드 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-376">**Figure 29**: Update the `SELECT` Statement for the `GetProducts()` Method ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image81.png))</span></span>


<span data-ttu-id="29b91-377">업데이트 한 후의 `GetProducts()` DataTable에는 두 개의 새 열이 새 쿼리를 사용 하는 메서드: `CategoryName` 및 `SupplierName`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-377">After updating the `GetProducts()` method to use this new query the DataTable will include two new columns: `CategoryName` and `SupplierName`.</span></span>


![제품 DataTable에 새 열 두 개](creating-a-data-access-layer-vb/_static/image82.png)

<span data-ttu-id="29b91-379">**그림 30**:는 `Products` DataTable에 새 열 두 개</span><span class="sxs-lookup"><span data-stu-id="29b91-379">**Figure 30**: The `Products` DataTable has Two New Columns</span></span>


<span data-ttu-id="29b91-380">업데이트 하는 `SELECT` 절에는 `GetProductsByCategoryID(categoryID)` 메서드도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-380">Take a moment to update the `SELECT` clause in the `GetProductsByCategoryID(categoryID)` method as well.</span></span>

<span data-ttu-id="29b91-381">업데이트 하는 경우는 `GetProducts()` `SELECT` 를 사용 하 여 `JOIN` 구문 데이터 집합 디자이너 수 없게 됩니다 삽입 하기 위한 메서드를 자동으로 생성, 업데이트 및 삭제 데이터베이스 데이터 DB를 사용 하 여 직접 패턴입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-381">If you update the `GetProducts()` `SELECT` using `JOIN` syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="29b91-382">수동으로 만든 훨씬와 동일한 방식 처럼 해야 하는 대신,는 `InsertProduct` 이 자습서의 앞부분에 나오는 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-382">Instead, you'll have to manually create them much like we did with the `InsertProduct` method earlier in this tutorial.</span></span> <span data-ttu-id="29b91-383">또한 해야 합니다. 수동으로 제공 하는 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 패턴을 업데이트 하는 일괄 처리를 사용 하려는 값을 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-383">Furthermore, you'll manually have to provide the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="29b91-384">나머지 Tableadapter를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="29b91-385">지금까지 단일 데이터베이스 테이블에 대 한 단일 TableAdapter 작업 알아보았습니다만 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="29b91-386">그러나 Northwind 데이터베이스는이 웹 응용 프로그램에서 작업할 해야 하는 여러 관련된 테이블을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="29b91-387">Datatable을 관련 형식화 된 데이터 집합을 여러 개 포함 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="29b91-388">따라서 우리의 DAL을 완료 하려면 추가 해야 Datatable이이 자습서에 사용할 다른 테이블에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="29b91-389">새 TableAdapter를 형식화 된 데이터 집합을 추가 하려면 데이터 집합 디자이너를 열려면 마우스 오른쪽 단추로 클릭 디자이너에서 추가 선택 / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="29b91-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="29b91-390">새 DataTable 및 TableAdapter를 만들고이 자습서의 앞부분에 나오는 검사 했습니다 마법사 과정을 안내 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="29b91-391">몇 분 정도 걸릴 다음 Tableadapter와 다음 쿼리를 사용 하 여 메서드를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="29b91-392">쿼리는 `ProductsTableAdapter` 각 제품 범주와 공급 업체 이름을 가져올 하위 쿼리가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-392">Note that the queries in the `ProductsTableAdapter` include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="29b91-393">또한 작업을 수행 했다면, 이미 추가한 경우는 `ProductsTableAdapter` 클래스의 `GetProducts()` 및 `GetProductsByCategoryID(categoryID)` 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-393">Additionally, if you've been following along, you've already added the `ProductsTableAdapter` class's `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods.</span></span>

- <span data-ttu-id="29b91-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="29b91-394">**ProductsTableAdapter**</span></span>

    - <span data-ttu-id="29b91-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="29b91-395">**GetProducts**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
    - <span data-ttu-id="29b91-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-396">**GetProductsByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
    - <span data-ttu-id="29b91-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-397">**GetProductsBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
    - <span data-ttu-id="29b91-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-398">**GetProductByProductID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- <span data-ttu-id="29b91-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="29b91-399">**CategoriesTableAdapter**</span></span>

    - <span data-ttu-id="29b91-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="29b91-400">**GetCategories**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
    - <span data-ttu-id="29b91-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-401">**GetCategoryByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- <span data-ttu-id="29b91-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="29b91-402">**SuppliersTableAdapter**</span></span>

    - <span data-ttu-id="29b91-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="29b91-403">**GetSuppliers**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
    - <span data-ttu-id="29b91-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="29b91-404">**GetSuppliersByCountry**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
    - <span data-ttu-id="29b91-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-405">**GetSupplierBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- <span data-ttu-id="29b91-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="29b91-406">**EmployeesTableAdapter**</span></span>

    - <span data-ttu-id="29b91-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="29b91-407">**GetEmployees**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
    - <span data-ttu-id="29b91-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="29b91-408">**GetEmployeesByManager**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
    - <span data-ttu-id="29b91-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="29b91-409">**GetEmployeeByEmployeeID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]


<span data-ttu-id="29b91-410">[![4 개의 Tableadapter를 추가한 후 데이터 집합 디자이너](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span></span>

<span data-ttu-id="29b91-411">**그림 31**: The 데이터 집합 디자이너 후의 4 개 Tableadapter 추가 되었습니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="29b91-412">에 dal과 사용자 지정 코드 추가</span><span class="sxs-lookup"><span data-stu-id="29b91-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="29b91-413">Tableadapter 및 형식화 된 데이터 집합에 추가 Datatable XML 스키마 정의 파일에는로 표현 됩니다 (`Northwind.xsd`).</span><span class="sxs-lookup"><span data-stu-id="29b91-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (`Northwind.xsd`).</span></span> <span data-ttu-id="29b91-414">마우스 오른쪽 단추로 클릭 하 여이 스키마 정보를 볼 수 있습니다는 `Northwind.xsd` 솔루션 탐색기에서 파일 및 코드 보기를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-414">You can view this schema information by right-clicking on the `Northwind.xsd` file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="29b91-415">[![형식화 된 데이터 집합의 Northwinds에 대 한 XML 스키마 정의 (XSD) 파일](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span></span>

<span data-ttu-id="29b91-416">**그림 32**: Northwinds 형식화 된 데이터 집합에 대 한 XML 스키마 정의 (XSD) 파일 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image88.png))</span></span>


<span data-ttu-id="29b91-417">이 스키마 정보는 컴파일할 때 또는 런타임 시 (필요한 경우), 이때 단계별로 실행할 수 있습니다이 디버거에서 디자인 타임에 C# 또는 Visual Basic 코드로 변환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="29b91-418">보려면이 자동으로 생성 된 코드 이동 클래스 뷰 및 드릴 TableAdapter 또는 형식화 된 데이터 집합 클래스에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="29b91-419">화면에 클래스 뷰 보이지 않으면 보기 메뉴로 이동 하 고 여기에서 선택 하거나 Ctrl + Shift + c 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="29b91-420">클래스 뷰에서 속성, 메서드 및 형식화 된 데이터 집합 및 TableAdapter 클래스의 이벤트를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="29b91-421">특정 방법에 대 한 코드를 보려면 클래스 뷰에서 메서드 이름을 두 번 클릭 하거나 마우스 오른쪽 정의로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![클래스 뷰에서 정의로 이동을 선택 하 여 자동으로 생성 된 코드를 검사 합니다.](creating-a-data-access-layer-vb/_static/image89.png)

<span data-ttu-id="29b91-423">**그림 33**: 클래스 뷰에서 정의에 Go를 선택 하 여 자동으로 생성 된 코드를 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="29b91-424">코드 자동 생성 된 시간을 많이 줄일 수 있지만, 코드는 종종 매우 일반적 이며 필요를 응용 프로그램의 고유한 요구 사항에 맞게 사용자 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="29b91-425">그러나이 자동으로 생성 된 코드를 확장 하는 위험 코드를 생성 하는 도구 사용자 지정을 덮어쓰고 "다시 생성"을 결정할 수입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="29b91-426">.NET 2.0의 새로운 partial 클래스 개념을 여러 파일에 걸쳐 분할 하기 쉽습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="29b91-427">이 통해이 사용자 지정 항목을 덮어쓰지 Visual Studio에 대해 걱정할 필요 없이 자동으로 생성 된 클래스에 고유한 메서드, 속성 및 이벤트를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="29b91-428">DAL을 사용자 지정 하는 방법을 보여 주는, 추가해보겠습니다는 `GetProducts()` 메서드를는 `SuppliersRow` 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-428">To demonstrate how to customize the DAL, let's add a `GetProducts()` method to the `SuppliersRow` class.</span></span> <span data-ttu-id="29b91-429">`SuppliersRow` 클래스의 단일 레코드를 나타냅니다.는 `Suppliers` 테이블; 여러 제품에 각 공급 업체 수 있는 공급자 0 하므로 `GetProducts()` 지정한 공급 업체의 해당 제품을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-429">The `SuppliersRow` class represents a single record in the `Suppliers` table; each supplier can provider zero to many products, so `GetProducts()` will return those products of the specified supplier.</span></span> <span data-ttu-id="29b91-430">수행 하려면에서 새 클래스 파일을 만들어이 `App_Code` 라는 폴더 `SuppliersRow.vb` 다음 코드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-430">To accomplish this create a new class file in the `App_Code` folder named `SuppliersRow.vb` and add the following code:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

<span data-ttu-id="29b91-431">이 partial 클래스 컴파일러에 지시 때 작성 된 `Northwind.SuppliersRow` 포함 하도록 클래스는 `GetProducts()` 방금 정의한 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-431">This partial class instructs the compiler that when building the `Northwind.SuppliersRow` class to include the `GetProducts()` method we just defined.</span></span> <span data-ttu-id="29b91-432">프로젝트를 빌드할 경우 한 후 클래스 보기로 돌아와서 표시 `GetProducts()` 의 메서드로 나열 `Northwind.SuppliersRow`합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-432">If you build your project and then return to the Class View you'll see `GetProducts()` now listed as a method of `Northwind.SuppliersRow`.</span></span>


![GetProducts() 메서드는 Northwind.SuppliersRow 클래스의 일부 이제](creating-a-data-access-layer-vb/_static/image90.png)

<span data-ttu-id="29b91-434">**그림 34**:는 `GetProducts()` 메서드는 지금의 일부는 `Northwind.SuppliersRow` 클래스</span><span class="sxs-lookup"><span data-stu-id="29b91-434">**Figure 34**: The `GetProducts()` Method is Now Part of the `Northwind.SuppliersRow` Class</span></span>


<span data-ttu-id="29b91-435">`GetProducts()` 다음 코드와 같이 특정 공급 업체의 제품 집합을 열거 하 이제 메서드를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-435">The `GetProducts()` method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

<span data-ttu-id="29b91-436">이 데이터는 ASP 중 하나에 표시 수 있습니다. NET의 데이터 웹 컨트롤입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="29b91-437">다음 페이지에 두 필드는 GridView 컨트롤을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="29b91-438">각 공급 업체의 이름을 표시 하는 BoundField 및</span><span class="sxs-lookup"><span data-stu-id="29b91-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="29b91-439">반환 된 결과에 바인딩되는 BulletedList 컨트롤이 포함 된 TemplateField는 `GetProducts()` 각 공급 업체에 대 한 메서드.</span><span class="sxs-lookup"><span data-stu-id="29b91-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the `GetProducts()` method for each supplier.</span></span>

<span data-ttu-id="29b91-440">이후 자습서에서 해당 마스터-세부 정보 보고서를 표시 하는 방법을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="29b91-441">지금은이 예제는 설명에 추가 사용자 지정 메서드를 사용 하 여 `Northwind.SuppliersRow` 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-441">For now, this example is designed to illustrate using the custom method added to the `Northwind.SuppliersRow` class.</span></span>

<span data-ttu-id="29b91-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="29b91-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

<span data-ttu-id="29b91-443">SuppliersAndProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="29b91-443">SuppliersAndProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]


<span data-ttu-id="29b91-444">[![왼쪽 열 오른쪽에 있는 해당 제품에에서 공급 업체의 회사 이름이 나열 됩니다.](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="29b91-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span></span>

<span data-ttu-id="29b91-445">**그림 35**: 왼쪽 열의 오른쪽에 있는 해당 제품의 공급 업체의 회사 이름이 나열 됩니다 ([전체 크기 이미지를 보려면 클릭](creating-a-data-access-layer-vb/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="29b91-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="29b91-446">요약</span><span class="sxs-lookup"><span data-stu-id="29b91-446">Summary</span></span>

<span data-ttu-id="29b91-447">때 웹 응용 프로그램 만들기 DAL 프레젠테이션 계층 만들기를 시작 하기 전에 발생 하 여 첫 번째 단계 중 하나 여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="29b91-448">Visual Studio와 함께 만들기 형식화 된 데이터 집합에 따라 DAL은 코드 줄도 작성 하지 않고 10-15 분 후에 수행할 수 있는 작업입니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="29b91-449">앞으로 이동 하는 자습서는이 DAL에 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="29b91-450">에 [다음 자습서](creating-a-business-logic-layer-vb.md) म 다양 한 비즈니스 규칙을 정의 하 고 별도 비즈니스 논리 계층에서이 구현 하는 방법을 참조 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-450">In the [next tutorial](creating-a-business-logic-layer-vb.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="29b91-451">만족도 매우 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="29b91-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="29b91-452">추가 정보</span><span class="sxs-lookup"><span data-stu-id="29b91-452">Further Reading</span></span>

<span data-ttu-id="29b91-453">이 자습서에 설명 된 항목에 대 한 자세한 내용은 다음 리소스를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="29b91-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="29b91-454">강력한 형식의 Tableadapter 및 Datatable VS 2005와 ASP.NET 2.0을 사용 하 여 DAL 작성</span><span class="sxs-lookup"><span data-stu-id="29b91-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="29b91-455">데이터 계층 구성 요소를 디자인 하 고 계층을 통한 데이터 전달</span><span class="sxs-lookup"><span data-stu-id="29b91-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/en-us/library/ms978496.aspx)
- [<span data-ttu-id="29b91-456">Visual Studio 2005 데이터 집합 디자이너로 데이터 액세스 계층을 구축</span><span class="sxs-lookup"><span data-stu-id="29b91-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="29b91-457">ASP.NET 2.0에서에서 구성 정보 암호화 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="29b91-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="29b91-458">TableAdapter 개요</span><span class="sxs-lookup"><span data-stu-id="29b91-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/en-us/library/bz9tthwx.aspx)
- [<span data-ttu-id="29b91-459">형식화 된 데이터 집합으로 작업</span><span class="sxs-lookup"><span data-stu-id="29b91-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/en-us/library/esbykkzb.aspx)
- [<span data-ttu-id="29b91-460">Visual Studio 2005와 ASP.NET 2.0에서 강력한 형식의 데이터 액세스를 사용 하 여</span><span class="sxs-lookup"><span data-stu-id="29b91-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="29b91-461">TableAdapter 메서드를 확장 하는 방법</span><span class="sxs-lookup"><span data-stu-id="29b91-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="29b91-462">저장된 프로시저에서 스칼라 데이터 검색</span><span class="sxs-lookup"><span data-stu-id="29b91-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="29b91-463">이 자습서에 포함 된 항목에 대 한 비디오 교육</span><span class="sxs-lookup"><span data-stu-id="29b91-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="29b91-464">ASP.NET 응용 프로그램에서 데이터 액세스 계층</span><span class="sxs-lookup"><span data-stu-id="29b91-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="29b91-465">수동으로 Datagrid에 데이터 집합을 바인딩하는 방법</span><span class="sxs-lookup"><span data-stu-id="29b91-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="29b91-466">ASP 응용 프로그램에서 데이터 집합 및 필터와 함께 작동 하는 방법</span><span class="sxs-lookup"><span data-stu-id="29b91-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="29b91-467">작성자 정보</span><span class="sxs-lookup"><span data-stu-id="29b91-467">About the Author</span></span>

<span data-ttu-id="29b91-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 7 ASP/ASP.NET 서적과의 창립자의 작성자 [4GuysFromRolla.com](http://www.4guysfromrolla.com), 1998 이후 Microsoft 웹 기술과 함께 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="29b91-469">Scott 독립 컨설턴트, 강사, 기술 및 작성기 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="29b91-470">그의 최신 서적은 [ *Sam 업무량이 직접 ASP.NET 2.0 24 시간 동안에서*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="29b91-471">에 연결할 수 그 [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) 에서 찾을 수 있는 그의 블로그를 통해 또는 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="29b91-472">특별히 감사</span><span class="sxs-lookup"><span data-stu-id="29b91-472">Special Thanks To</span></span>

<span data-ttu-id="29b91-473">이 자습서 시리즈 많은 유용한 검토자가 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-473">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="29b91-474">이 자습서에 대 한 선행 검토자 Ron 녹색, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez 및 Carlos Santos 했습니다.</span><span class="sxs-lookup"><span data-stu-id="29b91-474">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="29b91-475">향후 내 MSDN 문서를 검토에 관심이 있으십니까?</span><span class="sxs-lookup"><span data-stu-id="29b91-475">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="29b91-476">이 경우 drop me에 한 줄씩 [ mitchell@4GuysFromRolla.com합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="29b91-476">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="29b91-477">[이전](master-pages-and-site-navigation-cs.md)
[다음](creating-a-business-logic-layer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="29b91-477">[Previous](master-pages-and-site-navigation-cs.md)
[Next](creating-a-business-logic-layer-vb.md)</span></span>
